/**
 * Demo Data Seeder
 *
 * Creates a comprehensive demo dataset for sales demos, QA testing, and developer onboarding.
 * Uses a deterministic firm ID and DEMO_ prefix for easy identification and cleanup.
 *
 * Commands:
 *   npm run demo:seed   - Load demo dataset (creates or updates)
 *   npm run demo:reset  - Clear and reload demo data
 *   npm run demo:clear  - Remove demo data only
 *
 * This MVP version creates minimal data to prove the mechanism:
 * - 1 firm (Harrison & Clarke Solicitors)
 * - 2 users (partner, associate)
 * - 2 clients (1 individual, 1 company)
 * - 2 matters (conveyancing, litigation)
 * - 4 time entries (2 per matter)
 */

import { db } from "@/lib/db";
import {
  firms,
  users,
  clients,
  matters,
  timeEntries,
  documents,
  invoices,
  invoiceLineItems,
  payments,
  tasks,
  notifications,
  riskEvaluations,
  complianceRules,
  calendarEvents,
} from "@/lib/db/schema";
import { eq, sql } from "drizzle-orm";

// Deterministic UUIDs for demo data - allows idempotent seeding
// Using valid UUID format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx (hex only)
export const DEMO_FIRM_ID = "de000000-0000-4000-a000-000000000001";
export const DEMO_PREFIX = "DEMO_";

// Deterministic IDs for core entities (all valid UUIDs, "de" prefix = demo)
const DEMO_IDS = {
  firm: DEMO_FIRM_ID,
  users: {
    partner: "de000000-0000-4000-a001-000000000001",
    associate: "de000000-0000-4000-a001-000000000002",
    associate2: "de000000-0000-4000-a001-000000000003",
    associate3: "de000000-0000-4000-a001-000000000004",
    paralegal1: "de000000-0000-4000-a001-000000000005",
    paralegal2: "de000000-0000-4000-a001-000000000006",
    seniorPartner: "de000000-0000-4000-a001-000000000007",
    receptionist: "de000000-0000-4000-a001-000000000008",
  },
  clients: {
    individual: "de000000-0000-4000-a002-000000000001",
    company: "de000000-0000-4000-a002-000000000002",
    individual3: "de000000-0000-4000-a002-000000000003",
    individual4: "de000000-0000-4000-a002-000000000004",
    individual5: "de000000-0000-4000-a002-000000000005",
    individual6: "de000000-0000-4000-a002-000000000006",
    individual7: "de000000-0000-4000-a002-000000000007",
    individual8: "de000000-0000-4000-a002-000000000008",
    company3: "de000000-0000-4000-a002-000000000009",
    company4: "de000000-0000-4000-a002-000000000010",
    company5: "de000000-0000-4000-a002-000000000011",
    company6: "de000000-0000-4000-a002-000000000012",
    company7: "de000000-0000-4000-a002-000000000013",
    trust1: "de000000-0000-4000-a002-000000000014",
    estate1: "de000000-0000-4000-a002-000000000015",
  },
  matters: {
    conveyancing: "de000000-0000-4000-a003-000000000001",
    litigation: "de000000-0000-4000-a003-000000000002",
    conveyancingSale: "de000000-0000-4000-a003-000000000003",
    conveyancingRemortgage: "de000000-0000-4000-a003-000000000004",
    conveyancingLeasehold: "de000000-0000-4000-a003-000000000005",
    litigationDebt: "de000000-0000-4000-a003-000000000006",
    litigationContract: "de000000-0000-4000-a003-000000000007",
    personalInjuryRTA: "de000000-0000-4000-a003-000000000008",
    personalInjuryWorkplace: "de000000-0000-4000-a003-000000000009",
    personalInjurySlip: "de000000-0000-4000-a003-000000000010",
    personalInjuryCICA: "de000000-0000-4000-a003-000000000011",
    familyDivorce: "de000000-0000-4000-a003-000000000012",
    familyChild: "de000000-0000-4000-a003-000000000013",
    familyPrenup: "de000000-0000-4000-a003-000000000014",
    employmentDismissal: "de000000-0000-4000-a003-000000000015",
    employmentRedundancy: "de000000-0000-4000-a003-000000000016",
    employmentSettlement: "de000000-0000-4000-a003-000000000017",
    probateEstate: "de000000-0000-4000-a003-000000000018",
    probateDispute: "de000000-0000-4000-a003-000000000019",
    probateGrant: "de000000-0000-4000-a003-000000000020",
    criminalDriving: "de000000-0000-4000-a003-000000000021",
    criminalFraud: "de000000-0000-4000-a003-000000000022",
    immigrationTier2: "de000000-0000-4000-a003-000000000023",
    immigrationSpouse: "de000000-0000-4000-a003-000000000024",
    commercialShareholder: "de000000-0000-4000-a003-000000000025",
  },
  timeEntries: {
    te1: "de000000-0000-4000-a004-000000000001",
    te2: "de000000-0000-4000-a004-000000000002",
    te3: "de000000-0000-4000-a004-000000000003",
    te4: "de000000-0000-4000-a004-000000000004",
    te5: "de000000-0000-4000-a004-000000000005",
    te6: "de000000-0000-4000-a004-000000000006",
    te7: "de000000-0000-4000-a004-000000000007",
    te8: "de000000-0000-4000-a004-000000000008",
    te9: "de000000-0000-4000-a004-000000000009",
    te10: "de000000-0000-4000-a004-000000000010",
    te11: "de000000-0000-4000-a004-000000000011",
    te12: "de000000-0000-4000-a004-000000000012",
    te13: "de000000-0000-4000-a004-000000000013",
    te14: "de000000-0000-4000-a004-000000000014",
    te15: "de000000-0000-4000-a004-000000000015",
    te16: "de000000-0000-4000-a004-000000000016",
    te17: "de000000-0000-4000-a004-000000000017",
    te18: "de000000-0000-4000-a004-000000000018",
    te19: "de000000-0000-4000-a004-000000000019",
    te20: "de000000-0000-4000-a004-000000000020",
    te21: "de000000-0000-4000-a004-000000000021",
    te22: "de000000-0000-4000-a004-000000000022",
    te23: "de000000-0000-4000-a004-000000000023",
    te24: "de000000-0000-4000-a004-000000000024",
    te25: "de000000-0000-4000-a004-000000000025",
    te26: "de000000-0000-4000-a004-000000000026",
    te27: "de000000-0000-4000-a004-000000000027",
    te28: "de000000-0000-4000-a004-000000000028",
    te29: "de000000-0000-4000-a004-000000000029",
    te30: "de000000-0000-4000-a004-000000000030",
    te31: "de000000-0000-4000-a004-000000000031",
    te32: "de000000-0000-4000-a004-000000000032",
    te33: "de000000-0000-4000-a004-000000000033",
    te34: "de000000-0000-4000-a004-000000000034",
    te35: "de000000-0000-4000-a004-000000000035",
    te36: "de000000-0000-4000-a004-000000000036",
    te37: "de000000-0000-4000-a004-000000000037",
    te38: "de000000-0000-4000-a004-000000000038",
    te39: "de000000-0000-4000-a004-000000000039",
    te40: "de000000-0000-4000-a004-000000000040",
    te41: "de000000-0000-4000-a004-000000000041",
    te42: "de000000-0000-4000-a004-000000000042",
    te43: "de000000-0000-4000-a004-000000000043",
    te44: "de000000-0000-4000-a004-000000000044",
    te45: "de000000-0000-4000-a004-000000000045",
    te46: "de000000-0000-4000-a004-000000000046",
    te47: "de000000-0000-4000-a004-000000000047",
    te48: "de000000-0000-4000-a004-000000000048",
    te49: "de000000-0000-4000-a004-000000000049",
    te50: "de000000-0000-4000-a004-000000000050",
  },
  invoices: {
    inv1: "de000000-0000-4000-a006-000000000001",
    inv2: "de000000-0000-4000-a006-000000000002",
    inv3: "de000000-0000-4000-a006-000000000003",
    inv4: "de000000-0000-4000-a006-000000000004",
    inv5: "de000000-0000-4000-a006-000000000005",
    inv6: "de000000-0000-4000-a006-000000000006",
    inv7: "de000000-0000-4000-a006-000000000007",
    inv8: "de000000-0000-4000-a006-000000000008",
    inv9: "de000000-0000-4000-a006-000000000009",
    inv10: "de000000-0000-4000-a006-000000000010",
  },
  payments: {
    pay1: "de000000-0000-4000-a007-000000000001",
    pay2: "de000000-0000-4000-a007-000000000002",
    pay3: "de000000-0000-4000-a007-000000000003",
    pay4: "de000000-0000-4000-a007-000000000004",
    pay5: "de000000-0000-4000-a007-000000000005",
  },
  tasks: {
    task1: "de000000-0000-4000-a005-000000000001",
    task2: "de000000-0000-4000-a005-000000000002",
    task3: "de000000-0000-4000-a005-000000000003",
    task4: "de000000-0000-4000-a005-000000000004",
    task5: "de000000-0000-4000-a005-000000000005",
    task6: "de000000-0000-4000-a005-000000000006",
    task7: "de000000-0000-4000-a005-000000000007",
    task8: "de000000-0000-4000-a005-000000000008",
    task9: "de000000-0000-4000-a005-000000000009",
    task10: "de000000-0000-4000-a005-000000000010",
    task11: "de000000-0000-4000-a005-000000000011",
    task12: "de000000-0000-4000-a005-000000000012",
    task13: "de000000-0000-4000-a005-000000000013",
    task14: "de000000-0000-4000-a005-000000000014",
    task15: "de000000-0000-4000-a005-000000000015",
    task16: "de000000-0000-4000-a005-000000000016",
    task17: "de000000-0000-4000-a005-000000000017",
    task18: "de000000-0000-4000-a005-000000000018",
    task19: "de000000-0000-4000-a005-000000000019",
    task20: "de000000-0000-4000-a005-000000000020",
    task21: "de000000-0000-4000-a005-000000000021",
    task22: "de000000-0000-4000-a005-000000000022",
    task23: "de000000-0000-4000-a005-000000000023",
    task24: "de000000-0000-4000-a005-000000000024",
    task25: "de000000-0000-4000-a005-000000000025",
    task26: "de000000-0000-4000-a005-000000000026",
    task27: "de000000-0000-4000-a005-000000000027",
    task28: "de000000-0000-4000-a005-000000000028",
    task29: "de000000-0000-4000-a005-000000000029",
    task30: "de000000-0000-4000-a005-000000000030",
  },
  documents: {
    doc1: "de000000-0000-4000-a008-000000000001",
    doc2: "de000000-0000-4000-a008-000000000002",
    doc3: "de000000-0000-4000-a008-000000000003",
    doc4: "de000000-0000-4000-a008-000000000004",
    doc5: "de000000-0000-4000-a008-000000000005",
    doc6: "de000000-0000-4000-a008-000000000006",
    doc7: "de000000-0000-4000-a008-000000000007",
    doc8: "de000000-0000-4000-a008-000000000008",
    doc9: "de000000-0000-4000-a008-000000000009",
    doc10: "de000000-0000-4000-a008-000000000010",
    doc11: "de000000-0000-4000-a008-000000000011",
    doc12: "de000000-0000-4000-a008-000000000012",
    doc13: "de000000-0000-4000-a008-000000000013",
    doc14: "de000000-0000-4000-a008-000000000014",
    doc15: "de000000-0000-4000-a008-000000000015",
    doc16: "de000000-0000-4000-a008-000000000016",
    doc17: "de000000-0000-4000-a008-000000000017",
    doc18: "de000000-0000-4000-a008-000000000018",
    doc19: "de000000-0000-4000-a008-000000000019",
    doc20: "de000000-0000-4000-a008-000000000020",
    doc21: "de000000-0000-4000-a008-000000000021",
    doc22: "de000000-0000-4000-a008-000000000022",
    doc23: "de000000-0000-4000-a008-000000000023",
    doc24: "de000000-0000-4000-a008-000000000024",
    doc25: "de000000-0000-4000-a008-000000000025",
    doc26: "de000000-0000-4000-a008-000000000026",
    doc27: "de000000-0000-4000-a008-000000000027",
    doc28: "de000000-0000-4000-a008-000000000028",
    doc29: "de000000-0000-4000-a008-000000000029",
    doc30: "de000000-0000-4000-a008-000000000030",
  },
  notifications: {
    notif1: "de000000-0000-4000-a009-000000000001",
    notif2: "de000000-0000-4000-a009-000000000002",
    notif3: "de000000-0000-4000-a009-000000000003",
    notif4: "de000000-0000-4000-a009-000000000004",
    notif5: "de000000-0000-4000-a009-000000000005",
    notif6: "de000000-0000-4000-a009-000000000006",
    notif7: "de000000-0000-4000-a009-000000000007",
    notif8: "de000000-0000-4000-a009-000000000008",
    notif9: "de000000-0000-4000-a009-000000000009",
    notif10: "de000000-0000-4000-a009-000000000010",
    notif11: "de000000-0000-4000-a009-000000000011",
    notif12: "de000000-0000-4000-a009-000000000012",
    notif13: "de000000-0000-4000-a009-000000000013",
    notif14: "de000000-0000-4000-a009-000000000014",
    notif15: "de000000-0000-4000-a009-000000000015",
    notif16: "de000000-0000-4000-a009-000000000016",
    notif17: "de000000-0000-4000-a009-000000000017",
    notif18: "de000000-0000-4000-a009-000000000018",
    notif19: "de000000-0000-4000-a009-000000000019",
    notif20: "de000000-0000-4000-a009-000000000020",
  },
  riskEvaluations: {
    risk1: "de000000-0000-4000-a011-000000000001",
    risk2: "de000000-0000-4000-a011-000000000002",
    risk3: "de000000-0000-4000-a011-000000000003",
    risk4: "de000000-0000-4000-a011-000000000004",
    risk5: "de000000-0000-4000-a011-000000000005",
    risk6: "de000000-0000-4000-a011-000000000006",
    risk7: "de000000-0000-4000-a011-000000000007",
    risk8: "de000000-0000-4000-a011-000000000008",
    risk9: "de000000-0000-4000-a011-000000000009",
    risk10: "de000000-0000-4000-a011-000000000010",
  },
  complianceRules: {
    rule1: "de000000-0000-4000-a012-000000000001",
    rule2: "de000000-0000-4000-a012-000000000002",
    rule3: "de000000-0000-4000-a012-000000000003",
    rule4: "de000000-0000-4000-a012-000000000004",
    rule5: "de000000-0000-4000-a012-000000000005",
  },
  calendarEvents: {
    event1: "de000000-0000-4000-a010-000000000001",
    event2: "de000000-0000-4000-a010-000000000002",
    event3: "de000000-0000-4000-a010-000000000003",
    event4: "de000000-0000-4000-a010-000000000004",
    event5: "de000000-0000-4000-a010-000000000005",
    event6: "de000000-0000-4000-a010-000000000006",
    event7: "de000000-0000-4000-a010-000000000007",
    event8: "de000000-0000-4000-a010-000000000008",
    event9: "de000000-0000-4000-a010-000000000009",
    event10: "de000000-0000-4000-a010-000000000010",
    event11: "de000000-0000-4000-a010-000000000011",
    event12: "de000000-0000-4000-a010-000000000012",
    event13: "de000000-0000-4000-a010-000000000013",
    event14: "de000000-0000-4000-a010-000000000014",
    event15: "de000000-0000-4000-a010-000000000015",
  },
};

interface SeedResult {
  firm: { id: string; name: string };
  users: { id: string; name: string; email: string }[];
  clients: { id: string; name: string; type: string }[];
  matters: { id: string; title: string; practiceArea: string }[];
  timeEntries: { id: string; description: string; amount: string }[];
  tasks: { id: string; title: string; status: string }[];
}

/**
 * Clear all demo data from the database
 */
export async function clearDemoData(): Promise<void> {
  console.log("Clearing demo data...\n");

  // Check if demo firm exists
  const existingFirm = await db.select().from(firms).where(eq(firms.id, DEMO_FIRM_ID));

  if (existingFirm.length === 0) {
    console.log("  No demo data found.\n");
    return;
  }

  // Delete in reverse dependency order
  // Most tables have cascade delete from firm, but we'll be explicit
  const tables = [
    { name: "notifications", table: notifications },
    { name: "calendar_events", table: calendarEvents },
    { name: "tasks", table: tasks },
    { name: "payments", table: payments },
    { name: "invoice_line_items", table: invoiceLineItems },
    { name: "invoices", table: invoices },
    { name: "time_entries", table: timeEntries },
    { name: "documents", table: documents },
    { name: "matters", table: matters },
    { name: "clients", table: clients },
    { name: "users", table: users },
    { name: "firms", table: firms },
  ];

  for (const { name, table } of tables) {
    try {
      if (name === "firms") {
        await db.delete(table).where(eq(firms.id, DEMO_FIRM_ID));
      } else if ("firmId" in table) {
        // @ts-expect-error - dynamic table access
        await db.delete(table).where(eq(table.firmId, DEMO_FIRM_ID));
      }
      console.log(`  Cleared ${name}`);
    } catch {
      // Table might not have firmId or might be empty
    }
  }

  console.log("\nDemo data cleared!\n");
}

/**
 * Seed demo data
 */
export async function seedDemoData(): Promise<SeedResult> {
  console.log("Seeding demo data...\n");

  const result: SeedResult = {
    firm: { id: "", name: "" },
    users: [],
    clients: [],
    matters: [],
    timeEntries: [],
    tasks: [],
  };

  const now = new Date();
  const today = now.toISOString().split("T")[0];
  const yesterday = new Date(now.getTime() - 86400000).toISOString().split("T")[0];

  // 1. Create firm
  const [firm] = await db
    .insert(firms)
    .values({
      id: DEMO_IDS.firm,
      name: `${DEMO_PREFIX}Harrison & Clarke Solicitors`,
      sraNumber: "SRA123456",
      status: "active",
      plan: "enterprise",
      email: "info@harrisonclark.demo",
      createdAt: now,
      updatedAt: now,
    })
    .onConflictDoUpdate({
      target: firms.id,
      set: { updatedAt: now },
    })
    .returning();

  result.firm = { id: firm.id, name: firm.name };
  console.log(`  Created firm: ${firm.name}`);

  // 2. Create users
  const usersData = [
    {
      id: DEMO_IDS.users.partner,
      firmId: DEMO_IDS.firm,
      email: "sarah.harrison@harrisonclark.demo",
      name: `${DEMO_PREFIX}Sarah Harrison`,
      emailVerified: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.users.associate,
      firmId: DEMO_IDS.firm,
      email: "james.clarke@harrisonclark.demo",
      name: `${DEMO_PREFIX}James Clarke`,
      emailVerified: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.users.seniorPartner,
      firmId: DEMO_IDS.firm,
      email: "victoria.clarke@harrisonclark.demo",
      name: `${DEMO_PREFIX}Victoria Clarke`,
      emailVerified: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.users.associate2,
      firmId: DEMO_IDS.firm,
      email: "emma.williams@harrisonclark.demo",
      name: `${DEMO_PREFIX}Emma Williams`,
      emailVerified: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.users.associate3,
      firmId: DEMO_IDS.firm,
      email: "david.chen@harrisonclark.demo",
      name: `${DEMO_PREFIX}David Chen`,
      emailVerified: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.users.paralegal1,
      firmId: DEMO_IDS.firm,
      email: "tom.richards@harrisonclark.demo",
      name: `${DEMO_PREFIX}Tom Richards`,
      emailVerified: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.users.paralegal2,
      firmId: DEMO_IDS.firm,
      email: "sophie.brown@harrisonclark.demo",
      name: `${DEMO_PREFIX}Sophie Brown`,
      emailVerified: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.users.receptionist,
      firmId: DEMO_IDS.firm,
      email: "lucy.taylor@harrisonclark.demo",
      name: `${DEMO_PREFIX}Lucy Taylor`,
      emailVerified: true,
      createdAt: now,
      updatedAt: now,
    },
  ];

  for (const userData of usersData) {
    const [user] = await db
      .insert(users)
      .values(userData)
      .onConflictDoUpdate({
        target: users.id,
        set: { updatedAt: now },
      })
      .returning();

    result.users.push({ id: user.id, name: user.name!, email: user.email! });
    console.log(`    Created user: ${user.name}`);
  }

  // 3. Create clients
  const clientsData = [
    {
      id: DEMO_IDS.clients.individual,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-001",
      firstName: `${DEMO_PREFIX}Margaret`,
      lastName: "Thompson",
      email: "margaret.thompson@example.demo",
      phone: "020 7123 4567",
      addressLine1: "42 Kensington Gardens",
      city: "London",
      postcode: "W8 4PX",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-002",
      companyName: `${DEMO_PREFIX}Apex Developments Ltd`,
      companyNumber: "12345678",
      email: "legal@apexdev.demo",
      phone: "0161 234 5678",
      addressLine1: "100 Deansgate",
      city: "Manchester",
      postcode: "M3 2GP",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual3,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-003",
      firstName: `${DEMO_PREFIX}Robert`,
      lastName: "Williams",
      email: "robert.williams@example.demo",
      phone: "0161 789 4567",
      addressLine1: "58 Oxford Road",
      city: "Manchester",
      postcode: "M1 6EU",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual4,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-004",
      firstName: `${DEMO_PREFIX}Jennifer`,
      lastName: "Adams",
      email: "jennifer.adams@example.demo",
      phone: "0121 456 7890",
      addressLine1: "23 Colmore Row",
      city: "Birmingham",
      postcode: "B3 2BS",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual5,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-005",
      firstName: `${DEMO_PREFIX}Michael`,
      lastName: "O'Brien",
      email: "michael.obrien@example.demo",
      phone: "0151 234 5678",
      addressLine1: "77 Bold Street",
      city: "Liverpool",
      postcode: "L1 4HF",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual6,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-006",
      firstName: `${DEMO_PREFIX}Fatima`,
      lastName: "Hassan",
      email: "fatima.hassan@example.demo",
      phone: "0113 987 6543",
      addressLine1: "14 Park Square East",
      city: "Leeds",
      postcode: "LS1 2LH",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual7,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-007",
      firstName: `${DEMO_PREFIX}George`,
      lastName: "Henderson",
      email: "george.henderson@example.demo",
      phone: "0117 456 7890",
      addressLine1: "89 Whiteladies Road",
      city: "Bristol",
      postcode: "BS8 2NT",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual8,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-008",
      firstName: `${DEMO_PREFIX}Elizabeth`,
      lastName: "Carter",
      email: "elizabeth.carter@example.demo",
      phone: "0131 234 5678",
      addressLine1: "32 Charlotte Square",
      city: "Edinburgh",
      postcode: "EH2 4ET",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company3,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-009",
      companyName: `${DEMO_PREFIX}TechStart Solutions Ltd`,
      companyNumber: "23456789",
      email: "legal@techstart.demo",
      phone: "020 7890 1234",
      addressLine1: "15 Old Street",
      city: "London",
      postcode: "EC1V 9HL",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company4,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-010",
      companyName: `${DEMO_PREFIX}Northern Manufacturing plc`,
      companyNumber: "34567890",
      email: "legal@northernmfg.demo",
      phone: "0191 345 6789",
      addressLine1: "Industrial Estate Road",
      city: "Newcastle",
      postcode: "NE4 7YH",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company5,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-011",
      companyName: `${DEMO_PREFIX}Riverside Properties Ltd`,
      companyNumber: "45678901",
      email: "legal@riverside.demo",
      phone: "0161 567 8901",
      addressLine1: "Quay Street",
      city: "Manchester",
      postcode: "M3 3JE",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company6,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-012",
      companyName: `${DEMO_PREFIX}Global Imports Ltd`,
      companyNumber: "56789012",
      email: "legal@globalimports.demo",
      phone: "020 3456 7890",
      addressLine1: "Docklands Business Centre",
      city: "London",
      postcode: "E14 9SH",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company7,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-013",
      companyName: `${DEMO_PREFIX}Healthcare Plus Ltd`,
      companyNumber: "67890123",
      email: "legal@healthcareplus.demo",
      phone: "0121 678 9012",
      addressLine1: "Medical Quarter",
      city: "Birmingham",
      postcode: "B15 2TH",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.trust1,
      firmId: DEMO_IDS.firm,
      type: "trust" as const,
      status: "active" as const,
      reference: "CLI-DEMO-014",
      companyName: `${DEMO_PREFIX}Henderson Family Trust`,
      email: "trustees@hendersontrust.demo",
      phone: "0117 789 0123",
      addressLine1: "89 Whiteladies Road",
      city: "Bristol",
      postcode: "BS8 2NT",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.estate1,
      firmId: DEMO_IDS.firm,
      type: "trust" as const,
      status: "active" as const,
      reference: "CLI-DEMO-015",
      companyName: `${DEMO_PREFIX}Carter Estate`,
      email: "executors@carterestate.demo",
      phone: "0131 890 1234",
      addressLine1: "32 Charlotte Square",
      city: "Edinburgh",
      postcode: "EH2 4ET",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
  ];

  for (const clientData of clientsData) {
    const [client] = await db
      .insert(clients)
      .values(clientData)
      .onConflictDoUpdate({
        target: clients.id,
        set: { updatedAt: now },
      })
      .returning();

    const displayName =
      client.type === "individual" ? `${client.firstName} ${client.lastName}` : client.companyName;

    result.clients.push({ id: client.id, name: displayName!, type: client.type });
    console.log(`    Created client: ${displayName}`);
  }

  // 4. Create matters
  const mattersData = [
    {
      id: DEMO_IDS.matters.conveyancing,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual,
      title: "Purchase of 15 Willow Lane, Richmond",
      reference: "MAT-DEMO-001",
      practiceArea: "conveyancing" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.associate,
      description: "Freehold residential purchase. Price: £850,000. Mortgage with Nationwide.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.litigation,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.company,
      title: "Apex vs. BuildRight - Construction Defects Claim",
      reference: "MAT-DEMO-002",
      practiceArea: "litigation" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.partner,
      description: "Claim against contractor for defective foundation works. Value: £2.4m.",
      createdAt: now,
      updatedAt: now,
    },
    // Conveyancing matters (3 more)
    {
      id: DEMO_IDS.matters.conveyancingSale,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual,
      title: "Sale of 42 Kensington Gardens, London",
      reference: "MAT-DEMO-003",
      practiceArea: "conveyancing" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.associate2,
      description: "Freehold sale. Price: £1,250,000. Chain of 3 properties.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.conveyancingRemortgage,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.company,
      title: "Remortgage of 100 Deansgate, Manchester",
      reference: "MAT-DEMO-004",
      practiceArea: "conveyancing" as const,
      status: "closed" as const,
      feeEarnerId: DEMO_IDS.users.paralegal1,
      description: "Commercial remortgage. Value: £3.5m with HSBC.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.conveyancingLeasehold,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual6,
      title: "Leasehold Purchase - Flat 4B, The Galleries, Leeds",
      reference: "MAT-DEMO-005",
      practiceArea: "conveyancing" as const,
      status: "lead" as const,
      feeEarnerId: DEMO_IDS.users.associate2,
      description: "Leasehold flat purchase. Price: £320,000. 99 years remaining on lease.",
      createdAt: now,
      updatedAt: now,
    },
    // Litigation matters (2 more)
    {
      id: DEMO_IDS.matters.litigationDebt,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.company,
      title: "Debt Recovery - Outstanding Invoice £45,000",
      reference: "MAT-DEMO-006",
      practiceArea: "litigation" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.associate3,
      description: "Recovering unpaid invoices from former client. Claim issued in County Court.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.litigationContract,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.company4,
      title: "Breach of Contract - Supply Agreement Dispute",
      reference: "MAT-DEMO-007",
      practiceArea: "litigation" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      description: "Supplier failed to deliver materials per agreement. Claim value: £180,000.",
      createdAt: now,
      updatedAt: now,
    },
    // Personal Injury matters (4)
    {
      id: DEMO_IDS.matters.personalInjuryRTA,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual3,
      title: "RTA Personal Injury - M6 Motorway Collision",
      reference: "MAT-DEMO-008",
      practiceArea: "personal_injury" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.partner,
      description:
        "Whiplash and soft tissue injuries. Liability admitted. Medical reports pending.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.personalInjuryWorkplace,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual4,
      title: "Workplace Accident - Slipped Disc Injury",
      reference: "MAT-DEMO-009",
      practiceArea: "personal_injury" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.partner,
      description:
        "Manual handling injury at warehouse. Employer liability claim. Off work 6 months.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.personalInjurySlip,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual5,
      title: "Slip and Fall - Supermarket Public Liability",
      reference: "MAT-DEMO-010",
      practiceArea: "personal_injury" as const,
      status: "closed" as const,
      feeEarnerId: DEMO_IDS.users.associate,
      description: "Fractured wrist from wet floor. Settled at £8,500 plus costs.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.personalInjuryCICA,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual6,
      title: "CICA Criminal Injuries Compensation Application",
      reference: "MAT-DEMO-011",
      practiceArea: "personal_injury" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.partner,
      description: "Assault victim. Psychological injury claim. CICA application submitted.",
      createdAt: now,
      updatedAt: now,
    },
    // Family matters (3)
    {
      id: DEMO_IDS.matters.familyDivorce,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual,
      title: "Divorce - Thompson Matrimonial Proceedings",
      reference: "MAT-DEMO-012",
      practiceArea: "family" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.associate2,
      description: "Divorce petition filed. Financial disclosure ongoing. No children.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.familyChild,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual7,
      title: "Child Arrangements Order Application",
      reference: "MAT-DEMO-013",
      practiceArea: "family" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.associate2,
      description: "Seeking shared custody arrangement. CAFCASS report ordered.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.familyPrenup,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual8,
      title: "Prenuptial Agreement - High Net Worth",
      reference: "MAT-DEMO-014",
      practiceArea: "family" as const,
      status: "lead" as const,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      description: "Drafting prenup for wedding in 3 months. Assets include property portfolio.",
      createdAt: now,
      updatedAt: now,
    },
    // Employment matters (3)
    {
      id: DEMO_IDS.matters.employmentDismissal,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual3,
      title: "Unfair Dismissal Tribunal Claim",
      reference: "MAT-DEMO-015",
      practiceArea: "employment" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.associate3,
      description: "Senior manager dismissed without proper procedure. ET claim lodged.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.employmentRedundancy,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual4,
      title: "Redundancy - Selection Process Challenge",
      reference: "MAT-DEMO-016",
      practiceArea: "employment" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.associate3,
      description: "Challenging unfair redundancy selection criteria. 15 years service.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.employmentSettlement,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual5,
      title: "Settlement Agreement Negotiation",
      reference: "MAT-DEMO-017",
      practiceArea: "employment" as const,
      status: "closed" as const,
      feeEarnerId: DEMO_IDS.users.associate3,
      description: "Exit package negotiated. £75,000 settlement plus legal costs.",
      createdAt: now,
      updatedAt: now,
    },
    // Probate matters (3)
    {
      id: DEMO_IDS.matters.probateEstate,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.estate1,
      title: "Estate Administration - Estate of John Roberts",
      reference: "MAT-DEMO-018",
      practiceArea: "probate" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.paralegal2,
      description: "Standard probate. Estate value £450,000. Three beneficiaries.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.probateDispute,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual7,
      title: "Will Dispute - Inheritance Act Claim",
      reference: "MAT-DEMO-019",
      practiceArea: "probate" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      description: "Adult child excluded from will. Reasonable provision claim under I(PFD)A 1975.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.probateGrant,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual8,
      title: "Grant of Probate Application - Intestacy",
      reference: "MAT-DEMO-020",
      practiceArea: "probate" as const,
      status: "lead" as const,
      feeEarnerId: DEMO_IDS.users.paralegal2,
      description: "Died without will. Spouse and two children. Estate value £280,000.",
      createdAt: now,
      updatedAt: now,
    },
    // Criminal matters (2)
    {
      id: DEMO_IDS.matters.criminalDriving,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual3,
      title: "Drink Driving Defence - Magistrates Court",
      reference: "MAT-DEMO-021",
      practiceArea: "criminal" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.associate,
      description: "Client charged with drink driving. Reading 95mg. Procedural defence possible.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.criminalFraud,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual4,
      title: "Fraud by False Representation - Crown Court",
      reference: "MAT-DEMO-022",
      practiceArea: "criminal" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      description: "Company director charged with VAT fraud. Value £120,000. Trial listed.",
      createdAt: now,
      updatedAt: now,
    },
    // Immigration matters (2)
    {
      id: DEMO_IDS.matters.immigrationTier2,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.company3,
      title: "Skilled Worker Visa Application - Software Engineer",
      reference: "MAT-DEMO-023",
      practiceArea: "immigration" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.associate2,
      description: "Certificate of Sponsorship issued. Application prepared for submission.",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.matters.immigrationSpouse,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual6,
      title: "Spouse Visa Extension Application",
      reference: "MAT-DEMO-024",
      practiceArea: "immigration" as const,
      status: "lead" as const,
      feeEarnerId: DEMO_IDS.users.associate2,
      description: "Initial visa expires in 2 months. Financial requirement evidence gathering.",
      createdAt: now,
      updatedAt: now,
    },
    // Commercial matter (1)
    {
      id: DEMO_IDS.matters.commercialShareholder,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.company3,
      title: "Shareholder Agreement - Tech Startup",
      reference: "MAT-DEMO-025",
      practiceArea: "commercial" as const,
      status: "active" as const,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      description: "Drafting shareholders agreement. Series A funding. 4 founders.",
      createdAt: now,
      updatedAt: now,
    },
  ];

  for (const matterData of mattersData) {
    const [matter] = await db
      .insert(matters)
      .values(matterData)
      .onConflictDoUpdate({
        target: matters.id,
        set: { updatedAt: now },
      })
      .returning();

    result.matters.push({
      id: matter.id,
      title: matter.title,
      practiceArea: matter.practiceArea,
    });
    console.log(`    Created matter: ${matter.title}`);
  }

  // 5. Create time entries
  const timeEntriesData = [
    {
      id: DEMO_IDS.timeEntries.te1,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      feeEarnerId: DEMO_IDS.users.associate,
      workDate: yesterday,
      description: "Review of title documents and property information forms",
      durationMinutes: 90,
      hourlyRate: "200.00",
      amount: "300.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te2,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      feeEarnerId: DEMO_IDS.users.associate,
      workDate: today,
      description: "Drafting enquiries to seller's solicitors",
      durationMinutes: 60,
      hourlyRate: "200.00",
      amount: "200.00",
      status: "draft" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te3,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      feeEarnerId: DEMO_IDS.users.partner,
      workDate: yesterday,
      description: "Conference with client and expert witness",
      durationMinutes: 120,
      hourlyRate: "350.00",
      amount: "700.00",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te4,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      feeEarnerId: DEMO_IDS.users.partner,
      workDate: today,
      description: "Reviewing expert report on foundation defects",
      durationMinutes: 180,
      hourlyRate: "350.00",
      amount: "1050.00",
      status: "submitted" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Conveyancing - Sale matter
    {
      id: DEMO_IDS.timeEntries.te5,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingSale,
      feeEarnerId: DEMO_IDS.users.associate2,
      workDate: yesterday,
      description: "Drafting contract for sale and fixtures list",
      durationMinutes: 120,
      hourlyRate: "180.00",
      amount: "360.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te6,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingSale,
      feeEarnerId: DEMO_IDS.users.paralegal1,
      workDate: today,
      description: "Responding to buyer's enquiries",
      durationMinutes: 45,
      hourlyRate: "100.00",
      amount: "75.00",
      status: "draft" as const,
      source: "email" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Remortgage matter
    {
      id: DEMO_IDS.timeEntries.te7,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingRemortgage,
      feeEarnerId: DEMO_IDS.users.associate,
      workDate: new Date(now.getTime() - 2 * 86400000).toISOString().split("T")[0],
      description: "Reviewing mortgage offer and conditions",
      durationMinutes: 30,
      hourlyRate: "200.00",
      amount: "100.00",
      status: "approved" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te8,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingRemortgage,
      feeEarnerId: DEMO_IDS.users.paralegal2,
      workDate: yesterday,
      description: "Ordering official copies from Land Registry",
      durationMinutes: 15,
      hourlyRate: "90.00",
      amount: "22.50",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Leasehold purchase
    {
      id: DEMO_IDS.timeEntries.te9,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingLeasehold,
      feeEarnerId: DEMO_IDS.users.associate,
      workDate: today,
      description: "Reviewing lease terms and service charge accounts",
      durationMinutes: 90,
      hourlyRate: "200.00",
      amount: "300.00",
      status: "submitted" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Debt recovery litigation
    {
      id: DEMO_IDS.timeEntries.te10,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationDebt,
      feeEarnerId: DEMO_IDS.users.associate3,
      workDate: yesterday,
      description: "Drafting letter before action",
      durationMinutes: 60,
      hourlyRate: "175.00",
      amount: "175.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te11,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationDebt,
      feeEarnerId: DEMO_IDS.users.associate3,
      workDate: today,
      description: "Preparing particulars of claim",
      durationMinutes: 150,
      hourlyRate: "175.00",
      amount: "437.50",
      status: "draft" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Contract dispute litigation
    {
      id: DEMO_IDS.timeEntries.te12,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationContract,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      workDate: new Date(now.getTime() - 3 * 86400000).toISOString().split("T")[0],
      description: "Strategy meeting with counsel",
      durationMinutes: 90,
      hourlyRate: "400.00",
      amount: "600.00",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te13,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationContract,
      feeEarnerId: DEMO_IDS.users.partner,
      workDate: yesterday,
      description: "Reviewing disclosure documents",
      durationMinutes: 240,
      hourlyRate: "350.00",
      amount: "1400.00",
      status: "submitted" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Personal injury - RTA
    {
      id: DEMO_IDS.timeEntries.te14,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryRTA,
      feeEarnerId: DEMO_IDS.users.associate2,
      workDate: new Date(now.getTime() - 4 * 86400000).toISOString().split("T")[0],
      description: "Instructing medical expert and sending papers",
      durationMinutes: 45,
      hourlyRate: "180.00",
      amount: "135.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te15,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryRTA,
      feeEarnerId: DEMO_IDS.users.associate2,
      workDate: yesterday,
      description: "Reviewing medical report and advising client",
      durationMinutes: 60,
      hourlyRate: "180.00",
      amount: "180.00",
      status: "approved" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te16,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryRTA,
      feeEarnerId: DEMO_IDS.users.paralegal1,
      workDate: today,
      description: "Obtaining police accident report",
      durationMinutes: 30,
      hourlyRate: "100.00",
      amount: "50.00",
      status: "draft" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Personal injury - Workplace
    {
      id: DEMO_IDS.timeEntries.te17,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryWorkplace,
      feeEarnerId: DEMO_IDS.users.associate2,
      workDate: new Date(now.getTime() - 5 * 86400000).toISOString().split("T")[0],
      description: "Taking detailed witness statement from client",
      durationMinutes: 90,
      hourlyRate: "180.00",
      amount: "270.00",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te18,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryWorkplace,
      feeEarnerId: DEMO_IDS.users.associate2,
      workDate: today,
      description: "Reviewing employer's accident book entry",
      durationMinutes: 30,
      hourlyRate: "180.00",
      amount: "90.00",
      status: "draft" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Slip and fall
    {
      id: DEMO_IDS.timeEntries.te19,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjurySlip,
      feeEarnerId: DEMO_IDS.users.paralegal1,
      workDate: yesterday,
      description: "Collating CCTV footage requests",
      durationMinutes: 45,
      hourlyRate: "100.00",
      amount: "75.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // CICA
    {
      id: DEMO_IDS.timeEntries.te20,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryCICA,
      feeEarnerId: DEMO_IDS.users.associate3,
      workDate: new Date(now.getTime() - 6 * 86400000).toISOString().split("T")[0],
      description: "Completing CICA application form",
      durationMinutes: 120,
      hourlyRate: "175.00",
      amount: "350.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Family - Divorce
    {
      id: DEMO_IDS.timeEntries.te21,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyDivorce,
      feeEarnerId: DEMO_IDS.users.associate2,
      workDate: new Date(now.getTime() - 7 * 86400000).toISOString().split("T")[0],
      description: "Initial client meeting - taking instructions",
      durationMinutes: 90,
      hourlyRate: "180.00",
      amount: "270.00",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te22,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyDivorce,
      feeEarnerId: DEMO_IDS.users.associate2,
      workDate: yesterday,
      description: "Drafting Form E financial disclosure",
      durationMinutes: 180,
      hourlyRate: "180.00",
      amount: "540.00",
      status: "submitted" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te23,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyDivorce,
      feeEarnerId: DEMO_IDS.users.paralegal2,
      workDate: today,
      description: "Obtaining pension CETV valuations",
      durationMinutes: 30,
      hourlyRate: "90.00",
      amount: "45.00",
      status: "draft" as const,
      source: "email" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Family - Child arrangements
    {
      id: DEMO_IDS.timeEntries.te24,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyChild,
      feeEarnerId: DEMO_IDS.users.associate2,
      workDate: new Date(now.getTime() - 8 * 86400000).toISOString().split("T")[0],
      description: "Drafting C100 application form",
      durationMinutes: 120,
      hourlyRate: "180.00",
      amount: "360.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te25,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyChild,
      feeEarnerId: DEMO_IDS.users.associate2,
      workDate: yesterday,
      description: "Reviewing CAFCASS safeguarding letter",
      durationMinutes: 45,
      hourlyRate: "180.00",
      amount: "135.00",
      status: "approved" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Family - Prenup
    {
      id: DEMO_IDS.timeEntries.te26,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyPrenup,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      workDate: new Date(now.getTime() - 9 * 86400000).toISOString().split("T")[0],
      description: "Drafting prenuptial agreement - high net worth",
      durationMinutes: 240,
      hourlyRate: "400.00",
      amount: "1600.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te27,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyPrenup,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      workDate: today,
      description: "Conference call with client re: amendments",
      durationMinutes: 60,
      hourlyRate: "400.00",
      amount: "400.00",
      status: "draft" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Employment - Unfair dismissal
    {
      id: DEMO_IDS.timeEntries.te28,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentDismissal,
      feeEarnerId: DEMO_IDS.users.associate3,
      workDate: new Date(now.getTime() - 10 * 86400000).toISOString().split("T")[0],
      description: "Initial consultation - employment history review",
      durationMinutes: 90,
      hourlyRate: "175.00",
      amount: "262.50",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te29,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentDismissal,
      feeEarnerId: DEMO_IDS.users.associate3,
      workDate: yesterday,
      description: "Drafting ET1 claim form",
      durationMinutes: 180,
      hourlyRate: "175.00",
      amount: "525.00",
      status: "submitted" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te30,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentDismissal,
      feeEarnerId: DEMO_IDS.users.paralegal2,
      workDate: today,
      description: "Collating evidence bundle",
      durationMinutes: 120,
      hourlyRate: "90.00",
      amount: "180.00",
      status: "draft" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Employment - Redundancy
    {
      id: DEMO_IDS.timeEntries.te31,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentRedundancy,
      feeEarnerId: DEMO_IDS.users.associate3,
      workDate: new Date(now.getTime() - 11 * 86400000).toISOString().split("T")[0],
      description: "Reviewing redundancy selection matrix",
      durationMinutes: 60,
      hourlyRate: "175.00",
      amount: "175.00",
      status: "approved" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te32,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentRedundancy,
      feeEarnerId: DEMO_IDS.users.associate3,
      workDate: today,
      description: "Advising on procedural unfairness",
      durationMinutes: 45,
      hourlyRate: "175.00",
      amount: "131.25",
      status: "draft" as const,
      source: "email" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Employment - Settlement
    {
      id: DEMO_IDS.timeEntries.te33,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentSettlement,
      feeEarnerId: DEMO_IDS.users.associate,
      workDate: new Date(now.getTime() - 12 * 86400000).toISOString().split("T")[0],
      description: "Negotiating settlement terms with employer",
      durationMinutes: 90,
      hourlyRate: "200.00",
      amount: "300.00",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te34,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentSettlement,
      feeEarnerId: DEMO_IDS.users.associate,
      workDate: yesterday,
      description: "Reviewing and amending settlement agreement",
      durationMinutes: 120,
      hourlyRate: "200.00",
      amount: "400.00",
      status: "approved" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Probate - Estate administration
    {
      id: DEMO_IDS.timeEntries.te35,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateEstate,
      feeEarnerId: DEMO_IDS.users.associate3,
      workDate: new Date(now.getTime() - 13 * 86400000).toISOString().split("T")[0],
      description: "Valuing estate assets for IHT purposes",
      durationMinutes: 180,
      hourlyRate: "175.00",
      amount: "525.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te36,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateEstate,
      feeEarnerId: DEMO_IDS.users.paralegal2,
      workDate: yesterday,
      description: "Corresponding with asset holders",
      durationMinutes: 60,
      hourlyRate: "90.00",
      amount: "90.00",
      status: "approved" as const,
      source: "email" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Will dispute
    {
      id: DEMO_IDS.timeEntries.te37,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateDispute,
      feeEarnerId: DEMO_IDS.users.partner,
      workDate: new Date(now.getTime() - 14 * 86400000).toISOString().split("T")[0],
      description: "Advising on Inheritance Act claim prospects",
      durationMinutes: 90,
      hourlyRate: "350.00",
      amount: "525.00",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te38,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateDispute,
      feeEarnerId: DEMO_IDS.users.partner,
      workDate: today,
      description: "Drafting letter of claim",
      durationMinutes: 120,
      hourlyRate: "350.00",
      amount: "700.00",
      status: "draft" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Grant of probate
    {
      id: DEMO_IDS.timeEntries.te39,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateGrant,
      feeEarnerId: DEMO_IDS.users.paralegal2,
      workDate: yesterday,
      description: "Preparing PA1A intestacy application",
      durationMinutes: 90,
      hourlyRate: "90.00",
      amount: "135.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Criminal - Drink driving
    {
      id: DEMO_IDS.timeEntries.te40,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.criminalDriving,
      feeEarnerId: DEMO_IDS.users.associate3,
      workDate: new Date(now.getTime() - 15 * 86400000).toISOString().split("T")[0],
      description: "Police station attendance - initial advice",
      durationMinutes: 180,
      hourlyRate: "175.00",
      amount: "525.00",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te41,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.criminalDriving,
      feeEarnerId: DEMO_IDS.users.associate3,
      workDate: yesterday,
      description: "Reviewing prosecution evidence",
      durationMinutes: 60,
      hourlyRate: "175.00",
      amount: "175.00",
      status: "approved" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Criminal - Fraud
    {
      id: DEMO_IDS.timeEntries.te42,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.criminalFraud,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      workDate: new Date(now.getTime() - 16 * 86400000).toISOString().split("T")[0],
      description: "Conference with client at prison",
      durationMinutes: 240,
      hourlyRate: "400.00",
      amount: "1600.00",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te43,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.criminalFraud,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      workDate: today,
      description: "Reviewing unused material disclosure",
      durationMinutes: 180,
      hourlyRate: "400.00",
      amount: "1200.00",
      status: "draft" as const,
      source: "document_activity" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Immigration - Skilled worker
    {
      id: DEMO_IDS.timeEntries.te44,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.immigrationSkilled,
      feeEarnerId: DEMO_IDS.users.associate,
      workDate: new Date(now.getTime() - 17 * 86400000).toISOString().split("T")[0],
      description: "Completing online visa application",
      durationMinutes: 120,
      hourlyRate: "200.00",
      amount: "400.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te45,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.immigrationSkilled,
      feeEarnerId: DEMO_IDS.users.paralegal1,
      workDate: yesterday,
      description: "Preparing supporting documents bundle",
      durationMinutes: 90,
      hourlyRate: "100.00",
      amount: "150.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Immigration - Spouse visa
    {
      id: DEMO_IDS.timeEntries.te46,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.immigrationSpouse,
      feeEarnerId: DEMO_IDS.users.associate,
      workDate: today,
      description: "Advising on financial requirement evidence",
      durationMinutes: 45,
      hourlyRate: "200.00",
      amount: "150.00",
      status: "draft" as const,
      source: "email" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Commercial - Shareholder agreement
    {
      id: DEMO_IDS.timeEntries.te47,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.commercialShareholder,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      workDate: new Date(now.getTime() - 18 * 86400000).toISOString().split("T")[0],
      description: "Drafting shareholder agreement",
      durationMinutes: 300,
      hourlyRate: "400.00",
      amount: "2000.00",
      status: "approved" as const,
      source: "manual" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te48,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.commercialShareholder,
      feeEarnerId: DEMO_IDS.users.seniorPartner,
      workDate: yesterday,
      description: "Negotiating investor protection clauses",
      durationMinutes: 120,
      hourlyRate: "400.00",
      amount: "800.00",
      status: "submitted" as const,
      source: "calendar" as const,
      isBillable: true,
      createdAt: now,
      updatedAt: now,
    },
    // Non-billable entries
    {
      id: DEMO_IDS.timeEntries.te49,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      feeEarnerId: DEMO_IDS.users.associate,
      workDate: today,
      description: "Training session - new conveyancing software",
      durationMinutes: 60,
      hourlyRate: "200.00",
      amount: "200.00",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: false,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.timeEntries.te50,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      feeEarnerId: DEMO_IDS.users.partner,
      workDate: yesterday,
      description: "Pro bono advice clinic",
      durationMinutes: 120,
      hourlyRate: "350.00",
      amount: "700.00",
      status: "approved" as const,
      source: "calendar" as const,
      isBillable: false,
      createdAt: now,
      updatedAt: now,
    },
  ];

  for (const teData of timeEntriesData) {
    const [te] = await db
      .insert(timeEntries)
      .values(teData)
      .onConflictDoUpdate({
        target: timeEntries.id,
        set: { updatedAt: now },
      })
      .returning();

    result.timeEntries.push({
      id: te.id,
      description: te.description,
      amount: te.amount,
    });
    console.log(`    Created time entry: ${te.description.substring(0, 40)}...`);
  }

  // 6. Create tasks
  const twoDaysAgo = new Date(now.getTime() - 172800000).toISOString();
  const tomorrow = new Date(now.getTime() + 86400000).toISOString();
  const nextWeek = new Date(now.getTime() + 604800000).toISOString();
  const nextMonth = new Date(now.getTime() + 2592000000).toISOString();

  const tasksData = [
    // Conveyancing tasks
    {
      id: DEMO_IDS.tasks.task1,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      title: "Chase seller's solicitors for replies to enquiries",
      description: "Follow up on outstanding responses to property enquiries sent last week",
      status: "in_progress" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.associate,
      createdById: DEMO_IDS.users.associate,
      dueDate: new Date(today),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task2,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      title: "Order local searches",
      description: "Submit search application to local authority",
      status: "pending" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.paralegal1,
      createdById: DEMO_IDS.users.associate,
      dueDate: new Date(tomorrow),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task3,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      title: "Draft contract report for client",
      description: "Prepare detailed report on contract terms and searches",
      status: "pending" as const,
      priority: "medium" as const,
      assigneeId: DEMO_IDS.users.associate,
      createdById: DEMO_IDS.users.associate,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    // Litigation tasks
    {
      id: DEMO_IDS.tasks.task4,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      title: "Review expert report on construction defects",
      description: "Detailed review of structural engineer's findings",
      status: "completed" as const,
      priority: "urgent" as const,
      assigneeId: DEMO_IDS.users.partner,
      createdById: DEMO_IDS.users.partner,
      dueDate: new Date(yesterday),
      completedAt: now,
      createdAt: new Date(twoDaysAgo),
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task5,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      title: "Draft particulars of claim",
      description: "Prepare detailed statement of case for court filing",
      status: "in_progress" as const,
      priority: "urgent" as const,
      assigneeId: DEMO_IDS.users.partner,
      createdById: DEMO_IDS.users.partner,
      dueDate: new Date(today),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task6,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      title: "Prepare court bundle",
      description: "Compile all documents for trial bundle in accordance with CPR",
      status: "pending" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.paralegal1,
      createdById: DEMO_IDS.users.partner,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task7,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationDebt,
      title: "File claim form at court",
      description: "Issue claim form N1 for debt recovery",
      status: "completed" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.associate3,
      createdById: DEMO_IDS.users.associate3,
      dueDate: new Date(yesterday),
      completedAt: now,
      createdAt: new Date(twoDaysAgo),
      updatedAt: now,
    },
    // Personal Injury tasks
    {
      id: DEMO_IDS.tasks.task8,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryRTA,
      title: "Obtain medical records",
      description: "Request full medical records from GP and hospital",
      status: "in_progress" as const,
      priority: "medium" as const,
      assigneeId: DEMO_IDS.users.paralegal2,
      createdById: DEMO_IDS.users.partner,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task9,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryRTA,
      title: "Send letter of claim to defendant",
      description: "Prepare and send detailed letter of claim under PI protocol",
      status: "pending" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.partner,
      createdById: DEMO_IDS.users.partner,
      dueDate: new Date(tomorrow),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task10,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryWorkplace,
      title: "Instruct medical expert",
      description: "Appoint orthopaedic consultant for back injury assessment",
      status: "pending" as const,
      priority: "medium" as const,
      assigneeId: DEMO_IDS.users.partner,
      createdById: DEMO_IDS.users.partner,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    // Family law tasks
    {
      id: DEMO_IDS.tasks.task11,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyDivorce,
      title: "Complete Form E financial disclosure",
      description: "Full financial disclosure form with supporting documents",
      status: "in_progress" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.associate2,
      createdById: DEMO_IDS.users.associate2,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task12,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyDivorce,
      title: "Review pension valuation",
      description: "Analyse pension sharing options with client",
      status: "pending" as const,
      priority: "medium" as const,
      assigneeId: DEMO_IDS.users.associate2,
      createdById: DEMO_IDS.users.associate2,
      dueDate: new Date(nextMonth),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task13,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyChild,
      title: "Review CAFCASS report",
      description: "Analyse recommendations and discuss with client",
      status: "pending" as const,
      priority: "urgent" as const,
      assigneeId: DEMO_IDS.users.associate2,
      createdById: DEMO_IDS.users.associate2,
      dueDate: new Date(today),
      createdAt: now,
      updatedAt: now,
    },
    // Employment tasks
    {
      id: DEMO_IDS.tasks.task14,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentDismissal,
      title: "Prepare witness statements",
      description: "Draft witness statements from client and colleagues",
      status: "in_progress" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.associate3,
      createdById: DEMO_IDS.users.associate3,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task15,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentRedundancy,
      title: "Challenge redundancy selection matrix",
      description: "Prepare detailed analysis of scoring inconsistencies",
      status: "pending" as const,
      priority: "medium" as const,
      assigneeId: DEMO_IDS.users.associate3,
      createdById: DEMO_IDS.users.associate3,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    // Probate tasks
    {
      id: DEMO_IDS.tasks.task16,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateEstate,
      title: "Apply for grant of probate",
      description: "Submit PA1P application with IHT forms",
      status: "pending" as const,
      priority: "medium" as const,
      assigneeId: DEMO_IDS.users.paralegal2,
      createdById: DEMO_IDS.users.paralegal2,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task17,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateEstate,
      title: "Value estate assets",
      description: "Obtain valuations for property and investments",
      status: "in_progress" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.paralegal2,
      createdById: DEMO_IDS.users.paralegal2,
      dueDate: new Date(tomorrow),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task18,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateDispute,
      title: "Draft letter of claim under Inheritance Act",
      description: "Prepare detailed claim for reasonable financial provision",
      status: "pending" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.seniorPartner,
      createdById: DEMO_IDS.users.seniorPartner,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    // Criminal tasks
    {
      id: DEMO_IDS.tasks.task19,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.criminalDriving,
      title: "Review breathalyser calibration records",
      description: "Obtain and analyse device maintenance logs",
      status: "in_progress" as const,
      priority: "urgent" as const,
      assigneeId: DEMO_IDS.users.associate,
      createdById: DEMO_IDS.users.associate,
      dueDate: new Date(today),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task20,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.criminalFraud,
      title: "Prepare defence case statement",
      description: "Draft detailed defence under CPIA requirements",
      status: "pending" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.seniorPartner,
      createdById: DEMO_IDS.users.seniorPartner,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    // Immigration tasks
    {
      id: DEMO_IDS.tasks.task21,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.immigrationTier2,
      title: "Submit visa application online",
      description: "Complete and submit application via UK Visas portal",
      status: "pending" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.associate2,
      createdById: DEMO_IDS.users.associate2,
      dueDate: new Date(tomorrow),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task22,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.immigrationSpouse,
      title: "Gather financial evidence",
      description: "Collect 6 months payslips and bank statements",
      status: "in_progress" as const,
      priority: "urgent" as const,
      assigneeId: DEMO_IDS.users.paralegal1,
      createdById: DEMO_IDS.users.associate2,
      dueDate: new Date(today),
      createdAt: now,
      updatedAt: now,
    },
    // Commercial tasks
    {
      id: DEMO_IDS.tasks.task23,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.commercialShareholder,
      title: "Draft drag-along rights clause",
      description: "Prepare protective provisions for minority shareholders",
      status: "pending" as const,
      priority: "medium" as const,
      assigneeId: DEMO_IDS.users.seniorPartner,
      createdById: DEMO_IDS.users.seniorPartner,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task24,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.commercialShareholder,
      title: "Review investor term sheet",
      description: "Analyse Series A funding terms and conditions",
      status: "completed" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.seniorPartner,
      createdById: DEMO_IDS.users.seniorPartner,
      dueDate: new Date(yesterday),
      completedAt: now,
      createdAt: new Date(twoDaysAgo),
      updatedAt: now,
    },
    // Additional conveyancing tasks
    {
      id: DEMO_IDS.tasks.task25,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingSale,
      title: "Obtain energy performance certificate",
      description: "Arrange EPC inspection for property sale",
      status: "pending" as const,
      priority: "low" as const,
      assigneeId: DEMO_IDS.users.paralegal1,
      createdById: DEMO_IDS.users.associate2,
      dueDate: new Date(nextMonth),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task26,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingSale,
      title: "Complete property information forms",
      description: "TA6 and TA10 forms with client",
      status: "in_progress" as const,
      priority: "medium" as const,
      assigneeId: DEMO_IDS.users.associate2,
      createdById: DEMO_IDS.users.associate2,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task27,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingLeasehold,
      title: "Review lease terms and restrictions",
      description: "Check lease for onerous covenants and ground rent",
      status: "pending" as const,
      priority: "high" as const,
      assigneeId: DEMO_IDS.users.associate2,
      createdById: DEMO_IDS.users.associate2,
      dueDate: new Date(tomorrow),
      createdAt: now,
      updatedAt: now,
    },
    // Overdue tasks
    {
      id: DEMO_IDS.tasks.task28,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationContract,
      title: "Chase witness statement from client",
      description: "Follow up - statement now 3 days overdue",
      status: "pending" as const,
      priority: "urgent" as const,
      assigneeId: DEMO_IDS.users.seniorPartner,
      createdById: DEMO_IDS.users.seniorPartner,
      dueDate: new Date(twoDaysAgo),
      createdAt: new Date(twoDaysAgo),
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task29,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryCICA,
      title: "Submit CICA application",
      description: "Complete online CICA claim form - deadline approaching",
      status: "pending" as const,
      priority: "urgent" as const,
      assigneeId: DEMO_IDS.users.partner,
      createdById: DEMO_IDS.users.partner,
      dueDate: new Date(yesterday),
      createdAt: new Date(twoDaysAgo),
      updatedAt: now,
    },
    {
      id: DEMO_IDS.tasks.task30,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyPrenup,
      title: "Arrange independent legal advice for client's partner",
      description: "Refer partner to separate solicitor for ILA on prenup",
      status: "pending" as const,
      priority: "medium" as const,
      assigneeId: DEMO_IDS.users.seniorPartner,
      createdById: DEMO_IDS.users.seniorPartner,
      dueDate: new Date(nextWeek),
      createdAt: now,
      updatedAt: now,
    },
  ];

  for (const taskData of tasksData) {
    const [task] = await db
      .insert(tasks)
      .values(taskData)
      .onConflictDoUpdate({
        target: tasks.id,
        set: { updatedAt: now },
      })
      .returning();

    result.tasks.push({
      id: task.id,
      title: task.title,
      status: task.status,
    });
    console.log(`    Created task: ${task.title.substring(0, 50)}...`);
  }

  // 7. Create invoices
  const invoicesData = [
    // Draft invoices (2)
    {
      id: DEMO_IDS.invoices.inv1,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual,
      matterId: DEMO_IDS.matters.conveyancing,
      invoiceNumber: "INV-2024-001",
      status: "draft" as const,
      invoiceDate: "2024-11-01",
      dueDate: "2024-12-01",
      subtotal: "500.00",
      vatAmount: "100.00",
      vatRate: "20.00",
      total: "600.00",
      paidAmount: "0.00",
      balanceDue: "600.00",
      terms: "Payment due within 30 days",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.invoices.inv2,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.company,
      matterId: DEMO_IDS.matters.litigation,
      invoiceNumber: "INV-2024-002",
      status: "draft" as const,
      invoiceDate: "2024-11-05",
      dueDate: "2024-12-05",
      subtotal: "1750.00",
      vatAmount: "350.00",
      vatRate: "20.00",
      total: "2100.00",
      paidAmount: "0.00",
      balanceDue: "2100.00",
      terms: "Payment due within 30 days",
      createdAt: now,
      updatedAt: now,
    },
    // Sent invoices (3)
    {
      id: DEMO_IDS.invoices.inv3,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual3,
      matterId: DEMO_IDS.matters.personalInjuryRTA,
      invoiceNumber: "INV-2024-003",
      status: "sent" as const,
      invoiceDate: "2024-10-15",
      dueDate: "2024-11-15",
      subtotal: "1250.00",
      vatAmount: "250.00",
      vatRate: "20.00",
      total: "1500.00",
      paidAmount: "0.00",
      balanceDue: "1500.00",
      terms: "Payment due within 30 days",
      sentAt: new Date("2024-10-15T10:00:00Z"),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.invoices.inv4,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.company3,
      matterId: DEMO_IDS.matters.commercialShareholder,
      invoiceNumber: "INV-2024-004",
      status: "sent" as const,
      invoiceDate: "2024-10-20",
      dueDate: "2024-11-20",
      subtotal: "3500.00",
      vatAmount: "700.00",
      vatRate: "20.00",
      total: "4200.00",
      paidAmount: "0.00",
      balanceDue: "4200.00",
      terms: "Payment due within 30 days",
      sentAt: new Date("2024-10-20T14:30:00Z"),
      viewedAt: new Date("2024-10-21T09:15:00Z"),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.invoices.inv5,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual4,
      matterId: DEMO_IDS.matters.employmentDismissal,
      invoiceNumber: "INV-2024-005",
      status: "sent" as const,
      invoiceDate: "2024-10-25",
      dueDate: "2024-11-25",
      subtotal: "2800.00",
      vatAmount: "560.00",
      vatRate: "20.00",
      total: "3360.00",
      paidAmount: "0.00",
      balanceDue: "3360.00",
      terms: "Payment due within 30 days",
      sentAt: new Date("2024-10-25T16:00:00Z"),
      createdAt: now,
      updatedAt: now,
    },
    // Partially paid invoices (2)
    {
      id: DEMO_IDS.invoices.inv6,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.company4,
      matterId: DEMO_IDS.matters.litigationContract,
      invoiceNumber: "INV-2024-006",
      status: "partially_paid" as const,
      invoiceDate: "2024-09-15",
      dueDate: "2024-10-15",
      subtotal: "5000.00",
      vatAmount: "1000.00",
      vatRate: "20.00",
      total: "6000.00",
      paidAmount: "3000.00",
      balanceDue: "3000.00",
      terms: "Payment due within 30 days",
      sentAt: new Date("2024-09-15T11:00:00Z"),
      viewedAt: new Date("2024-09-15T15:30:00Z"),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.invoices.inv7,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual7,
      matterId: DEMO_IDS.matters.familyChild,
      invoiceNumber: "INV-2024-007",
      status: "partially_paid" as const,
      invoiceDate: "2024-09-20",
      dueDate: "2024-10-20",
      subtotal: "4500.00",
      vatAmount: "900.00",
      vatRate: "20.00",
      total: "5400.00",
      paidAmount: "2000.00",
      balanceDue: "3400.00",
      terms: "Payment due within 30 days",
      sentAt: new Date("2024-09-20T09:30:00Z"),
      viewedAt: new Date("2024-09-20T11:45:00Z"),
      createdAt: now,
      updatedAt: now,
    },
    // Paid invoices (3)
    {
      id: DEMO_IDS.invoices.inv8,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual5,
      matterId: DEMO_IDS.matters.personalInjurySlip,
      invoiceNumber: "INV-2024-008",
      status: "paid" as const,
      invoiceDate: "2024-08-10",
      dueDate: "2024-09-10",
      subtotal: "850.00",
      vatAmount: "170.00",
      vatRate: "20.00",
      total: "1020.00",
      paidAmount: "1020.00",
      balanceDue: "0.00",
      terms: "Payment due within 30 days",
      sentAt: new Date("2024-08-10T10:00:00Z"),
      viewedAt: new Date("2024-08-10T14:20:00Z"),
      paidAt: new Date("2024-08-25T11:30:00Z"),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.invoices.inv9,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.company5,
      matterId: DEMO_IDS.matters.conveyancingRemortgage,
      invoiceNumber: "INV-2024-009",
      status: "paid" as const,
      invoiceDate: "2024-08-05",
      dueDate: "2024-09-05",
      subtotal: "2500.00",
      vatAmount: "500.00",
      vatRate: "20.00",
      total: "3000.00",
      paidAmount: "3000.00",
      balanceDue: "0.00",
      terms: "Payment due within 30 days",
      sentAt: new Date("2024-08-05T09:00:00Z"),
      viewedAt: new Date("2024-08-05T10:15:00Z"),
      paidAt: new Date("2024-08-20T14:00:00Z"),
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.invoices.inv10,
      firmId: DEMO_IDS.firm,
      clientId: DEMO_IDS.clients.individual5,
      matterId: DEMO_IDS.matters.employmentSettlement,
      invoiceNumber: "INV-2024-010",
      status: "paid" as const,
      invoiceDate: "2024-07-20",
      dueDate: "2024-08-20",
      subtotal: "3750.00",
      vatAmount: "750.00",
      vatRate: "20.00",
      total: "4500.00",
      paidAmount: "4500.00",
      balanceDue: "0.00",
      terms: "Payment due within 30 days",
      sentAt: new Date("2024-07-20T10:30:00Z"),
      viewedAt: new Date("2024-07-20T16:00:00Z"),
      paidAt: new Date("2024-08-05T09:45:00Z"),
      createdAt: now,
      updatedAt: now,
    },
  ];

  for (const invoiceData of invoicesData) {
    const [invoice] = await db
      .insert(invoices)
      .values(invoiceData)
      .onConflictDoUpdate({
        target: invoices.id,
        set: { updatedAt: now },
      })
      .returning();

    console.log(`    Created invoice: ${invoice.invoiceNumber} - ${invoice.status}`);
  }

  // 8. Create payments
  const paymentsData = [
    // Payment for inv6 (partially paid)
    {
      id: DEMO_IDS.payments.pay1,
      firmId: DEMO_IDS.firm,
      invoiceId: DEMO_IDS.invoices.inv6,
      amount: "3000.00",
      method: "bank_transfer" as const,
      paymentDate: "2024-10-01",
      reference: "BACS-123456",
      notes: "Partial payment - balance to follow",
      recordedBy: DEMO_IDS.users.receptionist,
      createdAt: now,
    },
    // Payment for inv7 (partially paid)
    {
      id: DEMO_IDS.payments.pay2,
      firmId: DEMO_IDS.firm,
      invoiceId: DEMO_IDS.invoices.inv7,
      amount: "2000.00",
      method: "card" as const,
      paymentDate: "2024-10-05",
      reference: "CARD-789012",
      notes: "Initial payment via client portal",
      recordedBy: DEMO_IDS.users.receptionist,
      createdAt: now,
    },
    // Payment for inv8 (paid in full)
    {
      id: DEMO_IDS.payments.pay3,
      firmId: DEMO_IDS.firm,
      invoiceId: DEMO_IDS.invoices.inv8,
      amount: "1020.00",
      method: "bank_transfer" as const,
      paymentDate: "2024-08-25",
      reference: "BACS-345678",
      notes: "Full payment received",
      recordedBy: DEMO_IDS.users.receptionist,
      createdAt: now,
    },
    // Payment for inv9 (paid in full)
    {
      id: DEMO_IDS.payments.pay4,
      firmId: DEMO_IDS.firm,
      invoiceId: DEMO_IDS.invoices.inv9,
      amount: "3000.00",
      method: "bank_transfer" as const,
      paymentDate: "2024-08-20",
      reference: "BACS-456789",
      notes: "Remortgage completion payment",
      recordedBy: DEMO_IDS.users.receptionist,
      createdAt: now,
    },
    // Payment for inv10 (paid in full)
    {
      id: DEMO_IDS.payments.pay5,
      firmId: DEMO_IDS.firm,
      invoiceId: DEMO_IDS.invoices.inv10,
      amount: "4500.00",
      method: "bank_transfer" as const,
      paymentDate: "2024-08-05",
      reference: "BACS-567890",
      notes: "Settlement agreement fee paid",
      recordedBy: DEMO_IDS.users.receptionist,
      createdAt: now,
    },
  ];

  for (const paymentData of paymentsData) {
    const [payment] = await db
      .insert(payments)
      .values(paymentData)
      .onConflictDoUpdate({
        target: payments.id,
        set: { createdAt: now },
      })
      .returning();

    console.log(`    Created payment: ${payment.reference} - £${payment.amount}`);
  }

  // 9. Create notifications
  const notificationsData = [
    // Task assigned notifications (3)
    {
      id: DEMO_IDS.notifications.notif1,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate,
      type: "task_assigned" as const,
      title: "New task assigned: Chase seller's solicitors",
      body: "Sarah Harrison has assigned you a high priority task for the Willow Lane conveyancing matter.",
      link: `/matters/${DEMO_IDS.matters.conveyancing}/tasks`,
      read: false,
      createdAt: new Date(now.getTime() - 3600000), // 1 hour ago
    },
    {
      id: DEMO_IDS.notifications.notif2,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.paralegal1,
      type: "task_assigned" as const,
      title: "New task assigned: Order local searches",
      body: "James Clarke has assigned you a task for the Willow Lane conveyancing matter.",
      link: `/matters/${DEMO_IDS.matters.conveyancing}/tasks`,
      read: true,
      readAt: new Date(now.getTime() - 1800000), // 30 mins ago
      createdAt: new Date(now.getTime() - 7200000), // 2 hours ago
    },
    {
      id: DEMO_IDS.notifications.notif3,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate2,
      type: "task_assigned" as const,
      title: "New task assigned: Prepare completion statement",
      body: "Victoria Clarke has assigned you a task for the Kensington Gardens sale.",
      link: `/matters/${DEMO_IDS.matters.conveyancingSale}/tasks`,
      read: false,
      createdAt: new Date(now.getTime() - 10800000), // 3 hours ago
    },
    // Task due reminders (5)
    {
      id: DEMO_IDS.notifications.notif4,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate,
      type: "task_due" as const,
      title: "Task due today: Chase seller's solicitors",
      body: "Your task 'Chase seller's solicitors for replies to enquiries' is due today.",
      link: `/matters/${DEMO_IDS.matters.conveyancing}/tasks`,
      read: false,
      createdAt: new Date(now.getTime() - 14400000), // 4 hours ago
    },
    {
      id: DEMO_IDS.notifications.notif5,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.partner,
      type: "task_due" as const,
      title: "Task due tomorrow: Review expert report",
      body: "Your task 'Review expert report on construction defects' is due tomorrow.",
      link: `/matters/${DEMO_IDS.matters.litigation}/tasks`,
      read: true,
      readAt: new Date(now.getTime() - 10800000),
      createdAt: new Date(now.getTime() - 18000000), // 5 hours ago
    },
    {
      id: DEMO_IDS.notifications.notif6,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate3,
      type: "task_due" as const,
      title: "Task due in 2 days: Draft particulars of claim",
      body: "Your task for the debt recovery matter is due in 2 days.",
      link: `/matters/${DEMO_IDS.matters.litigationDebt}/tasks`,
      read: false,
      createdAt: new Date(now.getTime() - 21600000), // 6 hours ago
    },
    {
      id: DEMO_IDS.notifications.notif7,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate2,
      type: "task_due" as const,
      title: "Task due today: Update client on progress",
      body: "Your task for the family divorce matter is due today.",
      link: `/matters/${DEMO_IDS.matters.familyDivorce}/tasks`,
      read: true,
      readAt: new Date(now.getTime() - 14400000),
      createdAt: new Date(now.getTime() - 25200000), // 7 hours ago
    },
    {
      id: DEMO_IDS.notifications.notif8,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate3,
      type: "task_due" as const,
      title: "Task due today: Submit ET-1 form",
      body: "Your task 'Submit ET-1 form to tribunal' is due today for the unfair dismissal case.",
      link: `/matters/${DEMO_IDS.matters.employmentDismissal}/tasks`,
      read: false,
      createdAt: new Date(now.getTime() - 28800000), // 8 hours ago
    },
    // Invoice paid notifications (4)
    {
      id: DEMO_IDS.notifications.notif9,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.partner,
      type: "invoice_paid" as const,
      title: "Invoice INV-2024-008 paid in full",
      body: "Margaret Thompson has paid invoice INV-2024-008 (£1,020.00) via bank transfer.",
      link: `/billing/invoices/${DEMO_IDS.invoices.inv8}`,
      read: true,
      readAt: new Date(now.getTime() - 21600000),
      createdAt: new Date(now.getTime() - 43200000), // 12 hours ago
    },
    {
      id: DEMO_IDS.notifications.notif10,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate,
      type: "invoice_paid" as const,
      title: "Invoice INV-2024-009 paid in full",
      body: "Apex Developments Ltd has paid invoice INV-2024-009 (£3,000.00) for the remortgage matter.",
      link: `/billing/invoices/${DEMO_IDS.invoices.inv9}`,
      read: false,
      createdAt: new Date(now.getTime() - 86400000), // 1 day ago
    },
    {
      id: DEMO_IDS.notifications.notif11,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate3,
      type: "invoice_paid" as const,
      title: "Invoice INV-2024-010 paid in full",
      body: "Michael O'Brien has paid invoice INV-2024-010 (£4,500.00) for the settlement agreement.",
      link: `/billing/invoices/${DEMO_IDS.invoices.inv10}`,
      read: true,
      readAt: new Date(now.getTime() - 64800000),
      createdAt: new Date(now.getTime() - 172800000), // 2 days ago
    },
    {
      id: DEMO_IDS.notifications.notif12,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.receptionist,
      type: "payment_received" as const,
      title: "Payment received: £1,500.00",
      body: "Partial payment received for invoice INV-2024-003. Balance remaining: £1,500.00",
      link: `/billing/invoices/${DEMO_IDS.invoices.inv3}`,
      read: false,
      createdAt: new Date(now.getTime() - 259200000), // 3 days ago
    },
    // Document uploaded notifications (3)
    {
      id: DEMO_IDS.notifications.notif13,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate,
      type: "document_uploaded" as const,
      title: "New document: Contract Pack.pdf",
      body: "Sarah Harrison uploaded a new document to the Willow Lane conveyancing matter.",
      link: `/matters/${DEMO_IDS.matters.conveyancing}/documents`,
      read: true,
      readAt: new Date(now.getTime() - 172800000),
      createdAt: new Date(now.getTime() - 345600000), // 4 days ago
    },
    {
      id: DEMO_IDS.notifications.notif14,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.partner,
      type: "document_uploaded" as const,
      title: "New document: Expert Report - Structural.pdf",
      body: "James Clarke uploaded a new document to the construction defects litigation matter.",
      link: `/matters/${DEMO_IDS.matters.litigation}/documents`,
      read: false,
      createdAt: new Date(now.getTime() - 432000000), // 5 days ago
    },
    {
      id: DEMO_IDS.notifications.notif15,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate2,
      type: "document_uploaded" as const,
      title: "New document: Title Deeds.pdf",
      body: "Tom Richards uploaded title deeds for the Kensington Gardens sale.",
      link: `/matters/${DEMO_IDS.matters.conveyancingSale}/documents`,
      read: true,
      readAt: new Date(now.getTime() - 432000000),
      createdAt: new Date(now.getTime() - 518400000), // 6 days ago
    },
    // Deadline approaching notifications (3)
    {
      id: DEMO_IDS.notifications.notif16,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate,
      type: "deadline_approaching" as const,
      title: "Deadline approaching: Exchange of contracts",
      body: "Exchange deadline for Willow Lane purchase is in 3 days (2024-11-15).",
      link: `/matters/${DEMO_IDS.matters.conveyancing}`,
      read: false,
      createdAt: new Date(now.getTime() - 604800000), // 7 days ago
    },
    {
      id: DEMO_IDS.notifications.notif17,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.partner,
      type: "deadline_approaching" as const,
      title: "Deadline approaching: Defence filing deadline",
      body: "Defence must be filed by 2024-11-20 for the construction defects claim.",
      link: `/matters/${DEMO_IDS.matters.litigation}`,
      read: true,
      readAt: new Date(now.getTime() - 604800000),
      createdAt: new Date(now.getTime() - 691200000), // 8 days ago
    },
    {
      id: DEMO_IDS.notifications.notif18,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.associate3,
      type: "deadline_approaching" as const,
      title: "Deadline approaching: ET response deadline",
      body: "Employment tribunal response deadline is in 5 days for the unfair dismissal case.",
      link: `/matters/${DEMO_IDS.matters.employmentDismissal}`,
      read: false,
      createdAt: new Date(now.getTime() - 777600000), // 9 days ago
    },
    // System notifications (2)
    {
      id: DEMO_IDS.notifications.notif19,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.partner,
      type: "system" as const,
      title: "Monthly billing summary ready",
      body: "Your October 2024 billing summary is ready to review. Total billed: £45,600.00",
      link: "/billing/reports",
      read: true,
      readAt: new Date(now.getTime() - 691200000),
      createdAt: new Date(now.getTime() - 864000000), // 10 days ago
    },
    {
      id: DEMO_IDS.notifications.notif20,
      firmId: DEMO_IDS.firm,
      userId: DEMO_IDS.users.seniorPartner,
      type: "system" as const,
      title: "Firm compliance review complete",
      body: "Your quarterly SRA compliance review has been completed. No issues identified.",
      link: "/compliance/reviews",
      read: false,
      createdAt: new Date(now.getTime() - 1209600000), // 14 days ago
    },
  ];

  for (const notificationData of notificationsData) {
    const [notification] = await db
      .insert(notifications)
      .values(notificationData)
      .onConflictDoUpdate({
        target: notifications.id,
        set: { createdAt: notificationData.createdAt },
      })
      .returning();

    console.log(
      `    Created notification: ${notification.title.substring(0, 50)}... (${notification.read ? "read" : "unread"})`
    );
  }

  // 10. Create risk evaluations
  const riskEvaluationsData = [
    // Low risk (10-33): routine conveyancing
    {
      id: DEMO_IDS.riskEvaluations.risk1,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      score: 15,
      severity: "low" as const,
      factors: [
        { factor: "routine_matter", weight: 0.5, evidence: "Standard residential purchase" },
        { factor: "experienced_handler", weight: 0.3, evidence: "Senior partner assigned" },
        { factor: "adequate_timeline", weight: 0.2, evidence: "4 weeks to completion" },
      ],
      recommendations: [
        "Continue with standard conveyancing procedures",
        "Ensure all searches are ordered promptly",
      ],
      aiModel: "gpt-4",
      evaluatedAt: new Date("2024-10-01T09:00:00Z"),
    },
    {
      id: DEMO_IDS.riskEvaluations.risk2,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingSale,
      score: 22,
      severity: "low" as const,
      factors: [
        { factor: "routine_matter", weight: 0.5, evidence: "Standard property sale" },
        { factor: "clear_title", weight: 0.3, evidence: "No title issues identified" },
        { factor: "cooperative_parties", weight: 0.2, evidence: "Both parties engaged" },
      ],
      recommendations: ["Proceed with standard sale process", "Monitor completion timeline"],
      aiModel: "gpt-4",
      evaluatedAt: new Date("2024-09-15T10:30:00Z"),
    },
    // Medium risk (34-66): standard litigation
    {
      id: DEMO_IDS.riskEvaluations.risk3,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      score: 45,
      severity: "medium" as const,
      factors: [
        { factor: "value_at_stake", weight: 0.4, evidence: "£85k claim value" },
        { factor: "witness_availability", weight: 0.3, evidence: "Key witness located overseas" },
        {
          factor: "legal_complexity",
          weight: 0.3,
          evidence: "Breach of contract with counterclaim",
        },
      ],
      recommendations: [
        "Secure witness testimony via video link",
        "Consider mediation to reduce costs",
        "Maintain detailed case chronology",
      ],
      aiModel: "gpt-4",
      evaluatedAt: new Date("2024-10-05T14:20:00Z"),
    },
    {
      id: DEMO_IDS.riskEvaluations.risk4,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationDebt,
      score: 52,
      severity: "medium" as const,
      factors: [
        {
          factor: "debtor_solvency",
          weight: 0.4,
          evidence: "Debtor showing signs of financial distress",
        },
        { factor: "evidence_strength", weight: 0.3, evidence: "Strong documentary evidence" },
        {
          factor: "enforcement_risk",
          weight: 0.3,
          evidence: "May require enforcement proceedings",
        },
      ],
      recommendations: [
        "Consider statutory demand before proceedings",
        "Investigate debtor assets for enforcement",
        "Prepare for potential insolvency",
      ],
      aiModel: "gpt-4",
      evaluatedAt: new Date("2024-09-20T11:15:00Z"),
    },
    {
      id: DEMO_IDS.riskEvaluations.risk5,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyDivorce,
      score: 58,
      severity: "medium" as const,
      factors: [
        {
          factor: "high_conflict",
          weight: 0.4,
          evidence: "Parties unable to communicate effectively",
        },
        { factor: "child_custody", weight: 0.3, evidence: "Disputed child arrangements" },
        {
          factor: "asset_complexity",
          weight: 0.3,
          evidence: "Multiple properties and pensions to divide",
        },
      ],
      recommendations: [
        "Recommend mediation for child arrangements",
        "Obtain pension valuations early",
        "Consider counsel for financial remedy hearing",
      ],
      aiModel: "gpt-4",
      evaluatedAt: new Date("2024-09-10T16:45:00Z"),
    },
    // High risk (67-89): complex employment
    {
      id: DEMO_IDS.riskEvaluations.risk6,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentDismissal,
      score: 72,
      severity: "high" as const,
      factors: [
        {
          factor: "discrimination_claim",
          weight: 0.4,
          evidence: "Client alleges age discrimination",
        },
        {
          factor: "weak_documentation",
          weight: 0.3,
          evidence: "Employer's dismissal procedure poorly documented",
        },
        {
          factor: "reputational_risk",
          weight: 0.3,
          evidence: "High-profile company with media interest",
        },
      ],
      recommendations: [
        "Engage specialist discrimination counsel immediately",
        "Prepare comprehensive witness statements",
        "Consider early settlement to avoid publicity",
        "Obtain expert HR evidence on procedure",
      ],
      aiModel: "gpt-4",
      evaluatedAt: new Date("2024-08-15T13:30:00Z"),
    },
    {
      id: DEMO_IDS.riskEvaluations.risk7,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationContract,
      score: 76,
      severity: "high" as const,
      factors: [
        { factor: "high_value", weight: 0.4, evidence: "£500k+ claim value" },
        {
          factor: "complex_contract",
          weight: 0.3,
          evidence: "Multiple jurisdictions and governing laws",
        },
        { factor: "tight_deadline", weight: 0.3, evidence: "Limitation period expires in 6 weeks" },
      ],
      recommendations: [
        "Instruct leading counsel urgently",
        "Conduct detailed conflicts check",
        "Issue protective proceedings before limitation",
        "Consider jurisdiction challenges",
      ],
      aiModel: "gpt-4",
      evaluatedAt: new Date("2024-10-10T09:00:00Z"),
    },
    {
      id: DEMO_IDS.riskEvaluations.risk8,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateDispute,
      score: 68,
      severity: "high" as const,
      factors: [
        {
          factor: "will_challenge",
          weight: 0.4,
          evidence: "Validity of will disputed on capacity grounds",
        },
        { factor: "family_conflict", weight: 0.3, evidence: "Multiple beneficiaries in dispute" },
        {
          factor: "asset_valuation",
          weight: 0.3,
          evidence: "Estate includes business interests requiring valuation",
        },
      ],
      recommendations: [
        "Obtain medical evidence on testamentary capacity",
        "Consider professional executor appointment",
        "Engage business valuation expert",
        "Explore mediation between beneficiaries",
      ],
      aiModel: "gpt-4",
      evaluatedAt: new Date("2024-09-05T15:20:00Z"),
    },
    // Critical risk (90-100): high-value fraud case
    {
      id: DEMO_IDS.riskEvaluations.risk9,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.criminalFraud,
      score: 95,
      severity: "critical" as const,
      factors: [
        { factor: "serious_charge", weight: 0.4, evidence: "Conspiracy to defraud exceeding £2m" },
        {
          factor: "crown_court_trial",
          weight: 0.3,
          evidence: "Complex multi-handed trial estimated 8 weeks",
        },
        {
          factor: "disclosure_volume",
          weight: 0.15,
          evidence: "Over 10,000 pages of unused material",
        },
        {
          factor: "client_risk",
          weight: 0.15,
          evidence: "Client previously failed to attend hearings",
        },
      ],
      recommendations: [
        "URGENT: Instruct leading QC and junior counsel immediately",
        "Engage forensic accountant for expert evidence",
        "Implement strict client liaison protocol",
        "Request case management hearing for disclosure issues",
        "Consider costs implications and funding arrangements",
        "Ensure adequate professional indemnity insurance coverage",
      ],
      aiModel: "gpt-4",
      evaluatedAt: new Date("2024-10-12T08:00:00Z"),
    },
    {
      id: DEMO_IDS.riskEvaluations.risk10,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.commercialShareholder,
      score: 88,
      severity: "critical" as const,
      factors: [
        { factor: "high_value", weight: 0.4, evidence: "£10m company valuation dispute" },
        {
          factor: "injunction_risk",
          weight: 0.3,
          evidence: "Client seeking urgent freezing order",
        },
        {
          factor: "jurisdictional_issues",
          weight: 0.2,
          evidence: "Offshore assets and entities involved",
        },
        { factor: "time_critical", weight: 0.1, evidence: "Application required within 48 hours" },
      ],
      recommendations: [
        "CRITICAL: Prepare without notice application immediately",
        "Instruct commercial QC for urgent advice",
        "Conduct comprehensive asset trace",
        "Prepare detailed evidence of risk of dissipation",
        "Consider cross-border enforcement mechanisms",
        "Obtain senior partner approval for undertaking exposure",
      ],
      aiModel: "gpt-4",
      evaluatedAt: new Date("2024-10-11T17:30:00Z"),
    },
  ];

  for (const riskData of riskEvaluationsData) {
    const [risk] = await db
      .insert(riskEvaluations)
      .values(riskData)
      .onConflictDoUpdate({
        target: riskEvaluations.id,
        set: { evaluatedAt: riskData.evaluatedAt },
      })
      .returning();

    console.log(
      `    Created risk evaluation: Matter ${risk.matterId.slice(0, 8)}... - ${risk.severity} (score: ${risk.score})`
    );
  }

  // 11. Create compliance rules
  const complianceRulesData = [
    {
      id: DEMO_IDS.complianceRules.rule1,
      firmId: DEMO_IDS.firm,
      name: "Deadline Warning",
      description:
        "Alert fee earners 7 days before matter deadlines to ensure adequate preparation time",
      type: "deadline" as const,
      isActive: true,
      condition: {
        type: "deadline",
        warningDays: 7,
        criticalDays: 2,
        practiceAreas: ["conveyancing", "litigation", "employment", "immigration"],
      },
      alertPriority: "warning" as const,
      alertTemplate:
        "Matter {{matterReference}} has a deadline in {{daysRemaining}} days: {{deadlineDescription}}",
      checkInterval: 86400, // Daily
      createdBy: DEMO_IDS.users.seniorPartner,
    },
    {
      id: DEMO_IDS.complianceRules.rule2,
      firmId: DEMO_IDS.firm,
      name: "Workload Limit",
      description:
        "Warn supervisors when fee earners exceed 25 active matters to prevent burnout and maintain quality",
      type: "workload" as const,
      isActive: true,
      condition: {
        type: "workload",
        maxActiveMatters: 25,
        threshold: "warning",
        excludeStatuses: ["completed", "archived"],
      },
      alertPriority: "warning" as const,
      alertTemplate: "{{userName}} currently has {{activeMatterCount}} active matters (limit: 25)",
      checkInterval: 86400, // Daily
      createdBy: DEMO_IDS.users.seniorPartner,
    },
    {
      id: DEMO_IDS.complianceRules.rule3,
      firmId: DEMO_IDS.firm,
      name: "Supervision Required",
      description:
        "Ensure trainee solicitors have adequate supervision on all matters per SRA requirements",
      type: "supervision" as const,
      isActive: true,
      condition: {
        type: "supervision",
        requiresSupervisor: true,
        roles: ["trainee", "paralegal"],
        minSupervisionLevel: "associate",
      },
      alertPriority: "urgent" as const,
      alertTemplate:
        "Matter {{matterReference}} assigned to {{userName}} (trainee) has no assigned supervisor",
      checkInterval: 3600, // Hourly
      createdBy: DEMO_IDS.users.seniorPartner,
    },
    {
      id: DEMO_IDS.complianceRules.rule4,
      firmId: DEMO_IDS.firm,
      name: "Conflict Check",
      description:
        "Require conflict checks before matter opening and periodic reviews for ongoing matters",
      type: "conflict" as const,
      isActive: true,
      condition: {
        type: "conflict",
        checkOnOpen: true,
        periodicReviewDays: 90,
        includePotentialConflicts: true,
      },
      alertPriority: "critical" as const,
      alertTemplate:
        "Matter {{matterReference}} requires conflict check review (last checked: {{lastCheckDate}})",
      checkInterval: 86400, // Daily
      createdBy: DEMO_IDS.users.seniorPartner,
    },
    {
      id: DEMO_IDS.complianceRules.rule5,
      firmId: DEMO_IDS.firm,
      name: "Document Retention",
      description:
        "Ensure compliance with SRA document retention requirements (7 years for most matters)",
      type: "document" as const,
      isActive: true,
      condition: {
        type: "document",
        retentionYears: 7,
        warningDays: 30, // Warn 30 days before deletion
        exemptPracticeAreas: [], // All areas subject to retention
      },
      alertPriority: "info" as const,
      alertTemplate:
        "Matter {{matterReference}} documents are due for review/deletion in {{daysRemaining}} days",
      checkInterval: 604800, // Weekly
      createdBy: DEMO_IDS.users.seniorPartner,
    },
  ];

  for (const ruleData of complianceRulesData) {
    const [rule] = await db
      .insert(complianceRules)
      .values(ruleData)
      .onConflictDoUpdate({
        target: complianceRules.id,
        set: { updatedAt: now },
      })
      .returning();

    console.log(`    Created compliance rule: ${rule.name} (${rule.type})`);
  }

  // ============================================================================
  // DOCUMENTS
  // ============================================================================

  console.log("\nSeeding documents...");

  const documentsData = [
    // Conveyancing documents (matter 1 - 42 Oak Road)
    {
      id: DEMO_IDS.documents.doc1,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      title: "Contract for Sale - 42 Oak Road",
      type: "contract" as const,
      status: "approved" as const,
      filename: "contract-42-oak-road.pdf",
      mimeType: "application/pdf",
      fileSize: 245000,
      createdBy: DEMO_IDS.users.associate,
      documentDate: new Date("2024-09-15"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc2,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      title: "Local Authority Searches",
      type: "other" as const,
      status: "approved" as const,
      filename: "local-searches.pdf",
      mimeType: "application/pdf",
      fileSize: 128000,
      createdBy: DEMO_IDS.users.paralegal1,
      documentDate: new Date("2024-09-20"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc3,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      title: "Letter to Seller's Solicitor",
      type: "letter_out" as const,
      status: "sent" as const,
      filename: "letter-seller-solicitor.pdf",
      mimeType: "application/pdf",
      fileSize: 45000,
      createdBy: DEMO_IDS.users.associate,
      documentDate: new Date("2024-10-01"),
      createdAt: now,
    },
    // Litigation documents (matter 2)
    {
      id: DEMO_IDS.documents.doc4,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      title: "Particulars of Claim",
      type: "court_form" as const,
      status: "approved" as const,
      filename: "particulars-of-claim.pdf",
      mimeType: "application/pdf",
      fileSize: 180000,
      createdBy: DEMO_IDS.users.partner,
      documentDate: new Date("2024-08-15"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc5,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      title: "Witness Statement - J Smith",
      type: "evidence" as const,
      status: "approved" as const,
      filename: "witness-statement-j-smith.pdf",
      mimeType: "application/pdf",
      fileSize: 92000,
      createdBy: DEMO_IDS.users.partner,
      documentDate: new Date("2024-08-20"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc6,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      title: "Letter to Opposing Counsel",
      type: "letter_out" as const,
      status: "sent" as const,
      filename: "letter-opposing-counsel.pdf",
      mimeType: "application/pdf",
      fileSize: 38000,
      createdBy: DEMO_IDS.users.partner,
      documentDate: new Date("2024-09-05"),
      createdAt: now,
    },
    // Family Divorce documents
    {
      id: DEMO_IDS.documents.doc7,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyDivorce,
      title: "Form E Financial Statement",
      type: "court_form" as const,
      status: "draft" as const,
      filename: "form-e-financial.pdf",
      mimeType: "application/pdf",
      fileSize: 156000,
      createdBy: DEMO_IDS.users.associate2,
      documentDate: new Date("2024-10-10"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc8,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyDivorce,
      title: "Consent Order Draft",
      type: "court_form" as const,
      status: "pending_review" as const,
      filename: "consent-order-draft.pdf",
      mimeType: "application/pdf",
      fileSize: 72000,
      createdBy: DEMO_IDS.users.associate2,
      documentDate: new Date("2024-10-12"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc9,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyDivorce,
      title: "Bank Statements (Evidence)",
      type: "financial" as const,
      status: "approved" as const,
      filename: "bank-statements.pdf",
      mimeType: "application/pdf",
      fileSize: 210000,
      createdBy: DEMO_IDS.users.paralegal2,
      documentDate: new Date("2024-10-08"),
      createdAt: now,
    },
    // Employment Dismissal documents
    {
      id: DEMO_IDS.documents.doc10,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentDismissal,
      title: "ET1 Employment Tribunal Form",
      type: "court_form" as const,
      status: "approved" as const,
      filename: "et1-form.pdf",
      mimeType: "application/pdf",
      fileSize: 145000,
      createdBy: DEMO_IDS.users.associate3,
      documentDate: new Date("2024-09-25"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc11,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentDismissal,
      title: "Employment Contract",
      type: "contract" as const,
      status: "approved" as const,
      filename: "employment-contract.pdf",
      mimeType: "application/pdf",
      fileSize: 98000,
      createdBy: DEMO_IDS.users.associate3,
      documentDate: new Date("2024-09-20"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc12,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentDismissal,
      title: "Dismissal Letter",
      type: "letter_in" as const,
      status: "approved" as const,
      filename: "dismissal-letter.pdf",
      mimeType: "application/pdf",
      fileSize: 52000,
      createdBy: DEMO_IDS.users.paralegal1,
      documentDate: new Date("2024-09-18"),
      createdAt: now,
    },
    // Personal Injury RTA documents
    {
      id: DEMO_IDS.documents.doc13,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryRTA,
      title: "Medical Report - Dr. Williams",
      type: "evidence" as const,
      status: "approved" as const,
      filename: "medical-report.pdf",
      mimeType: "application/pdf",
      fileSize: 185000,
      createdBy: DEMO_IDS.users.associate,
      documentDate: new Date("2024-10-05"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc14,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryRTA,
      title: "Police Accident Report",
      type: "evidence" as const,
      status: "approved" as const,
      filename: "police-report.pdf",
      mimeType: "application/pdf",
      fileSize: 142000,
      createdBy: DEMO_IDS.users.paralegal1,
      documentDate: new Date("2024-09-28"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc15,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryRTA,
      title: "Letter Before Action",
      type: "letter_out" as const,
      status: "sent" as const,
      filename: "letter-before-action.pdf",
      mimeType: "application/pdf",
      fileSize: 68000,
      createdBy: DEMO_IDS.users.associate,
      documentDate: new Date("2024-10-10"),
      createdAt: now,
    },
    // Probate Estate documents
    {
      id: DEMO_IDS.documents.doc16,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateEstate,
      title: "Last Will and Testament",
      type: "other" as const,
      status: "approved" as const,
      filename: "will.pdf",
      mimeType: "application/pdf",
      fileSize: 118000,
      createdBy: DEMO_IDS.users.seniorPartner,
      documentDate: new Date("2024-09-15"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc17,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateEstate,
      title: "Grant of Probate Application",
      type: "court_form" as const,
      status: "pending_review" as const,
      filename: "grant-probate-app.pdf",
      mimeType: "application/pdf",
      fileSize: 95000,
      createdBy: DEMO_IDS.users.associate2,
      documentDate: new Date("2024-10-12"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc18,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateEstate,
      title: "Estate Valuation Report",
      type: "financial" as const,
      status: "approved" as const,
      filename: "estate-valuation.pdf",
      mimeType: "application/pdf",
      fileSize: 168000,
      createdBy: DEMO_IDS.users.paralegal2,
      documentDate: new Date("2024-10-08"),
      createdAt: now,
    },
    // Commercial Shareholder documents
    {
      id: DEMO_IDS.documents.doc19,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.commercialShareholder,
      title: "Shareholder Agreement",
      type: "contract" as const,
      status: "approved" as const,
      filename: "shareholder-agreement.pdf",
      mimeType: "application/pdf",
      fileSize: 225000,
      createdBy: DEMO_IDS.users.seniorPartner,
      documentDate: new Date("2024-09-22"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc20,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.commercialShareholder,
      title: "Company Constitution",
      type: "other" as const,
      status: "approved" as const,
      filename: "company-constitution.pdf",
      mimeType: "application/pdf",
      fileSize: 138000,
      createdBy: DEMO_IDS.users.seniorPartner,
      documentDate: new Date("2024-09-20"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc21,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.commercialShareholder,
      title: "Letter to Companies House",
      type: "letter_out" as const,
      status: "sent" as const,
      filename: "letter-companies-house.pdf",
      mimeType: "application/pdf",
      fileSize: 42000,
      createdBy: DEMO_IDS.users.paralegal1,
      documentDate: new Date("2024-09-28"),
      createdAt: now,
    },
    // Conveyancing Sale documents
    {
      id: DEMO_IDS.documents.doc22,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingSale,
      title: "Title Deeds",
      type: "other" as const,
      status: "approved" as const,
      filename: "title-deeds.pdf",
      mimeType: "application/pdf",
      fileSize: 198000,
      createdBy: DEMO_IDS.users.associate,
      documentDate: new Date("2024-10-01"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc23,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancingSale,
      title: "Property Information Form",
      type: "other" as const,
      status: "approved" as const,
      filename: "property-info-form.pdf",
      mimeType: "application/pdf",
      fileSize: 85000,
      createdBy: DEMO_IDS.users.paralegal1,
      documentDate: new Date("2024-10-03"),
      createdAt: now,
    },
    // Litigation Contract documents
    {
      id: DEMO_IDS.documents.doc24,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationContract,
      title: "Defence and Counterclaim",
      type: "court_form" as const,
      status: "approved" as const,
      filename: "defence-counterclaim.pdf",
      mimeType: "application/pdf",
      fileSize: 165000,
      createdBy: DEMO_IDS.users.partner,
      documentDate: new Date("2024-09-30"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc25,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationContract,
      title: "Contract in Dispute",
      type: "contract" as const,
      status: "approved" as const,
      filename: "contract-dispute.pdf",
      mimeType: "application/pdf",
      fileSize: 215000,
      createdBy: DEMO_IDS.users.partner,
      documentDate: new Date("2024-09-15"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc26,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationContract,
      title: "Email Correspondence (Evidence)",
      type: "email_in" as const,
      status: "approved" as const,
      filename: "email-evidence.pdf",
      mimeType: "application/pdf",
      fileSize: 58000,
      createdBy: DEMO_IDS.users.paralegal2,
      documentDate: new Date("2024-09-25"),
      createdAt: now,
    },
    // Immigration Tier 2 documents
    {
      id: DEMO_IDS.documents.doc27,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.immigrationTier2,
      title: "Visa Application Form",
      type: "court_form" as const,
      status: "pending_review" as const,
      filename: "visa-application.pdf",
      mimeType: "application/pdf",
      fileSize: 125000,
      createdBy: DEMO_IDS.users.associate3,
      documentDate: new Date("2024-10-11"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc28,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.immigrationTier2,
      title: "Passport Copy",
      type: "id_document" as const,
      status: "approved" as const,
      filename: "passport-copy.pdf",
      mimeType: "application/pdf",
      fileSize: 48000,
      createdBy: DEMO_IDS.users.paralegal1,
      documentDate: new Date("2024-10-08"),
      createdAt: now,
    },
    {
      id: DEMO_IDS.documents.doc29,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.immigrationTier2,
      title: "Certificate of Sponsorship",
      type: "other" as const,
      status: "approved" as const,
      filename: "certificate-sponsorship.pdf",
      mimeType: "application/pdf",
      fileSize: 62000,
      createdBy: DEMO_IDS.users.associate3,
      documentDate: new Date("2024-10-09"),
      createdAt: now,
    },
    // Criminal Driving documents
    {
      id: DEMO_IDS.documents.doc30,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.criminalDriving,
      title: "Basis of Plea",
      type: "court_form" as const,
      status: "approved" as const,
      filename: "basis-of-plea.pdf",
      mimeType: "application/pdf",
      fileSize: 75000,
      createdBy: DEMO_IDS.users.associate2,
      documentDate: new Date("2024-10-07"),
      createdAt: now,
    },
  ];

  for (const documentData of documentsData) {
    const [document] = await db
      .insert(documents)
      .values(documentData)
      .onConflictDoUpdate({
        target: documents.id,
        set: { createdAt: now },
      })
      .returning();

    console.log(`    Created document: ${document.title}`);
  }

  // 11. Create calendar events
  console.log("  Creating calendar events...");

  const oneWeek = new Date(now.getTime() + 7 * 86400000);
  const twoWeeks = new Date(now.getTime() + 14 * 86400000);
  const threeWeeks = new Date(now.getTime() + 21 * 86400000);
  const oneMonth = new Date(now.getTime() + 30 * 86400000);
  const twoMonths = new Date(now.getTime() + 60 * 86400000);
  const threeMonths = new Date(now.getTime() + 90 * 86400000);

  const calendarEventsData = [
    // Court hearings
    {
      id: DEMO_IDS.calendarEvents.event1,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      title: "County Court Hearing - Preliminary Directions",
      description:
        "Preliminary directions hearing for breach of contract claim. Prepare case management bundle.",
      eventType: "hearing" as const,
      status: "scheduled" as const,
      priority: "high" as const,
      startAt: new Date(oneWeek.setHours(10, 30, 0, 0)),
      endAt: new Date(oneWeek.getTime() + 90 * 60000), // 90 minutes
      allDay: false,
      location: "Manchester County Court, Court Room 3",
      attendees: [DEMO_IDS.users.partner, DEMO_IDS.clients.company],
      reminderMinutes: [1440, 60], // 1 day and 1 hour before
      createdById: DEMO_IDS.users.partner,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.calendarEvents.event2,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigationContract,
      title: "High Court Trial - Day 1",
      description: "Commercial contract dispute trial. Full day hearing with witness evidence.",
      eventType: "hearing" as const,
      status: "scheduled" as const,
      priority: "critical" as const,
      startAt: new Date(twoMonths.setHours(10, 0, 0, 0)),
      endAt: new Date(twoMonths.getTime() + 360 * 60000), // 6 hours
      allDay: false,
      location: "Royal Courts of Justice, Strand, London",
      attendees: [
        DEMO_IDS.users.seniorPartner,
        DEMO_IDS.users.associate,
        DEMO_IDS.clients.company3,
      ],
      reminderMinutes: [10080, 1440, 60], // 1 week, 1 day, 1 hour before
      createdById: DEMO_IDS.users.seniorPartner,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.calendarEvents.event3,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyDivorce,
      title: "Family Court - Financial Remedy Hearing",
      description: "First directions appointment for financial settlement.",
      eventType: "hearing" as const,
      status: "scheduled" as const,
      priority: "high" as const,
      startAt: new Date(threeWeeks.setHours(14, 0, 0, 0)),
      endAt: new Date(threeWeeks.getTime() + 60 * 60000), // 1 hour
      allDay: false,
      location: "Birmingham Family Court",
      attendees: [DEMO_IDS.users.associate2, DEMO_IDS.clients.individual4],
      reminderMinutes: [1440, 120], // 1 day and 2 hours before
      createdById: DEMO_IDS.users.associate2,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.calendarEvents.event4,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.criminalDriving,
      title: "Magistrates Court - Plea Hearing",
      description: "Client to enter plea for driving without due care and attention.",
      eventType: "hearing" as const,
      status: "scheduled" as const,
      priority: "high" as const,
      startAt: new Date(new Date(now.getTime() + 10 * 86400000).setHours(9, 30, 0, 0)),
      endAt: new Date(new Date(now.getTime() + 10 * 86400000).setHours(10, 30, 0, 0)),
      allDay: false,
      location: "Manchester Magistrates Court",
      attendees: [DEMO_IDS.users.associate3, DEMO_IDS.clients.individual6],
      reminderMinutes: [1440, 60],
      createdById: DEMO_IDS.users.associate3,
      createdAt: now,
      updatedAt: now,
    },

    // Filing deadlines
    {
      id: DEMO_IDS.calendarEvents.event5,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.litigation,
      title: "DEADLINE: Defence and Counterclaim",
      description: "File and serve Defence and Counterclaim at court. Must be done by 4pm.",
      eventType: "filing_deadline" as const,
      status: "scheduled" as const,
      priority: "critical" as const,
      startAt: new Date(new Date(now.getTime() + 5 * 86400000).setHours(16, 0, 0, 0)),
      endAt: new Date(new Date(now.getTime() + 5 * 86400000).setHours(16, 0, 0, 0)),
      allDay: false,
      location: null,
      attendees: [DEMO_IDS.users.partner, DEMO_IDS.users.paralegal1],
      reminderMinutes: [2880, 1440, 240], // 2 days, 1 day, 4 hours before
      createdById: DEMO_IDS.users.partner,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.calendarEvents.event6,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentDismissal,
      title: "DEADLINE: ET1 Claim Form Submission",
      description: "Submit Employment Tribunal claim form before limitation expires.",
      eventType: "filing_deadline" as const,
      status: "scheduled" as const,
      priority: "critical" as const,
      startAt: new Date(new Date(now.getTime() + 12 * 86400000).setHours(23, 59, 0, 0)),
      endAt: null,
      allDay: true,
      location: null,
      attendees: [DEMO_IDS.users.associate, DEMO_IDS.users.paralegal2],
      reminderMinutes: [4320, 1440, 480], // 3 days, 1 day, 8 hours
      createdById: DEMO_IDS.users.associate,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.calendarEvents.event7,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.personalInjuryRTA,
      title: "DEADLINE: Witness Statements",
      description: "Exchange witness statements with defendant's solicitors.",
      eventType: "filing_deadline" as const,
      status: "scheduled" as const,
      priority: "high" as const,
      startAt: new Date(oneMonth.setHours(17, 0, 0, 0)),
      endAt: null,
      allDay: false,
      location: null,
      attendees: [DEMO_IDS.users.associate2],
      reminderMinutes: [10080, 2880, 1440], // 1 week, 2 days, 1 day
      createdById: DEMO_IDS.users.associate2,
      createdAt: now,
      updatedAt: now,
    },

    // Client meetings
    {
      id: DEMO_IDS.calendarEvents.event8,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.conveyancing,
      title: "Client Meeting - Property Purchase Update",
      description: "Discuss search results and contract queries with buyers.",
      eventType: "meeting" as const,
      status: "scheduled" as const,
      priority: "medium" as const,
      startAt: new Date(new Date(now.getTime() + 3 * 86400000).setHours(11, 0, 0, 0)),
      endAt: new Date(new Date(now.getTime() + 3 * 86400000).setHours(12, 0, 0, 0)),
      allDay: false,
      location: "Meeting Room 1, Harrison & Clarke Offices",
      attendees: [DEMO_IDS.users.associate, DEMO_IDS.clients.individual],
      reminderMinutes: [1440, 30],
      createdById: DEMO_IDS.users.associate,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.calendarEvents.event9,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.commercialShareholder,
      title: "Client Meeting - Shareholder Agreement Review",
      description: "Review draft shareholder agreement and discuss governance provisions.",
      eventType: "meeting" as const,
      status: "scheduled" as const,
      priority: "high" as const,
      startAt: new Date(twoWeeks.setHours(15, 0, 0, 0)),
      endAt: new Date(twoWeeks.getTime() + 90 * 60000),
      allDay: false,
      location: "Client Offices, MediaCityUK",
      attendees: [
        DEMO_IDS.users.seniorPartner,
        DEMO_IDS.users.associate,
        DEMO_IDS.clients.company5,
      ],
      reminderMinutes: [2880, 60],
      createdById: DEMO_IDS.users.seniorPartner,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.calendarEvents.event10,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.probateEstate,
      title: "Client Meeting - Estate Administration Progress",
      description: "Update beneficiaries on estate valuation and probate application status.",
      eventType: "meeting" as const,
      status: "scheduled" as const,
      priority: "medium" as const,
      startAt: new Date(new Date(now.getTime() + 8 * 86400000).setHours(10, 0, 0, 0)),
      endAt: new Date(new Date(now.getTime() + 8 * 86400000).setHours(11, 0, 0, 0)),
      allDay: false,
      location: "Video Call (Microsoft Teams)",
      attendees: [DEMO_IDS.users.associate3, DEMO_IDS.clients.estate1],
      reminderMinutes: [1440, 15],
      createdById: DEMO_IDS.users.associate3,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.calendarEvents.event11,
      firmId: DEMO_IDS.firm,
      matterId: null, // New business consultation
      title: "New Client Consultation - Immigration Matter",
      description: "Initial consultation for potential Tier 2 Visa sponsorship case.",
      eventType: "meeting" as const,
      status: "scheduled" as const,
      priority: "medium" as const,
      startAt: new Date(new Date(now.getTime() + 4 * 86400000).setHours(14, 30, 0, 0)),
      endAt: new Date(new Date(now.getTime() + 4 * 86400000).setHours(15, 30, 0, 0)),
      allDay: false,
      location: "Meeting Room 2, Harrison & Clarke Offices",
      attendees: [DEMO_IDS.users.associate2],
      reminderMinutes: [1440, 60],
      createdById: DEMO_IDS.users.receptionist,
      createdAt: now,
      updatedAt: now,
    },

    // Team meetings
    {
      id: DEMO_IDS.calendarEvents.event12,
      firmId: DEMO_IDS.firm,
      matterId: null,
      title: "Litigation Team Weekly Case Review",
      description: "Review active litigation cases, upcoming deadlines, and resource allocation.",
      eventType: "meeting" as const,
      status: "scheduled" as const,
      priority: "medium" as const,
      startAt: new Date(new Date(now.getTime() + 7 * 86400000).setHours(9, 0, 0, 0)),
      endAt: new Date(new Date(now.getTime() + 7 * 86400000).setHours(10, 0, 0, 0)),
      allDay: false,
      location: "Conference Room A",
      attendees: [
        DEMO_IDS.users.seniorPartner,
        DEMO_IDS.users.partner,
        DEMO_IDS.users.associate,
        DEMO_IDS.users.paralegal1,
      ],
      reminderMinutes: [60],
      createdById: DEMO_IDS.users.seniorPartner,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.calendarEvents.event13,
      firmId: DEMO_IDS.firm,
      matterId: null,
      title: "Conveyancing Department Meeting",
      description:
        "Monthly conveyancing team meeting. Discuss completions, searches, and client updates.",
      eventType: "meeting" as const,
      status: "scheduled" as const,
      priority: "low" as const,
      startAt: new Date(twoWeeks.setHours(16, 0, 0, 0)),
      endAt: new Date(twoWeeks.getTime() + 60 * 60000),
      allDay: false,
      location: "Conference Room B",
      attendees: [DEMO_IDS.users.partner, DEMO_IDS.users.associate, DEMO_IDS.users.paralegal2],
      reminderMinutes: [1440],
      createdById: DEMO_IDS.users.partner,
      createdAt: now,
      updatedAt: now,
    },

    // Consultations
    {
      id: DEMO_IDS.calendarEvents.event14,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.familyChild,
      title: "Client Consultation - Child Arrangement Order",
      description: "Discuss CAFCASS report and prepare for final hearing.",
      eventType: "meeting" as const,
      status: "scheduled" as const,
      priority: "high" as const,
      startAt: new Date(new Date(now.getTime() + 6 * 86400000).setHours(13, 30, 0, 0)),
      endAt: new Date(new Date(now.getTime() + 6 * 86400000).setHours(14, 30, 0, 0)),
      allDay: false,
      location: "Meeting Room 1, Harrison & Clarke Offices",
      attendees: [DEMO_IDS.users.associate2, DEMO_IDS.clients.individual5],
      reminderMinutes: [2880, 60],
      createdById: DEMO_IDS.users.associate2,
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.calendarEvents.event15,
      firmId: DEMO_IDS.firm,
      matterId: DEMO_IDS.matters.employmentSettlement,
      title: "Without Prejudice Settlement Meeting",
      description:
        "Confidential settlement discussion with opposing party. Aim to reach compromise agreement.",
      eventType: "meeting" as const,
      status: "scheduled" as const,
      priority: "high" as const,
      startAt: new Date(threeWeeks.setHours(10, 30, 0, 0)),
      endAt: new Date(threeWeeks.getTime() + 120 * 60000), // 2 hours
      allDay: false,
      location: "Neutral Venue - Holiday Inn Manchester City Centre",
      attendees: [DEMO_IDS.users.associate, DEMO_IDS.clients.individual8],
      reminderMinutes: [2880, 1440, 60],
      createdById: DEMO_IDS.users.associate,
      createdAt: now,
      updatedAt: now,
    },
  ];

  for (const eventData of calendarEventsData) {
    const [event] = await db
      .insert(calendarEvents)
      .values(eventData)
      .onConflictDoUpdate({
        target: calendarEvents.id,
        set: { updatedAt: now },
      })
      .returning();

    console.log(`    Created calendar event: ${event.title}`);
  }

  console.log("\n✓ Demo data seeded successfully!\n");
  console.log("Summary:");
  console.log(`  Firm: ${result.firm.name}`);
  console.log(`  Users: ${result.users.length}`);
  console.log(`  Clients: ${result.clients.length}`);
  console.log(`  Matters: ${result.matters.length}`);
  console.log(`  Time Entries: ${result.timeEntries.length}`);
  console.log(`  Tasks: ${result.tasks.length}`);
  console.log(`  Invoices: ${invoicesData.length}`);
  console.log(`  Payments: ${paymentsData.length}`);
  console.log(`  Documents: ${documentsData.length}`);
  console.log(`  Calendar Events: ${calendarEventsData.length}`);

  return result;
}

/**
 * Reset demo data (clear then seed)
 */
export async function resetDemoData(): Promise<SeedResult> {
  await clearDemoData();
  return seedDemoData();
}

// CLI entrypoint
const command = process.argv[2];

async function main() {
  try {
    switch (command) {
      case "clear":
        await clearDemoData();
        break;
      case "reset":
        await resetDemoData();
        break;
      case "seed":
      default:
        await seedDemoData();
        break;
    }
    process.exit(0);
  } catch (err) {
    console.error("Demo data operation failed:", err);
    process.exit(1);
  }
}

main();
