import { db } from "@/lib/db";
import { clients } from "@/lib/db/schema";
import { DEMO_IDS, DEMO_PREFIX } from "../ids";
import type { SeederContext } from "../types";

export async function seedClients(ctx: SeederContext) {
  console.log("  Seeding clients...");

  const now = ctx.now;

  const clientsData = [
    {
      id: DEMO_IDS.clients.individual,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-001",
      firstName: `${DEMO_PREFIX}Margaret`,
      lastName: "Thompson",
      email: "margaret.thompson@example.demo",
      phone: "020 7123 4567",
      addressLine1: "42 Kensington Gardens",
      city: "London",
      postcode: "W8 4PX",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-002",
      companyName: `${DEMO_PREFIX}Apex Developments Ltd`,
      companyNumber: "12345678",
      email: "legal@apexdev.demo",
      phone: "0161 234 5678",
      addressLine1: "100 Deansgate",
      city: "Manchester",
      postcode: "M3 2GP",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual3,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-003",
      firstName: `${DEMO_PREFIX}Robert`,
      lastName: "Williams",
      email: "robert.williams@example.demo",
      phone: "0161 789 4567",
      addressLine1: "58 Oxford Road",
      city: "Manchester",
      postcode: "M1 6EU",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual4,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-004",
      firstName: `${DEMO_PREFIX}Jennifer`,
      lastName: "Adams",
      email: "jennifer.adams@example.demo",
      phone: "0121 456 7890",
      addressLine1: "23 Colmore Row",
      city: "Birmingham",
      postcode: "B3 2BS",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual5,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-005",
      firstName: `${DEMO_PREFIX}Michael`,
      lastName: "O'Brien",
      email: "michael.obrien@example.demo",
      phone: "0151 234 5678",
      addressLine1: "77 Bold Street",
      city: "Liverpool",
      postcode: "L1 4HF",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual6,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-006",
      firstName: `${DEMO_PREFIX}Fatima`,
      lastName: "Hassan",
      email: "fatima.hassan@example.demo",
      phone: "0113 987 6543",
      addressLine1: "14 Park Square East",
      city: "Leeds",
      postcode: "LS1 2LH",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual7,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-007",
      firstName: `${DEMO_PREFIX}George`,
      lastName: "Henderson",
      email: "george.henderson@example.demo",
      phone: "0117 456 7890",
      addressLine1: "89 Whiteladies Road",
      city: "Bristol",
      postcode: "BS8 2NT",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.individual8,
      firmId: DEMO_IDS.firm,
      type: "individual" as const,
      status: "active" as const,
      reference: "CLI-DEMO-008",
      firstName: `${DEMO_PREFIX}Elizabeth`,
      lastName: "Carter",
      email: "elizabeth.carter@example.demo",
      phone: "0131 234 5678",
      addressLine1: "32 Charlotte Square",
      city: "Edinburgh",
      postcode: "EH2 4ET",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company3,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-009",
      companyName: `${DEMO_PREFIX}TechStart Solutions Ltd`,
      companyNumber: "23456789",
      email: "legal@techstart.demo",
      phone: "020 7890 1234",
      addressLine1: "15 Old Street",
      city: "London",
      postcode: "EC1V 9HL",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company4,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-010",
      companyName: `${DEMO_PREFIX}Northern Manufacturing plc`,
      companyNumber: "34567890",
      email: "legal@northernmfg.demo",
      phone: "0191 345 6789",
      addressLine1: "Industrial Estate Road",
      city: "Newcastle",
      postcode: "NE4 7YH",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company5,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-011",
      companyName: `${DEMO_PREFIX}Riverside Properties Ltd`,
      companyNumber: "45678901",
      email: "legal@riverside.demo",
      phone: "0161 567 8901",
      addressLine1: "Quay Street",
      city: "Manchester",
      postcode: "M3 3JE",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company6,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-012",
      companyName: `${DEMO_PREFIX}Global Imports Ltd`,
      companyNumber: "56789012",
      email: "legal@globalimports.demo",
      phone: "020 3456 7890",
      addressLine1: "Docklands Business Centre",
      city: "London",
      postcode: "E14 9SH",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.company7,
      firmId: DEMO_IDS.firm,
      type: "company" as const,
      status: "active" as const,
      reference: "CLI-DEMO-013",
      companyName: `${DEMO_PREFIX}Healthcare Plus Ltd`,
      companyNumber: "67890123",
      email: "legal@healthcareplus.demo",
      phone: "0121 678 9012",
      addressLine1: "Medical Quarter",
      city: "Birmingham",
      postcode: "B15 2TH",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.trust1,
      firmId: DEMO_IDS.firm,
      type: "trust" as const,
      status: "active" as const,
      reference: "CLI-DEMO-014",
      companyName: `${DEMO_PREFIX}Henderson Family Trust`,
      email: "trustees@hendersontrust.demo",
      phone: "0117 789 0123",
      addressLine1: "89 Whiteladies Road",
      city: "Bristol",
      postcode: "BS8 2NT",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
    {
      id: DEMO_IDS.clients.estate1,
      firmId: DEMO_IDS.firm,
      type: "trust" as const,
      status: "active" as const,
      reference: "CLI-DEMO-015",
      companyName: `${DEMO_PREFIX}Carter Estate`,
      email: "executors@carterestate.demo",
      phone: "0131 890 1234",
      addressLine1: "32 Charlotte Square",
      city: "Edinburgh",
      postcode: "EH2 4ET",
      country: "United Kingdom",
      createdAt: now,
      updatedAt: now,
    },
  ];

  const createdClients = [];

  for (const clientData of clientsData) {
    const [client] = await db
      .insert(clients)
      .values(clientData)
      .onConflictDoUpdate({
        target: clients.id,
        set: { updatedAt: now },
      })
      .returning();

    const displayName =
      client.type === "individual" ? `${client.firstName} ${client.lastName}` : client.companyName;

    createdClients.push({ id: client.id, name: displayName!, type: client.type });
    console.log(`    Created client: ${displayName}`);
  }

  return createdClients;
}
