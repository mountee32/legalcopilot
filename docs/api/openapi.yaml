openapi: 3.0.0
info:
  title: Legal Copilot API
  version: 1.0.0
  description: |-
    AI-first practice management API for UK law firms.

    ## Authentication
    All endpoints require authentication via Bearer token.

    ## Rate Limiting
    API requests are rate limited to 100 requests per minute.

    ## Pagination
    List endpoints support pagination via `page` and `limit` query parameters.
  contact:
    name: Legal Copilot Support
servers:
  - url: http://localhost:3000
    description: Development server
tags:
  - name: Clients
    description: Client management endpoints
  - name: Matters
    description: Matter/case management endpoints
  - name: Documents
    description: Document management endpoints
  - name: Billing
    description: Time tracking and invoicing endpoints
  - name: Approvals
    description: Human approval queue endpoints
  - name: Calendar
    description: Calendar endpoints
  - name: Emails
    description: Email endpoints
  - name: Tasks
    description: Task management endpoints
  - name: Notifications
    description: Notification endpoints
  - name: Templates
    description: Template endpoints
  - name: Intake
    description: Leads and quotes endpoints
  - name: Conflicts
    description: Conflict checking endpoints
  - name: Integrations
    description: External provider connections & webhooks
  - name: Search
    description: Semantic search endpoints
  - name: Storage
    description: File upload and storage endpoints
  - name: System
    description: System health and monitoring endpoints
  - name: AI
    description: AI and ML endpoints
  - name: Jobs
    description: Background job queue endpoints
components:
  schemas:
    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: Error message
          example: Validation failed
        code:
          type: string
          description: Machine-readable error code
          example: VALIDATION_ERROR
        details:
          type: object
          additionalProperties:
            nullable: true
          description: Additional error details
      required:
        - error
    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        message:
          type: string
      required:
        - success
    Pagination:
      type: object
      properties:
        page:
          type: integer
          minimum: 1
          default: 1
          description: Page number (1-indexed)
          example: 1
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          description: Items per page (max 100)
          example: 20
    ApprovalRequest:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        sourceType:
          type: string
          enum:
            - ai
            - system
            - user
          description: Origin of the approval request
          example: ai
        sourceId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        action:
          type: string
          example: email.send
        summary:
          type: string
        proposedPayload:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        entityType:
          type: string
          nullable: true
        entityId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        status:
          type: string
          enum: &a1
            - pending
            - approved
            - rejected
            - cancelled
            - expired
          description: Approval decision status
          example: pending
        decidedBy:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        decidedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        decisionReason:
          type: string
          nullable: true
        executedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        executionStatus:
          type: string
          enum:
            - not_executed
            - executed
            - failed
          description: Execution status after approval
          example: not_executed
        executionError:
          type: string
          nullable: true
        aiMetadata:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - sourceType
        - sourceId
        - action
        - summary
        - proposedPayload
        - entityType
        - entityId
        - matterId
        - status
        - decidedBy
        - decidedAt
        - decisionReason
        - executedAt
        - executionStatus
        - executionError
        - aiMetadata
        - createdAt
        - updatedAt
    ApprovalListResponse:
      type: object
      properties:
        approvals:
          type: array
          items:
            $ref: "#/components/schemas/ApprovalRequest"
        pagination:
          type: object
          properties:
            page:
              type: number
            limit:
              type: number
            total:
              type: number
            totalPages:
              type: number
          required:
            - page
            - limit
            - total
            - totalPages
      required:
        - approvals
        - pagination
    ApprovalQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            status:
              type: string
              enum: *a1
              description: Approval decision status
              example: pending
            action:
              type: string
            entityType:
              type: string
            entityId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
    ApproveRequest:
      type: object
      properties:
        decisionReason:
          type: string
    BulkApproveRequest:
      type: object
      properties:
        ids:
          type: array
          items:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          minItems: 1
        decisionReason:
          type: string
      required:
        - ids
    BulkApproveResponse:
      type: object
      properties:
        approvals:
          type: array
          items:
            $ref: "#/components/schemas/ApprovalRequest"
      required:
        - approvals
    Client:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        reference:
          type: string
          example: CLI-2024-0042
        type:
          type: string
          enum: &a2
            - individual
            - company
            - trust
            - estate
            - charity
            - government
          description: Type of client entity
          example: individual
        status:
          type: string
          enum: &a4
            - prospect
            - active
            - dormant
            - archived
          description: Current status in client lifecycle
          example: active
        source:
          type: string
          nullable: true
          enum: &a3
            - website
            - referral
            - walk_in
            - phone
            - email
            - lead_conversion
            - existing_client
            - partner_firm
            - marketing
            - social_media
            - other
          description: How the client was acquired (for marketing attribution)
          example: website
        sourceId:
          type: string
          nullable: true
          format: uuid
          description: Link to source record (e.g., lead ID if converted from lead)
          example: 123e4567-e89b-12d3-a456-426614174000
        title:
          type: string
          nullable: true
          example: Mr
        firstName:
          type: string
          nullable: true
          example: John
        lastName:
          type: string
          nullable: true
          example: Smith
        companyName:
          type: string
          nullable: true
          example: Acme Ltd
        companyNumber:
          type: string
          nullable: true
          example: "12345678"
        email:
          type: string
          nullable: true
          format: email
          description: Email address
          example: john.smith@example.com
        phone:
          type: string
          nullable: true
          description: Phone number in E.164 or UK format
          example: +44 20 7946 0958
        mobile:
          type: string
          nullable: true
          description: Phone number in E.164 or UK format
          example: +44 20 7946 0958
        addressLine1:
          type: string
          nullable: true
        addressLine2:
          type: string
          nullable: true
        city:
          type: string
          nullable: true
          example: London
        county:
          type: string
          nullable: true
          example: Greater London
        postcode:
          type: string
          nullable: true
          pattern: ^[A-Z]{1,2}\d[A-Z\d]? ?\d[A-Z]{2}$
          description: UK postcode
          example: SW1A 1AA
        country:
          type: string
          nullable: true
          example: United Kingdom
        idVerified:
          type: boolean
        idVerifiedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        sofVerified:
          type: boolean
        sofVerifiedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        notes:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - reference
        - type
        - status
        - source
        - sourceId
        - title
        - firstName
        - lastName
        - companyName
        - companyNumber
        - email
        - phone
        - mobile
        - addressLine1
        - addressLine2
        - city
        - county
        - postcode
        - country
        - idVerified
        - idVerifiedAt
        - sofVerified
        - sofVerifiedAt
        - notes
        - createdAt
        - updatedAt
    CreateClientRequest:
      type: object
      properties:
        type:
          type: string
          enum: *a2
          default: individual
          description: Type of client entity
          example: individual
        source:
          type: string
          enum: *a3
          description: How the client was acquired (for marketing attribution)
          example: website
        sourceId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        title:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        companyName:
          type: string
        companyNumber:
          type: string
        email:
          type: string
          format: email
          description: Email address
          example: john.smith@example.com
        phone:
          type: string
        mobile:
          type: string
        addressLine1:
          type: string
        addressLine2:
          type: string
        city:
          type: string
        county:
          type: string
        postcode:
          type: string
        country:
          type: string
          default: United Kingdom
        notes:
          type: string
      required:
        - email
    UpdateClientRequest:
      type: object
      properties:
        source:
          type: string
          enum: *a3
          description: How the client was acquired (for marketing attribution)
          example: website
        sourceId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        title:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        companyName:
          type: string
        companyNumber:
          type: string
        email:
          type: string
          format: email
          description: Email address
          example: john.smith@example.com
        phone:
          type: string
        mobile:
          type: string
        addressLine1:
          type: string
        addressLine2:
          type: string
        city:
          type: string
        county:
          type: string
        postcode:
          type: string
        country:
          type: string
          default: United Kingdom
        notes:
          type: string
    ClientListResponse:
      type: object
      properties:
        clients:
          type: array
          items:
            $ref: "#/components/schemas/Client"
        pagination:
          type: object
          properties:
            page:
              type: number
            limit:
              type: number
            total:
              type: number
            totalPages:
              type: number
          required:
            - page
            - limit
            - total
            - totalPages
      required:
        - clients
        - pagination
    ClientQuery:
      type: object
      properties:
        page:
          type: integer
          minimum: 1
          default: 1
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
        status:
          type: string
          enum: *a4
          description: Current status in client lifecycle
          example: active
        type:
          type: string
          enum: *a2
          description: Type of client entity
          example: individual
        search:
          type: string
          description: Search by name, company name, or reference
    Matter:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        reference:
          type: string
          example: SMI-2024-0042
        title:
          type: string
          example: Smith v Jones - Property Dispute
        description:
          type: string
          nullable: true
        clientId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        feeEarnerId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        supervisorId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        status:
          type: string
          enum: &a7
            - lead
            - active
            - on_hold
            - closed
            - archived
          description: Current status in matter lifecycle
          example: active
        practiceArea:
          type: string
          enum: &a5
            - conveyancing
            - litigation
            - family
            - probate
            - employment
            - immigration
            - personal_injury
            - commercial
            - criminal
            - ip
            - insolvency
            - other
          description: Legal practice area
          example: conveyancing
        billingType:
          type: string
          enum: &a6
            - hourly
            - fixed_fee
            - conditional
            - legal_aid
            - pro_bono
          description: Billing arrangement type
          example: hourly
        hourlyRate:
          type: string
          nullable: true
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        fixedFee:
          type: string
          nullable: true
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        estimatedValue:
          type: string
          nullable: true
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        openedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        closedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        keyDeadline:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        notes:
          type: string
          nullable: true
        riskScore:
          type: integer
          nullable: true
          minimum: 0
          maximum: 100
          description: AI-calculated risk score (0-100, higher = more risky)
          example: 35
        riskFactors:
          type: array
          nullable: true
          items:
            nullable: true
          description: AI risk assessment factors for explainability
          example:
            - factor: tight_deadline
              weight: 0.4
            - factor: high_value
              weight: 0.3
        riskAssessedAt:
          type: string
          nullable: true
          format: date-time
          description: When AI last calculated the risk score
          example: 2024-12-17T10:30:00Z
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - reference
        - title
        - description
        - clientId
        - feeEarnerId
        - supervisorId
        - status
        - practiceArea
        - billingType
        - hourlyRate
        - fixedFee
        - estimatedValue
        - openedAt
        - closedAt
        - keyDeadline
        - notes
        - riskScore
        - riskFactors
        - riskAssessedAt
        - createdAt
        - updatedAt
    CreateMatterRequest:
      type: object
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
        clientId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        feeEarnerId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        supervisorId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        practiceArea:
          type: string
          enum: *a5
          description: Legal practice area
          example: conveyancing
        billingType:
          type: string
          enum: *a6
          default: hourly
          description: Billing arrangement type
          example: hourly
        hourlyRate:
          type: string
        fixedFee:
          type: string
        estimatedValue:
          type: string
        keyDeadline:
          type: string
          format: date-time
        notes:
          type: string
      required:
        - title
        - clientId
        - practiceArea
    UpdateMatterRequest:
      type: object
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
          nullable: true
        feeEarnerId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        supervisorId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        status:
          type: string
          enum: *a7
          description: Current status in matter lifecycle
          example: active
        billingType:
          type: string
          enum: *a6
          description: Billing arrangement type
          example: hourly
        hourlyRate:
          type: string
          nullable: true
        fixedFee:
          type: string
          nullable: true
        estimatedValue:
          type: string
          nullable: true
        keyDeadline:
          type: string
          nullable: true
          format: date-time
        notes:
          type: string
          nullable: true
        riskScore:
          type: integer
          nullable: true
          minimum: 0
          maximum: 100
        riskFactors:
          type: array
          nullable: true
          items:
            nullable: true
        riskAssessedAt:
          type: string
          nullable: true
          format: date-time
    MatterListResponse:
      type: object
      properties:
        matters:
          type: array
          items:
            $ref: "#/components/schemas/Matter"
        pagination:
          type: object
          properties:
            page:
              type: number
            limit:
              type: number
            total:
              type: number
            totalPages:
              type: number
          required:
            - page
            - limit
            - total
            - totalPages
      required:
        - matters
        - pagination
    MatterQuery:
      type: object
      properties:
        page:
          type: integer
          minimum: 1
          default: 1
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
        status:
          type: string
          enum: *a7
          description: Current status in matter lifecycle
          example: active
        practiceArea:
          type: string
          enum: *a5
          description: Legal practice area
          example: conveyancing
        clientId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        feeEarnerId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        search:
          type: string
          description: Search by reference or title
    DocumentType:
      type: string
      enum:
        - letter_in
        - letter_out
        - email_in
        - email_out
        - contract
        - court_form
        - evidence
        - note
        - id_document
        - financial
        - other
    DocumentStatus:
      type: string
      enum:
        - draft
        - pending_review
        - approved
        - sent
        - archived
    Document:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        title:
          type: string
        type:
          $ref: "#/components/schemas/DocumentType"
        status:
          $ref: "#/components/schemas/DocumentStatus"
        uploadId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        filename:
          type: string
          nullable: true
        mimeType:
          type: string
          nullable: true
        fileSize:
          type: integer
          nullable: true
        createdBy:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        documentDate:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        recipient:
          type: string
          nullable: true
        sender:
          type: string
          nullable: true
        aiSummary:
          type: string
          nullable: true
        extractedText:
          type: string
          nullable: true
        chunkedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        chunkCount:
          type: integer
          nullable: true
        metadata:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        version:
          type: integer
        parentId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - matterId
        - title
        - type
        - status
        - uploadId
        - filename
        - mimeType
        - fileSize
        - createdBy
        - documentDate
        - recipient
        - sender
        - aiSummary
        - extractedText
        - chunkedAt
        - chunkCount
        - metadata
        - version
        - parentId
        - createdAt
        - updatedAt
    DocumentListResponse:
      type: object
      properties:
        documents:
          type: array
          items:
            $ref: "#/components/schemas/Document"
      required:
        - documents
    CreateDocumentRequest:
      type: object
      properties:
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        title:
          type: string
          minLength: 1
          maxLength: 200
        type:
          $ref: "#/components/schemas/DocumentType"
        uploadId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        filename:
          type: string
        mimeType:
          type: string
        fileSize:
          type: integer
        documentDate:
          anyOf:
            - type: string
              format: date
              description: ISO 8601 date string
              example: 2024-12-17
            - type: string
              format: date-time
              description: ISO 8601 date-time string
              example: 2024-12-17T10:30:00Z
        recipient:
          type: string
        sender:
          type: string
        extractedText:
          type: string
        metadata:
          type: object
          additionalProperties:
            nullable: true
      required:
        - matterId
        - title
        - type
    AskMatterRequest:
      type: object
      properties:
        question:
          type: string
          minLength: 1
          maxLength: 5000
      required:
        - question
    SourceCitation:
      type: object
      properties:
        documentId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        documentChunkId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        quote:
          type: string
      required:
        - documentId
        - documentChunkId
    AskMatterResponse:
      type: object
      properties:
        answer:
          type: string
        citations:
          type: array
          items:
            $ref: "#/components/schemas/SourceCitation"
          default: []
      required:
        - answer
    DocumentChunk:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        documentId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        chunkIndex:
          type: integer
        text:
          type: string
        pageStart:
          type: integer
          nullable: true
        pageEnd:
          type: integer
          nullable: true
        charStart:
          type: integer
          nullable: true
        charEnd:
          type: integer
          nullable: true
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - documentId
        - matterId
        - chunkIndex
        - text
        - pageStart
        - pageEnd
        - charStart
        - charEnd
        - createdAt
    DocumentChunkListResponse:
      type: object
      properties:
        chunks:
          type: array
          items:
            $ref: "#/components/schemas/DocumentChunk"
      required:
        - chunks
    ChunkDocumentRequest:
      type: object
      properties:
        maxChars:
          type: integer
          minimum: 200
          maximum: 10000
    ChunkDocumentResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        chunkCount:
          type: integer
      required:
        - success
        - chunkCount
    DocumentJobAcceptedResponse:
      type: object
      properties:
        accepted:
          type: boolean
          enum:
            - true
        jobId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - accepted
        - jobId
    ExtractDocumentRequest:
      type: object
      properties:
        async:
          type: boolean
        force:
          type: boolean
        autoChunk:
          type: boolean
        maxChars:
          type: integer
          minimum: 200
          maximum: 10000
    ExtractDocumentResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        extractedText:
          type: string
        length:
          type: integer
        chunkCount:
          type: integer
          nullable: true
      required:
        - success
        - extractedText
        - length
        - chunkCount
    SummarizeDocumentResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        summary:
          type: string
        keyPoints:
          type: array
          items:
            type: string
          default: []
      required:
        - success
        - summary
    DocumentEntities:
      type: object
      properties:
        dates:
          type: array
          items:
            type: string
          default: []
        parties:
          type: array
          items:
            type: string
          default: []
        amounts:
          type: array
          items:
            type: string
          default: []
        addresses:
          type: array
          items:
            type: string
          default: []
    DocumentEntitiesResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        entities:
          $ref: "#/components/schemas/DocumentEntities"
      required:
        - success
        - entities
    FirmSettings:
      type: object
      properties:
        branding:
          type: object
          properties:
            logoUrl:
              type: string
              format: uri
            primaryColor:
              type: string
            portalName:
              type: string
        billing:
          type: object
          properties:
            defaultVatRate:
              type: number
              minimum: 0
              maximum: 100
            defaultPaymentTermsDays:
              type: integer
              minimum: 1
              maximum: 365
            invoicePrefix:
              type: string
              minLength: 1
              maxLength: 20
            invoiceFooter:
              type: string
              maxLength: 5000
        ai:
          type: object
          properties:
            defaultModel:
              type: string
            autoApproveThreshold:
              type: number
              minimum: 0
              maximum: 1
            enabledFeatures:
              type: array
              items:
                type: string
        features:
          type: object
          properties:
            emailIntegration:
              type: boolean
            calendarSync:
              type: boolean
            clientPortal:
              type: boolean
            eSignature:
              type: boolean
    FirmSettingsResponse:
      type: object
      properties:
        settings:
          $ref: "#/components/schemas/FirmSettings"
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - settings
        - updatedAt
    UpdateFirmSettingsRequest:
      type: object
      properties:
        branding:
          type: object
          properties:
            logoUrl:
              type: string
              format: uri
            primaryColor:
              type: string
            portalName:
              type: string
        billing:
          type: object
          properties:
            defaultVatRate:
              type: number
              minimum: 0
              maximum: 100
            defaultPaymentTermsDays:
              type: integer
              minimum: 1
              maximum: 365
            invoicePrefix:
              type: string
              minLength: 1
              maxLength: 20
            invoiceFooter:
              type: string
              maxLength: 5000
        ai:
          type: object
          properties:
            defaultModel:
              type: string
            autoApproveThreshold:
              type: number
              minimum: 0
              maximum: 1
            enabledFeatures:
              type: array
              items:
                type: string
        features:
          type: object
          properties:
            emailIntegration:
              type: boolean
            calendarSync:
              type: boolean
            clientPortal:
              type: boolean
            eSignature:
              type: boolean
    Permission:
      type: string
      enum:
        - cases:read
        - cases:write
        - cases:delete
        - clients:read
        - clients:write
        - clients:delete
        - documents:read
        - documents:write
        - documents:delete
        - billing:read
        - billing:write
        - billing:approve
        - time:read
        - time:write
        - time:approve
        - calendar:read
        - calendar:write
        - emails:read
        - emails:write
        - emails:send
        - approvals:view
        - approvals:decide
        - users:read
        - users:write
        - users:invite
        - firm:settings
        - firm:billing
        - reports:view
        - reports:export
        - ai:use
        - ai:configure
        - integrations:read
        - integrations:write
        - templates:read
        - templates:write
        - intake:read
        - intake:write
        - conflicts:read
        - conflicts:write
    Role:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        name:
          type: string
        description:
          type: string
          nullable: true
        permissions:
          type: array
          items:
            $ref: "#/components/schemas/Permission"
        isSystem:
          type: boolean
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - name
        - description
        - permissions
        - isSystem
        - createdAt
        - updatedAt
    RoleListResponse:
      type: object
      properties:
        roles:
          type: array
          items:
            $ref: "#/components/schemas/Role"
      required:
        - roles
    CreateRoleRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 50
        description:
          type: string
          maxLength: 500
        permissions:
          type: array
          items:
            $ref: "#/components/schemas/Permission"
          minItems: 1
      required:
        - name
        - permissions
    UpdateRoleRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 50
        description:
          type: string
          maxLength: 500
        permissions:
          type: array
          items:
            $ref: "#/components/schemas/Permission"
          minItems: 1
    AssignRoleRequest:
      type: object
      properties:
        roleId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - roleId
    AssignRoleResponse:
      type: object
      properties:
        userId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        roleId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - userId
        - roleId
    UserIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TimelineEventType:
      type: string
      enum:
        - matter_created
        - matter_updated
        - matter_archived
        - document_uploaded
        - document_chunked
        - email_received
        - email_sent
        - task_created
        - task_completed
        - approval_decided
        - note_added
    TimelineActorType:
      type: string
      enum:
        - user
        - system
        - ai
    TimelineEvent:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        type:
          $ref: "#/components/schemas/TimelineEventType"
        title:
          type: string
        description:
          type: string
          nullable: true
        actorType:
          $ref: "#/components/schemas/TimelineActorType"
        actorId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        entityType:
          type: string
          nullable: true
        entityId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        metadata:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        occurredAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - matterId
        - type
        - title
        - description
        - actorType
        - actorId
        - entityType
        - entityId
        - metadata
        - occurredAt
        - createdAt
    PaginationMeta:
      type: object
      properties:
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
        totalPages:
          type: integer
        hasNext:
          type: boolean
        hasPrev:
          type: boolean
      required:
        - page
        - limit
        - total
        - totalPages
        - hasNext
        - hasPrev
    TimelineListResponse:
      type: object
      properties:
        events:
          type: array
          items:
            $ref: "#/components/schemas/TimelineEvent"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - events
        - pagination
    TimelineQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            type:
              $ref: "#/components/schemas/TimelineEventType"
            entityType:
              type: string
            entityId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            from:
              type: string
              format: date-time
              description: ISO 8601 date-time string
              example: 2024-12-17T10:30:00Z
            to:
              type: string
              format: date-time
              description: ISO 8601 date-time string
              example: 2024-12-17T10:30:00Z
    CreateTimelineEventRequest:
      type: object
      properties:
        type:
          allOf:
            - $ref: "#/components/schemas/TimelineEventType"
            - default: note_added
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
          maxLength: 10000
        occurredAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        metadata:
          type: object
          additionalProperties:
            nullable: true
      required:
        - title
    NotificationType:
      type: string
      enum:
        - task_assigned
        - task_due
        - task_overdue
        - approval_required
        - approval_decided
        - deadline_approaching
        - deadline_passed
        - email_received
        - document_uploaded
        - invoice_paid
        - payment_received
        - system
    Notification:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        userId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        type:
          $ref: "#/components/schemas/NotificationType"
        title:
          type: string
        body:
          type: string
          nullable: true
        link:
          type: string
          nullable: true
        read:
          type: boolean
        readAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        channels:
          type: array
          nullable: true
          items:
            type: string
        metadata:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - userId
        - type
        - title
        - body
        - link
        - read
        - readAt
        - channels
        - metadata
        - createdAt
    NotificationListResponse:
      type: object
      properties:
        notifications:
          type: array
          items:
            $ref: "#/components/schemas/Notification"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - notifications
        - pagination
    NotificationQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            read:
              type: boolean
            type:
              $ref: "#/components/schemas/NotificationType"
    NotificationPreferences:
      type: object
      properties:
        channelsByType:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
              enum: &a8
                - in_app
                - email
                - push
    NotificationPreferencesResponse:
      type: object
      properties:
        preferences:
          $ref: "#/components/schemas/NotificationPreferences"
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - preferences
        - updatedAt
    UpdateNotificationPreferencesRequest:
      type: object
      properties:
        channelsByType:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
              enum: *a8
    TaskPriority:
      type: string
      enum:
        - low
        - medium
        - high
        - urgent
    TaskStatus:
      type: string
      enum:
        - pending
        - in_progress
        - completed
        - cancelled
    TaskAiSource:
      type: string
      nullable: true
      enum:
        - email
        - document
        - matter
        - other
    Task:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        title:
          type: string
        description:
          type: string
          nullable: true
        assigneeId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdById:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        priority:
          $ref: "#/components/schemas/TaskPriority"
        status:
          $ref: "#/components/schemas/TaskStatus"
        dueDate:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        completedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        checklistItems:
          type: array
          nullable: true
          items:
            nullable: true
        tags:
          type: array
          nullable: true
          items:
            nullable: true
        aiGenerated:
          type: boolean
        aiSource:
          $ref: "#/components/schemas/TaskAiSource"
        sourceEntityType:
          type: string
          nullable: true
        sourceEntityId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - matterId
        - title
        - description
        - assigneeId
        - createdById
        - priority
        - status
        - dueDate
        - completedAt
        - checklistItems
        - tags
        - aiGenerated
        - aiSource
        - sourceEntityType
        - sourceEntityId
        - createdAt
        - updatedAt
    TaskListResponse:
      type: object
      properties:
        tasks:
          type: array
          items:
            $ref: "#/components/schemas/Task"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - tasks
        - pagination
    TaskQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            matterId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            assigneeId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            status:
              $ref: "#/components/schemas/TaskStatus"
            priority:
              $ref: "#/components/schemas/TaskPriority"
    CreateTaskRequest:
      type: object
      properties:
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
          maxLength: 10000
        assigneeId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        priority:
          $ref: "#/components/schemas/TaskPriority"
        dueDate:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        checklistItems:
          type: array
          items:
            nullable: true
        tags:
          type: array
          items:
            nullable: true
      required:
        - matterId
        - title
    UpdateTaskRequest:
      type: object
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
          maxLength: 10000
        assigneeId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        priority:
          $ref: "#/components/schemas/TaskPriority"
        status:
          $ref: "#/components/schemas/TaskStatus"
        dueDate:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        checklistItems:
          type: array
          nullable: true
          items:
            nullable: true
        tags:
          type: array
          nullable: true
          items:
            nullable: true
    GenerateTasksRequest:
      type: object
      properties:
        goal:
          type: string
          maxLength: 2000
    EmailDirection:
      type: string
      enum:
        - inbound
        - outbound
    EmailAddress:
      type: object
      properties:
        email:
          type: string
          format: email
          description: Email address
          example: john.smith@example.com
        name:
          type: string
      required:
        - email
    EmailStatus:
      type: string
      enum:
        - draft
        - pending
        - sent
        - delivered
        - received
        - failed
        - bounced
        - archived
    EmailIntent:
      type: string
      nullable: true
      enum:
        - request_information
        - provide_information
        - request_action
        - status_update
        - complaint
        - deadline
        - confirmation
        - general
    EmailSentiment:
      type: string
      nullable: true
      enum:
        - positive
        - neutral
        - negative
        - frustrated
    Email:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        direction:
          $ref: "#/components/schemas/EmailDirection"
        fromAddress:
          $ref: "#/components/schemas/EmailAddress"
        toAddresses:
          type: array
          items:
            $ref: "#/components/schemas/EmailAddress"
        ccAddresses:
          type: array
          nullable: true
          items:
            $ref: "#/components/schemas/EmailAddress"
        bccAddresses:
          type: array
          nullable: true
          items:
            $ref: "#/components/schemas/EmailAddress"
        subject:
          type: string
        bodyText:
          type: string
          nullable: true
        bodyHtml:
          type: string
          nullable: true
        messageId:
          type: string
          nullable: true
        threadId:
          type: string
          nullable: true
        inReplyTo:
          type: string
          nullable: true
        hasAttachments:
          type: boolean
        attachmentCount:
          type: integer
        attachmentIds:
          type: array
          nullable: true
          items:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
        status:
          $ref: "#/components/schemas/EmailStatus"
        readAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        aiProcessed:
          type: boolean
        aiProcessedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        aiIntent:
          $ref: "#/components/schemas/EmailIntent"
        aiSentiment:
          $ref: "#/components/schemas/EmailSentiment"
        aiUrgency:
          type: integer
          nullable: true
        aiSummary:
          type: string
          nullable: true
        aiSuggestedResponse:
          type: string
          nullable: true
        aiSuggestedTasks:
          type: array
          nullable: true
          items:
            type: string
        aiMatchedMatterId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        aiMatchConfidence:
          type: integer
          nullable: true
        createdBy:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        receivedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        sentAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - matterId
        - direction
        - fromAddress
        - toAddresses
        - ccAddresses
        - bccAddresses
        - subject
        - bodyText
        - bodyHtml
        - messageId
        - threadId
        - inReplyTo
        - hasAttachments
        - attachmentCount
        - attachmentIds
        - status
        - readAt
        - aiProcessed
        - aiProcessedAt
        - aiIntent
        - aiSentiment
        - aiUrgency
        - aiSummary
        - aiSuggestedResponse
        - aiSuggestedTasks
        - aiMatchedMatterId
        - aiMatchConfidence
        - createdBy
        - receivedAt
        - sentAt
        - createdAt
        - updatedAt
    EmailListResponse:
      type: object
      properties:
        emails:
          type: array
          items:
            $ref: "#/components/schemas/Email"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - emails
        - pagination
    EmailQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            matterId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            direction:
              $ref: "#/components/schemas/EmailDirection"
            status:
              $ref: "#/components/schemas/EmailStatus"
            aiProcessed:
              type: boolean
            search:
              type: string
    CreateEmailRequest:
      type: object
      properties:
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        direction:
          $ref: "#/components/schemas/EmailDirection"
        fromAddress:
          $ref: "#/components/schemas/EmailAddress"
        toAddresses:
          type: array
          items:
            $ref: "#/components/schemas/EmailAddress"
          minItems: 1
        ccAddresses:
          type: array
          items:
            $ref: "#/components/schemas/EmailAddress"
        bccAddresses:
          type: array
          items:
            $ref: "#/components/schemas/EmailAddress"
        subject:
          type: string
          minLength: 1
          maxLength: 500
        bodyText:
          type: string
        bodyHtml:
          type: string
        messageId:
          type: string
        threadId:
          type: string
        inReplyTo:
          type: string
        attachmentIds:
          type: array
          items:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - direction
        - fromAddress
        - toAddresses
        - subject
    UpdateEmailRequest:
      type: object
      properties:
        matterId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        status:
          $ref: "#/components/schemas/EmailStatus"
        readAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
    EmailAIProcessResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        email:
          $ref: "#/components/schemas/Email"
      required:
        - success
        - email
    TimeEntryStatus:
      type: string
      enum:
        - draft
        - submitted
        - approved
        - billed
        - written_off
    TimeEntrySource:
      type: string
      enum:
        - manual
        - ai_suggested
        - email_inferred
        - document_activity
        - calendar
    TimeEntry:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        feeEarnerId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        workDate:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        description:
          type: string
        durationMinutes:
          type: integer
        hourlyRate:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        amount:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        status:
          $ref: "#/components/schemas/TimeEntryStatus"
        source:
          $ref: "#/components/schemas/TimeEntrySource"
        isBillable:
          type: boolean
        invoiceId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        activityCode:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - matterId
        - feeEarnerId
        - workDate
        - description
        - durationMinutes
        - hourlyRate
        - amount
        - status
        - source
        - isBillable
        - invoiceId
        - activityCode
        - createdAt
        - updatedAt
    TimeEntryListResponse:
      type: object
      properties:
        timeEntries:
          type: array
          items:
            $ref: "#/components/schemas/TimeEntry"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - timeEntries
        - pagination
    TimeEntryQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            matterId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            feeEarnerId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            status:
              $ref: "#/components/schemas/TimeEntryStatus"
            from:
              type: string
              format: date
              description: ISO 8601 date string
              example: 2024-12-17
            to:
              type: string
              format: date
              description: ISO 8601 date string
              example: 2024-12-17
    CreateTimeEntryRequest:
      type: object
      properties:
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        feeEarnerId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        workDate:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        description:
          type: string
          minLength: 1
          maxLength: 5000
        durationMinutes:
          type: integer
          minimum: 6
          maximum: 1440
        hourlyRate:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        source:
          $ref: "#/components/schemas/TimeEntrySource"
        isBillable:
          type: boolean
        activityCode:
          type: string
      required:
        - matterId
        - workDate
        - description
        - durationMinutes
        - hourlyRate
    UpdateTimeEntryRequest:
      type: object
      properties:
        workDate:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        description:
          type: string
          minLength: 1
          maxLength: 5000
        durationMinutes:
          type: integer
          minimum: 6
          maximum: 1440
        hourlyRate:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        source:
          $ref: "#/components/schemas/TimeEntrySource"
        isBillable:
          type: boolean
        activityCode:
          type: string
          nullable: true
    BulkSubmitTimeEntriesRequest:
      type: object
      properties:
        ids:
          type: array
          items:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          minItems: 1
          maxItems: 200
      required:
        - ids
    BulkSubmitTimeEntriesResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        approvalRequestIds:
          type: array
          items:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - success
        - approvalRequestIds
    InvoiceStatus:
      type: string
      enum:
        - draft
        - sent
        - viewed
        - partially_paid
        - paid
        - overdue
        - written_off
    Invoice:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        invoiceNumber:
          type: string
        clientId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        status:
          $ref: "#/components/schemas/InvoiceStatus"
        invoiceDate:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        dueDate:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        subtotal:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        vatAmount:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        vatRate:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        total:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        paidAmount:
          type: string
          nullable: true
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        balanceDue:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        terms:
          type: string
          nullable: true
        notes:
          type: string
          nullable: true
        sentAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        viewedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        paidAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - invoiceNumber
        - clientId
        - matterId
        - status
        - invoiceDate
        - dueDate
        - subtotal
        - vatAmount
        - vatRate
        - total
        - paidAmount
        - balanceDue
        - terms
        - notes
        - sentAt
        - viewedAt
        - paidAt
        - createdAt
        - updatedAt
    InvoiceLineItem:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        invoiceId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        description:
          type: string
        amount:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        sourceType:
          type: string
          nullable: true
        sourceId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        metadata:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - invoiceId
        - description
        - amount
        - sourceType
        - sourceId
        - metadata
        - createdAt
    InvoiceWithItemsResponse:
      type: object
      properties:
        invoice:
          $ref: "#/components/schemas/Invoice"
        items:
          type: array
          items:
            $ref: "#/components/schemas/InvoiceLineItem"
      required:
        - invoice
        - items
    InvoiceListResponse:
      type: object
      properties:
        invoices:
          type: array
          items:
            $ref: "#/components/schemas/Invoice"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - invoices
        - pagination
    InvoiceQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            clientId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            matterId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            status:
              $ref: "#/components/schemas/InvoiceStatus"
    GenerateInvoiceRequest:
      type: object
      properties:
        clientId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        timeEntryIds:
          type: array
          items:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          minItems: 1
          maxItems: 500
        additionalItems:
          type: array
          items:
            type: object
            properties:
              description:
                type: string
                minLength: 1
                maxLength: 5000
              amount:
                type: string
                pattern: ^\d+\.\d{2}$
                description: Monetary amount with 2 decimal places
                example: "1250.00"
            required:
              - description
              - amount
        notes:
          type: string
        invoiceDate:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        dueDate:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        vatRate:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
      required:
        - clientId
        - timeEntryIds
    UpdateInvoiceRequest:
      type: object
      properties:
        dueDate:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        terms:
          type: string
          nullable: true
        notes:
          type: string
          nullable: true
        vatRate:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
    PaymentMethod:
      type: string
      enum:
        - bank_transfer
        - card
        - cheque
        - cash
        - client_account
    Payment:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        invoiceId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        amount:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        method:
          $ref: "#/components/schemas/PaymentMethod"
        paymentDate:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        reference:
          type: string
          nullable: true
        notes:
          type: string
          nullable: true
        recordedBy:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - invoiceId
        - amount
        - method
        - paymentDate
        - reference
        - notes
        - recordedBy
        - createdAt
    PaymentListResponse:
      type: object
      properties:
        payments:
          type: array
          items:
            $ref: "#/components/schemas/Payment"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - payments
        - pagination
    PaymentQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            invoiceId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            method:
              $ref: "#/components/schemas/PaymentMethod"
            from:
              type: string
              format: date
              description: ISO 8601 date string
              example: 2024-12-17
            to:
              type: string
              format: date
              description: ISO 8601 date string
              example: 2024-12-17
    CreatePaymentRequest:
      type: object
      properties:
        invoiceId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        amount:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        method:
          $ref: "#/components/schemas/PaymentMethod"
        paymentDate:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        reference:
          type: string
        notes:
          type: string
      required:
        - invoiceId
        - amount
        - method
        - paymentDate
    CalendarEventType:
      type: string
      enum:
        - hearing
        - deadline
        - meeting
        - reminder
        - limitation_date
        - filing_deadline
        - other
    CalendarEventStatus:
      type: string
      enum:
        - scheduled
        - completed
        - cancelled
        - rescheduled
    CalendarEventPriority:
      type: string
      enum:
        - low
        - medium
        - high
        - critical
    CalendarEvent:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        title:
          type: string
        description:
          type: string
          nullable: true
        eventType:
          $ref: "#/components/schemas/CalendarEventType"
        status:
          $ref: "#/components/schemas/CalendarEventStatus"
        priority:
          $ref: "#/components/schemas/CalendarEventPriority"
        startAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        endAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        allDay:
          type: boolean
        location:
          type: string
          nullable: true
        attendees:
          type: array
          nullable: true
          items:
            nullable: true
        reminderMinutes:
          type: array
          nullable: true
          items:
            type: integer
        recurrence:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        createdById:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        externalId:
          type: string
          nullable: true
        externalSource:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - matterId
        - title
        - description
        - eventType
        - status
        - priority
        - startAt
        - endAt
        - allDay
        - location
        - attendees
        - reminderMinutes
        - recurrence
        - createdById
        - externalId
        - externalSource
        - createdAt
        - updatedAt
    CalendarListResponse:
      type: object
      properties:
        events:
          type: array
          items:
            $ref: "#/components/schemas/CalendarEvent"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - events
        - pagination
    CalendarQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            from:
              type: string
              format: date-time
              description: ISO 8601 date-time string
              example: 2024-12-17T10:30:00Z
            to:
              type: string
              format: date-time
              description: ISO 8601 date-time string
              example: 2024-12-17T10:30:00Z
            matterId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            eventType:
              $ref: "#/components/schemas/CalendarEventType"
            status:
              $ref: "#/components/schemas/CalendarEventStatus"
          required:
            - from
            - to
    CreateCalendarEventRequest:
      type: object
      properties:
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
        eventType:
          $ref: "#/components/schemas/CalendarEventType"
        startAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        endAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        allDay:
          type: boolean
        location:
          type: string
        attendees:
          type: array
          items:
            nullable: true
        reminderMinutes:
          type: array
          items:
            type: integer
            minimum: 0
            maximum: 525600
        recurrence:
          type: object
          additionalProperties:
            nullable: true
      required:
        - title
        - eventType
        - startAt
    UpdateCalendarEventRequest:
      type: object
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
          nullable: true
        eventType:
          $ref: "#/components/schemas/CalendarEventType"
        status:
          $ref: "#/components/schemas/CalendarEventStatus"
        priority:
          $ref: "#/components/schemas/CalendarEventPriority"
        startAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        endAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        allDay:
          type: boolean
        location:
          type: string
          nullable: true
        attendees:
          type: array
          nullable: true
          items:
            nullable: true
        reminderMinutes:
          type: array
          nullable: true
          items:
            type: integer
        recurrence:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
    UpcomingCalendarQuery:
      type: object
      properties:
        days:
          type: integer
          minimum: 1
          maximum: 365
          default: 14
        limit:
          type: integer
          minimum: 1
          maximum: 200
          default: 50
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
    UpcomingEventsResponse:
      type: object
      properties:
        events:
          type: array
          items:
            $ref: "#/components/schemas/CalendarEvent"
      required:
        - events
    CalendarAISuggestRequest:
      type: object
      properties:
        text:
          type: string
          minLength: 1
          maxLength: 20000
      required:
        - text
    TemplateType:
      type: string
      enum:
        - document
        - email
    Template:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        firmId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        name:
          type: string
        type:
          $ref: "#/components/schemas/TemplateType"
        category:
          type: string
          nullable: true
        content:
          type: string
        mergeFields:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        isActive:
          type: boolean
        parentId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        version:
          type: integer
        createdById:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - firmId
        - name
        - type
        - category
        - content
        - mergeFields
        - isActive
        - parentId
        - version
        - createdById
        - createdAt
        - updatedAt
    TemplateListResponse:
      type: object
      properties:
        templates:
          type: array
          items:
            $ref: "#/components/schemas/Template"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - templates
        - pagination
    TemplateQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            type:
              $ref: "#/components/schemas/TemplateType"
            includeSystem:
              type: boolean
              nullable: true
              default: true
            activeOnly:
              type: boolean
              nullable: true
              default: true
    CreateTemplateRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 200
        type:
          $ref: "#/components/schemas/TemplateType"
        category:
          type: string
        content:
          type: string
          minLength: 1
        mergeFields:
          type: object
          additionalProperties:
            nullable: true
        isActive:
          type: boolean
      required:
        - name
        - type
        - content
    UpdateTemplateRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 200
        category:
          type: string
          nullable: true
        content:
          type: string
          minLength: 1
        mergeFields:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        isActive:
          type: boolean
    PreviewTemplateRequest:
      type: object
      properties:
        data:
          type: object
          additionalProperties:
            nullable: true
      required:
        - data
    TemplateRendered:
      type: object
      properties:
        content:
          type: string
        missing:
          type: array
          items:
            type: string
          default: []
      required:
        - content
    PreviewTemplateResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        rendered:
          $ref: "#/components/schemas/TemplateRendered"
      required:
        - success
        - rendered
    GenerateTemplateResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        rendered:
          $ref: "#/components/schemas/TemplateRendered"
      required:
        - success
        - rendered
    ProposeTemplateRequest:
      type: object
      properties:
        action:
          type: string
          enum:
            - template.create
            - template.update
        templateId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        draft:
          allOf:
            - $ref: "#/components/schemas/CreateTemplateRequest"
            - properties:
                name:
                  type: string
                  minLength: 1
                  maxLength: 200
                type:
                  $ref: "#/components/schemas/TemplateType"
                category:
                  type: string
                content:
                  type: string
                mergeFields:
                  type: object
                  additionalProperties:
                    nullable: true
                isActive:
                  type: boolean
      required:
        - action
        - draft
    LeadStatus:
      type: string
      enum:
        - new
        - contacted
        - qualified
        - won
        - lost
        - archived
    Lead:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        firstName:
          type: string
          nullable: true
        lastName:
          type: string
          nullable: true
        companyName:
          type: string
          nullable: true
        email:
          type: string
          nullable: true
          format: email
          description: Email address
          example: john.smith@example.com
        phone:
          type: string
          nullable: true
          description: Phone number in E.164 or UK format
          example: +44 20 7946 0958
        enquiryType:
          type: string
          nullable: true
          enum: *a5
          description: Legal practice area
          example: conveyancing
        message:
          type: string
          nullable: true
        source:
          type: string
          nullable: true
        status:
          $ref: "#/components/schemas/LeadStatus"
        score:
          type: integer
          nullable: true
        notes:
          type: string
          nullable: true
        assignedTo:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        convertedToClientId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdById:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - firstName
        - lastName
        - companyName
        - email
        - phone
        - enquiryType
        - message
        - source
        - status
        - score
        - notes
        - assignedTo
        - convertedToClientId
        - createdById
        - createdAt
        - updatedAt
    LeadListResponse:
      type: object
      properties:
        leads:
          type: array
          items:
            $ref: "#/components/schemas/Lead"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - leads
        - pagination
    LeadQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            status:
              $ref: "#/components/schemas/LeadStatus"
            search:
              type: string
    CreateLeadRequest:
      type: object
      properties:
        firstName:
          type: string
        lastName:
          type: string
        companyName:
          type: string
        email:
          type: string
          format: email
          description: Email address
          example: john.smith@example.com
        phone:
          type: string
          description: Phone number in E.164 or UK format
          example: +44 20 7946 0958
        enquiryType:
          type: string
          enum: *a5
          description: Legal practice area
          example: conveyancing
        message:
          type: string
        source:
          type: string
        score:
          type: integer
          minimum: 0
          maximum: 100
        notes:
          type: string
        assignedTo:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
    UpdateLeadRequest:
      type: object
      properties:
        firstName:
          type: string
        lastName:
          type: string
        companyName:
          type: string
        email:
          type: string
          format: email
          description: Email address
          example: john.smith@example.com
        phone:
          type: string
          description: Phone number in E.164 or UK format
          example: +44 20 7946 0958
        enquiryType:
          type: string
          enum: *a5
          description: Legal practice area
          example: conveyancing
        message:
          type: string
        source:
          type: string
        score:
          type: integer
          minimum: 0
          maximum: 100
        notes:
          type: string
        assignedTo:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        status:
          $ref: "#/components/schemas/LeadStatus"
    ConvertLeadRequest:
      type: object
      properties:
        clientType:
          type: string
          enum:
            - individual
            - company
          default: individual
        matterTitle:
          type: string
          minLength: 1
          maxLength: 200
        practiceArea:
          type: string
          enum: *a5
          default: other
          description: Legal practice area
          example: conveyancing
      required:
        - matterTitle
    ConvertLeadResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        clientId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - success
        - clientId
        - matterId
    QuoteStatus:
      type: string
      enum:
        - draft
        - sent
        - accepted
        - rejected
        - expired
        - converted
    Quote:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        leadId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        type:
          type: string
          enum: *a5
          description: Legal practice area
          example: conveyancing
        status:
          $ref: "#/components/schemas/QuoteStatus"
        items:
          type: array
          nullable: true
          items:
            nullable: true
        fees:
          type: array
          nullable: true
          items:
            type: object
            properties:
              description:
                type: string
              amount:
                type: number
            required:
              - description
              - amount
        disbursements:
          type: array
          nullable: true
          items:
            type: object
            properties:
              description:
                type: string
              amount:
                type: number
            required:
              - description
              - amount
        subtotal:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        vatAmount:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        total:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        validUntil:
          type: string
          nullable: true
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        notes:
          type: string
          nullable: true
        convertedToMatterId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdById:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - leadId
        - type
        - status
        - items
        - fees
        - disbursements
        - subtotal
        - vatAmount
        - total
        - validUntil
        - notes
        - convertedToMatterId
        - createdById
        - createdAt
        - updatedAt
    QuoteListResponse:
      type: object
      properties:
        quotes:
          type: array
          items:
            $ref: "#/components/schemas/Quote"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - quotes
        - pagination
    QuoteQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            leadId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            status:
              $ref: "#/components/schemas/QuoteStatus"
    CreateQuoteRequest:
      type: object
      properties:
        leadId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        type:
          type: string
          enum: *a5
          description: Legal practice area
          example: conveyancing
        items:
          type: array
          items:
            nullable: true
        fees:
          type: array
          items:
            type: object
            properties:
              description:
                type: string
              amount:
                type: number
            required:
              - description
              - amount
        disbursements:
          type: array
          items:
            type: object
            properties:
              description:
                type: string
              amount:
                type: number
            required:
              - description
              - amount
        subtotal:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        vatAmount:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        total:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        validUntil:
          type: string
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        notes:
          type: string
      required:
        - leadId
        - total
    UpdateQuoteRequest:
      type: object
      properties:
        type:
          type: string
          enum: *a5
          description: Legal practice area
          example: conveyancing
        status:
          $ref: "#/components/schemas/QuoteStatus"
        items:
          type: array
          nullable: true
          items:
            nullable: true
        fees:
          type: array
          nullable: true
          items:
            type: object
            properties:
              description:
                type: string
              amount:
                type: number
            required:
              - description
              - amount
        disbursements:
          type: array
          nullable: true
          items:
            type: object
            properties:
              description:
                type: string
              amount:
                type: number
            required:
              - description
              - amount
        subtotal:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        vatAmount:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        total:
          type: string
          pattern: ^\d+\.\d{2}$
          description: Monetary amount with 2 decimal places
          example: "1250.00"
        validUntil:
          type: string
          nullable: true
          format: date
          description: ISO 8601 date string
          example: 2024-12-17
        notes:
          type: string
          nullable: true
    ConflictCheckStatus:
      type: string
      enum:
        - pending
        - clear
        - conflict
        - waived
    ConflictCheck:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        searchTerms:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        results:
          type: object
          nullable: true
          additionalProperties:
            nullable: true
        status:
          $ref: "#/components/schemas/ConflictCheckStatus"
        decidedBy:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        decidedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        decisionReason:
          type: string
          nullable: true
        waiverReason:
          type: string
          nullable: true
        createdById:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - matterId
        - searchTerms
        - results
        - status
        - decidedBy
        - decidedAt
        - decisionReason
        - waiverReason
        - createdById
        - createdAt
        - updatedAt
    ConflictSearchRequest:
      type: object
      properties:
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        search:
          type: string
          minLength: 1
          maxLength: 200
      required:
        - matterId
        - search
    ConflictSearchResponse:
      type: object
      properties:
        success:
          type: boolean
          enum:
            - true
        conflictCheck:
          $ref: "#/components/schemas/ConflictCheck"
        matches:
          type: array
          items:
            type: object
            additionalProperties:
              nullable: true
          default: []
      required:
        - success
        - conflictCheck
    ConflictDecisionRequest:
      type: object
      properties:
        decisionReason:
          type: string
        waiverReason:
          type: string
    EmailProvider:
      type: string
      enum:
        - google
        - microsoft
    IntegrationConnectionStatus:
      type: string
      enum:
        - connected
        - revoked
        - error
    EmailAccount:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        provider:
          $ref: "#/components/schemas/EmailProvider"
        emailAddress:
          type: string
        externalAccountId:
          type: string
          nullable: true
        status:
          $ref: "#/components/schemas/IntegrationConnectionStatus"
        lastSyncAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - provider
        - emailAddress
        - externalAccountId
        - status
        - lastSyncAt
        - createdAt
        - updatedAt
    EmailAccountListResponse:
      type: object
      properties:
        accounts:
          type: array
          items:
            $ref: "#/components/schemas/EmailAccount"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - accounts
        - pagination
    EmailAccountQuery:
      type: object
      properties:
        page:
          type: integer
          minimum: 1
          default: 1
          description: Page number (1-indexed)
          example: 1
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          description: Items per page (max 100)
          example: 20
    CreateEmailAccountRequest:
      type: object
      properties:
        provider:
          $ref: "#/components/schemas/EmailProvider"
        emailAddress:
          type: string
        externalAccountId:
          type: string
        scopes:
          type: array
          items:
            type: string
        tokens:
          type: object
          additionalProperties:
            nullable: true
      required:
        - provider
        - emailAddress
    EmailAccountWithSecret:
      allOf:
        - $ref: "#/components/schemas/EmailAccount"
        - type: object
          properties:
            webhookSecret:
              type: string
          required:
            - webhookSecret
    EmailAccountCreateResponse:
      allOf:
        - $ref: "#/components/schemas/EmailAccountWithSecret"
        - type: object
          properties:
            webhookPath:
              type: string
          required:
            - webhookPath
    CalendarProvider:
      type: string
      enum:
        - google
        - microsoft
    SyncDirection:
      type: string
      enum:
        - push
        - pull
        - both
    CalendarAccount:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        provider:
          $ref: "#/components/schemas/CalendarProvider"
        externalAccountId:
          type: string
          nullable: true
        status:
          $ref: "#/components/schemas/IntegrationConnectionStatus"
        syncDirection:
          $ref: "#/components/schemas/SyncDirection"
        lastSyncAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - provider
        - externalAccountId
        - status
        - syncDirection
        - lastSyncAt
        - createdAt
        - updatedAt
    CalendarAccountListResponse:
      type: object
      properties:
        accounts:
          type: array
          items:
            $ref: "#/components/schemas/CalendarAccount"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - accounts
        - pagination
    CalendarAccountQuery:
      type: object
      properties:
        page:
          type: integer
          minimum: 1
          default: 1
          description: Page number (1-indexed)
          example: 1
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          description: Items per page (max 100)
          example: 20
    CreateCalendarAccountRequest:
      type: object
      properties:
        provider:
          $ref: "#/components/schemas/CalendarProvider"
        externalAccountId:
          type: string
        scopes:
          type: array
          items:
            type: string
        tokens:
          type: object
          additionalProperties:
            nullable: true
        syncDirection:
          $ref: "#/components/schemas/SyncDirection"
      required:
        - provider
    CalendarAccountWithSecret:
      allOf:
        - $ref: "#/components/schemas/CalendarAccount"
        - type: object
          properties:
            webhookSecret:
              type: string
          required:
            - webhookSecret
    CalendarAccountCreateResponse:
      allOf:
        - $ref: "#/components/schemas/CalendarAccountWithSecret"
        - type: object
          properties:
            webhookPath:
              type: string
          required:
            - webhookPath
    PaymentProvider:
      type: string
      enum:
        - stripe
        - gocardless
    PaymentProviderAccount:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        provider:
          $ref: "#/components/schemas/PaymentProvider"
        externalAccountId:
          type: string
          nullable: true
        status:
          $ref: "#/components/schemas/IntegrationConnectionStatus"
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - provider
        - externalAccountId
        - status
        - createdAt
        - updatedAt
    PaymentProviderAccountListResponse:
      type: object
      properties:
        accounts:
          type: array
          items:
            $ref: "#/components/schemas/PaymentProviderAccount"
      required:
        - accounts
    CreatePaymentProviderAccountRequest:
      type: object
      properties:
        provider:
          $ref: "#/components/schemas/PaymentProvider"
        externalAccountId:
          type: string
        webhookSecret:
          type: string
        config:
          type: object
          additionalProperties:
            nullable: true
      required:
        - provider
    PaymentProviderAccountWithSecret:
      allOf:
        - $ref: "#/components/schemas/PaymentProviderAccount"
        - type: object
          properties:
            webhookSecret:
              type: string
          required:
            - webhookSecret
    PaymentProviderAccountCreateResponse:
      allOf:
        - $ref: "#/components/schemas/PaymentProviderAccountWithSecret"
        - type: object
          properties:
            webhookPath:
              type: string
          required:
            - webhookPath
    AccountingProvider:
      type: string
      enum:
        - xero
        - quickbooks
    AccountingConnection:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        provider:
          $ref: "#/components/schemas/AccountingProvider"
        externalTenantId:
          type: string
          nullable: true
        status:
          $ref: "#/components/schemas/IntegrationConnectionStatus"
        lastSyncAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - provider
        - externalTenantId
        - status
        - lastSyncAt
        - createdAt
        - updatedAt
    AccountingConnectionListResponse:
      type: object
      properties:
        connections:
          type: array
          items:
            $ref: "#/components/schemas/AccountingConnection"
      required:
        - connections
    CreateAccountingConnectionRequest:
      type: object
      properties:
        provider:
          $ref: "#/components/schemas/AccountingProvider"
        externalTenantId:
          type: string
        tokens:
          type: object
          additionalProperties:
            nullable: true
      required:
        - provider
    AccountingConnectionWithSecret:
      allOf:
        - $ref: "#/components/schemas/AccountingConnection"
        - type: object
          properties:
            webhookSecret:
              type: string
          required:
            - webhookSecret
    AccountingConnectionCreateResponse:
      allOf:
        - $ref: "#/components/schemas/AccountingConnectionWithSecret"
        - type: object
          properties:
            webhookPath:
              type: string
          required:
            - webhookPath
    EsignatureProvider:
      type: string
      enum:
        - docusign
        - adobe_sign
    SignatureRequestStatus:
      type: string
      enum:
        - draft
        - pending_approval
        - sent
        - delivered
        - completed
        - declined
        - voided
        - failed
    SignatureRequest:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        documentId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        provider:
          $ref: "#/components/schemas/EsignatureProvider"
        externalId:
          type: string
          nullable: true
        status:
          $ref: "#/components/schemas/SignatureRequestStatus"
        signers:
          type: array
          nullable: true
          items:
            type: object
            additionalProperties:
              nullable: true
        sentAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        completedAt:
          type: string
          nullable: true
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        signedDocumentId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        createdAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
        updatedAt:
          type: string
          format: date-time
          description: ISO 8601 date-time string
          example: 2024-12-17T10:30:00Z
      required:
        - id
        - documentId
        - provider
        - externalId
        - status
        - signers
        - sentAt
        - completedAt
        - signedDocumentId
        - createdAt
        - updatedAt
    SignatureRequestListResponse:
      type: object
      properties:
        requests:
          type: array
          items:
            $ref: "#/components/schemas/SignatureRequest"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
      required:
        - requests
        - pagination
    SignatureRequestQuery:
      allOf:
        - $ref: "#/components/schemas/Pagination"
        - type: object
          properties:
            documentId:
              type: string
              format: uuid
              description: Unique identifier in UUID v4 format
              example: 123e4567-e89b-12d3-a456-426614174000
            status:
              $ref: "#/components/schemas/SignatureRequestStatus"
    CreateSignatureRequestRequest:
      type: object
      properties:
        documentId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        provider:
          $ref: "#/components/schemas/EsignatureProvider"
        signers:
          type: array
          items:
            type: object
            additionalProperties:
              nullable: true
      required:
        - documentId
        - provider
        - signers
    CreateSignatureRequestResponse:
      type: object
      properties:
        signatureRequest:
          $ref: "#/components/schemas/SignatureRequest"
        approvalRequestId:
          type: string
          nullable: true
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - signatureRequest
        - approvalRequestId
    SemanticSearchRequest:
      type: object
      properties:
        query:
          type: string
          minLength: 1
        limit:
          type: integer
          minimum: 1
          maximum: 50
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - query
    SemanticSearchResult:
      type: object
      properties:
        documentId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        documentChunkId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
        score:
          type: number
        text:
          type: string
      required:
        - documentId
        - documentChunkId
        - score
        - text
    SemanticSearchResponse:
      type: object
      properties:
        results:
          type: array
          items:
            $ref: "#/components/schemas/SemanticSearchResult"
      required:
        - results
    MatterSemanticSearchQuery:
      type: object
      properties:
        q:
          type: string
          minLength: 1
        limit:
          type: integer
          minimum: 1
          maximum: 50
      required:
        - q
    ApprovalIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    ApprovalApproveIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    ApprovalRejectIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    ClientIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    ClientUpdateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    ClientDeleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    MatterIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    MatterUpdateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    MatterDeleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    DocumentIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    DocumentChunkIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    DocumentExtractIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    DocumentSummarizeIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    DocumentEntitiesIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    DocumentDownloadIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    AskMatterIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    RoleIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    RoleDeleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    UserRoleAssignIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TimelineMatterIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TimelineMatterIdParamPost:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    NotificationIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TaskIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TaskUpdateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TaskCompleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    GenerateTasksMatterIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    EmailIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    EmailUpdateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    EmailAIProcessIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    EmailAttachmentsIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    EmailAttachmentsResponse:
      type: object
      properties:
        attachments:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                format: uuid
              filename:
                type: string
              mimeType:
                type: string
              size:
                type: number
              url:
                type: string
                format: uri
            required:
              - id
              - filename
              - mimeType
              - size
              - url
      required:
        - attachments
    EmailSendIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TimeEntryIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TimeEntryUpdateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TimeEntryDeleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TimeEntrySubmitIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    InvoiceIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    InvoiceUpdateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    InvoiceSendIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    InvoiceVoidIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    InvoicePayLinkIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    PaymentLinkResponse:
      type: object
      properties:
        paymentUrl:
          type: string
          format: uri
        token:
          type: string
        expiresAt:
          type: string
      required:
        - paymentUrl
        - token
        - expiresAt
    PaymentIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    PaymentDeleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    CalendarEventIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    CalendarEventUpdateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    CalendarEventDeleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    SuggestCalendarMatterIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TemplateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TemplateUpdateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TemplatePreviewIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    TemplateGenerateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    LeadIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    LeadUpdateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    LeadConvertIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    QuoteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    QuoteUpdateIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    ConflictMatterIdParam:
      type: object
      properties:
        matterId:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - matterId
    ConflictClearIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    ConflictWaiveIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    EmailAccountIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    EmailAccountDeleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    EmailAccountHealthIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    EmailAccountHealthResponse:
      type: object
      properties:
        status:
          type: string
        lastSyncAt:
          type: string
          nullable: true
        webhookActive:
          type: boolean
      required:
        - status
        - lastSyncAt
        - webhookActive
    EmailAccountReconnectIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    ReconnectAccountRequest:
      type: object
      properties:
        tokens:
          type: object
          additionalProperties:
            nullable: true
      required:
        - tokens
    ReconnectAccountResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        status:
          type: string
        updatedAt:
          type: string
      required:
        - id
        - status
        - updatedAt
    CalendarAccountIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    CalendarAccountDeleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    CalendarAccountHealthIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    CalendarAccountHealthResponse:
      type: object
      properties:
        status:
          type: string
        lastSyncAt:
          type: string
          nullable: true
        webhookActive:
          type: boolean
      required:
        - status
        - lastSyncAt
        - webhookActive
    CalendarAccountReconnectIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    PaymentProviderAccountIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    PaymentProviderAccountDeleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    PaymentProviderAccountHealthIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    PaymentProviderAccountReconnectIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    AccountingConnectionIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    AccountingConnectionDeleteIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    AccountingConnectionHealthIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    AccountingConnectionReconnectIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    EmailWebhookParams:
      type: object
      properties:
        firmId:
          type: string
          format: uuid
        accountId:
          type: string
          format: uuid
      required:
        - firmId
        - accountId
    WebhookHeaders:
      type: object
      properties:
        x-webhook-secret:
          type: string
        x-event-id:
          type: string
      required:
        - x-webhook-secret
    CalendarWebhookParams:
      type: object
      properties:
        firmId:
          type: string
          format: uuid
        accountId:
          type: string
          format: uuid
      required:
        - firmId
        - accountId
    PaymentWebhookParams:
      type: object
      properties:
        firmId:
          type: string
          format: uuid
        accountId:
          type: string
          format: uuid
      required:
        - firmId
        - accountId
    AccountingWebhookParams:
      type: object
      properties:
        firmId:
          type: string
          format: uuid
        connectionId:
          type: string
          format: uuid
      required:
        - firmId
        - connectionId
    EsignatureWebhookParams:
      type: object
      properties:
        firmId:
          type: string
          format: uuid
        requestId:
          type: string
          format: uuid
      required:
        - firmId
        - requestId
    SignatureRequestIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    SignatureRequestSendIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    SignatureRequestRemindIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    SignatureRequestVoidIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    VoidSignatureRequestRequest:
      type: object
      properties:
        reason:
          type: string
          minLength: 1
          maxLength: 500
      required:
        - reason
    MatterSearchIdParam:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier in UUID v4 format
          example: 123e4567-e89b-12d3-a456-426614174000
      required:
        - id
    FileUploadRequest:
      type: object
      properties:
        file:
          type: string
          format: binary
        firmId:
          type: string
          format: uuid
        description:
          type: string
        tags:
          type: string
      required:
        - firmId
    FileUploadResponse:
      type: object
      properties:
        success:
          type: boolean
        upload:
          type: object
          properties:
            id:
              type: string
              format: uuid
            url:
              type: string
              format: uri
            filename:
              type: string
            originalName:
              type: string
            size:
              type: number
            mimeType:
              type: string
            metadata:
              type: object
              additionalProperties:
                nullable: true
          required:
            - id
            - url
            - filename
            - originalName
            - size
            - mimeType
      required:
        - success
        - upload
    HealthCheckResponse:
      type: object
      properties:
        status:
          type: string
          enum:
            - healthy
            - degraded
        timestamp:
          type: string
        services:
          type: object
          properties:
            postgres:
              type: boolean
            redis:
              type: boolean
            minio:
              type: boolean
            app:
              type: boolean
          required:
            - postgres
            - redis
            - minio
            - app
        details:
          type: object
          additionalProperties:
            type: string
      required:
        - status
        - timestamp
        - services
        - details
    HealthCheckDegradedResponse:
      type: object
      properties:
        status:
          type: string
          enum:
            - healthy
            - degraded
        timestamp:
          type: string
        services:
          type: object
          properties:
            postgres:
              type: boolean
            redis:
              type: boolean
            minio:
              type: boolean
            app:
              type: boolean
          required:
            - postgres
            - redis
            - minio
            - app
        details:
          type: object
          additionalProperties:
            type: string
      required:
        - status
        - timestamp
        - services
        - details
    ChatRequest:
      type: object
      properties:
        message:
          type: string
          minLength: 1
          maxLength: 5000
        model:
          type: string
      required:
        - message
    CreateJobRequest:
      type: object
      properties:
        type:
          type: string
          enum:
            - email
            - generic
        data:
          type: object
          additionalProperties:
            nullable: true
      required:
        - type
        - data
    CreateJobResponse:
      type: object
      properties:
        success:
          type: boolean
        job:
          type: object
          properties:
            id:
              type: string
            name:
              type: string
            data:
              type: object
              additionalProperties:
                nullable: true
          required:
            - id
            - name
            - data
      required:
        - success
        - job
  parameters: {}
paths:
  /api/approvals:
    get:
      summary: List approval requests
      description: Retrieve a paginated list of approval requests
      tags:
        - Approvals
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            enum: *a1
            description: Approval decision status
            example: pending
          required: false
          name: status
          in: query
        - schema:
            type: string
          required: false
          name: action
          in: query
        - schema:
            type: string
          required: false
          name: entityType
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: entityId
          in: query
      responses:
        "200":
          description: List of approval requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/approvals/{id}:
    get:
      summary: Get approval request
      description: Retrieve a single approval request by ID
      tags:
        - Approvals
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Approval request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/approvals/{id}/approve:
    post:
      summary: Approve request
      description: Approve an approval request
      tags:
        - Approvals
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApproveRequest"
      responses:
        "200":
          description: Updated approval request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/approvals/{id}/reject:
    post:
      summary: Reject request
      description: Reject an approval request
      tags:
        - Approvals
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApproveRequest"
      responses:
        "200":
          description: Updated approval request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/approvals/bulk/approve:
    post:
      summary: Bulk approve
      description: Bulk approve multiple approval requests
      tags:
        - Approvals
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkApproveRequest"
      responses:
        "200":
          description: Updated approval requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BulkApproveResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/approvals/bulk/reject:
    post:
      summary: Bulk reject
      description: Bulk reject multiple approval requests
      tags:
        - Approvals
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkApproveRequest"
      responses:
        "200":
          description: Updated approval requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BulkApproveResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/clients:
    get:
      summary: List clients
      description: Retrieve a paginated list of clients
      tags:
        - Clients
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            enum: *a4
            description: Current status in client lifecycle
            example: active
          required: false
          name: status
          in: query
        - schema:
            type: string
            enum: *a2
            description: Type of client entity
            example: individual
          required: false
          name: type
          in: query
        - schema:
            type: string
            description: Search by name, company name, or reference
          required: false
          name: search
          in: query
      responses:
        "200":
          description: List of clients
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClientListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create client
      description: Create a new client record
      tags:
        - Clients
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateClientRequest"
      responses:
        "201":
          description: Client created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Client"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/clients/{id}:
    get:
      summary: Get client
      description: Retrieve a single client by ID
      tags:
        - Clients
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Client details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Client"
        "404":
          description: Client not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update client
      description: Update a client's details
      tags:
        - Clients
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateClientRequest"
      responses:
        "200":
          description: Client updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Client"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Client not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Archive client
      description: Archive a client (soft delete)
      tags:
        - Clients
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Client archived
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "404":
          description: Client not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/matters:
    get:
      summary: List matters
      description: Retrieve a paginated list of matters
      tags:
        - Matters
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            enum: *a7
            description: Current status in matter lifecycle
            example: active
          required: false
          name: status
          in: query
        - schema:
            type: string
            enum: *a5
            description: Legal practice area
            example: conveyancing
          required: false
          name: practiceArea
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: clientId
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: feeEarnerId
          in: query
        - schema:
            type: string
            description: Search by reference or title
          required: false
          name: search
          in: query
      responses:
        "200":
          description: List of matters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MatterListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create matter
      description: Create a new matter/case
      tags:
        - Matters
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateMatterRequest"
      responses:
        "201":
          description: Matter created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Matter"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/matters/{id}:
    get:
      summary: Get matter
      description: Retrieve a single matter by ID
      tags:
        - Matters
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Matter details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Matter"
        "404":
          description: Matter not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update matter
      description: Update a matter's details
      tags:
        - Matters
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateMatterRequest"
      responses:
        "200":
          description: Matter updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Matter"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Matter not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Archive matter
      description: Archive a matter (soft delete)
      tags:
        - Matters
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Matter archived
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "404":
          description: Matter not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/documents:
    get:
      summary: List documents
      description: Retrieve documents, optionally filtered by matterId
      tags:
        - Documents
      responses:
        "200":
          description: List of documents
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DocumentListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create document
      description: Create a new document record for a matter
      tags:
        - Documents
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateDocumentRequest"
      responses:
        "201":
          description: Document created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Document"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/documents/{id}/chunks:
    get:
      summary: List document chunks
      description: Retrieve chunks for a document
      tags:
        - Documents
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Document chunks
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DocumentChunkListResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Generate document chunks
      description: Chunk the document's extracted text for retrieval and citations
      tags:
        - Documents
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChunkDocumentRequest"
      responses:
        "200":
          description: Chunking result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChunkDocumentResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/documents/{id}/extract:
    post:
      summary: Extract document text
      description: Extract text from the stored upload and persist on the document
      tags:
        - Documents
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExtractDocumentRequest"
      responses:
        "200":
          description: Extraction result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExtractDocumentResponse"
        "202":
          description: Job accepted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DocumentJobAcceptedResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/documents/{id}/summarize:
    post:
      summary: Summarize document
      description: Generate and persist an AI summary for a document
      tags:
        - Documents
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Summarization result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SummarizeDocumentResponse"
        "202":
          description: Job accepted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DocumentJobAcceptedResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/documents/{id}/entities:
    post:
      summary: Extract document entities
      description: Extract and persist structured entities on the document metadata
      tags:
        - Documents
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Entities result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DocumentEntitiesResponse"
        "202":
          description: Job accepted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DocumentJobAcceptedResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/documents/{id}/download:
    get:
      summary: Download document file
      description: Download the original document file from storage
      tags:
        - Documents
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: File download
          content:
            application/octet-stream:
              schema:
                type: object
                properties:
                  file:
                    type: string
                    format: binary
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/matters/{id}/ai/ask:
    post:
      summary: Ask matter with citations
      description: Ask a question about a matter; response includes citations to
        document chunks
      tags:
        - Matters
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AskMatterRequest"
      responses:
        "200":
          description: Answer with citations
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AskMatterResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/firm/settings:
    get:
      summary: Get firm settings
      description: Retrieve settings for the authenticated user's firm
      tags:
        - Firms
      responses:
        "200":
          description: Firm settings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FirmSettingsResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update firm settings
      description: Patch settings for the authenticated user's firm
      tags:
        - Firms
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateFirmSettingsRequest"
      responses:
        "200":
          description: Updated firm settings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FirmSettingsResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/roles:
    get:
      summary: List roles
      description: Retrieve firm roles (RBAC)
      tags:
        - Roles
      responses:
        "200":
          description: Roles
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RoleListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create role
      description: Create a custom role for the firm
      tags:
        - Roles
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateRoleRequest"
      responses:
        "201":
          description: Role created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Role"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/roles/{id}:
    patch:
      summary: Update role
      description: Update a custom role for the firm
      tags:
        - Roles
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateRoleRequest"
      responses:
        "200":
          description: Role updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Role"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Delete role
      description: Delete a custom role for the firm
      tags:
        - Roles
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/users/{id}/role:
    patch:
      summary: Assign role
      description: Assign a role to a user within the firm
      tags:
        - Users
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AssignRoleRequest"
      responses:
        "200":
          description: Role assigned
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AssignRoleResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/matters/{id}/timeline:
    get:
      summary: List timeline events
      description: Retrieve timeline events for a matter
      tags:
        - Timeline
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            $ref: "#/components/schemas/TimelineEventType"
          required: false
          name: type
          in: query
        - schema:
            type: string
          required: false
          name: entityType
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: entityId
          in: query
        - schema:
            type: string
            format: date-time
            description: ISO 8601 date-time string
            example: 2024-12-17T10:30:00Z
          required: false
          name: from
          in: query
        - schema:
            type: string
            format: date-time
            description: ISO 8601 date-time string
            example: 2024-12-17T10:30:00Z
          required: false
          name: to
          in: query
      responses:
        "200":
          description: Timeline events
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimelineListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create timeline event
      description: Create a manual timeline event for a matter
      tags:
        - Timeline
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateTimelineEventRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimelineEvent"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/notifications:
    get:
      summary: List notifications
      description: List notifications for the authenticated user
      tags:
        - Notifications
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            type: boolean
          required: false
          name: read
          in: query
        - schema:
            $ref: "#/components/schemas/NotificationType"
          required: false
          name: type
          in: query
      responses:
        "200":
          description: Notifications
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/notifications/{id}/read:
    post:
      summary: Mark notification read
      description: Mark a single notification as read
      tags:
        - Notifications
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Marked read
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/notifications/read-all:
    post:
      summary: Mark all notifications read
      description: Mark all notifications as read for the authenticated user
      tags:
        - Notifications
      responses:
        "200":
          description: Marked read
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
  /api/notifications/preferences:
    get:
      summary: Get notification preferences
      description: Retrieve notification preferences for the authenticated user
      tags:
        - Notifications
      responses:
        "200":
          description: Preferences
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationPreferencesResponse"
    patch:
      summary: Update notification preferences
      description: Patch notification preferences for the authenticated user
      tags:
        - Notifications
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateNotificationPreferencesRequest"
      responses:
        "200":
          description: Updated preferences
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationPreferencesResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/tasks:
    get:
      summary: List tasks
      description: Retrieve firm tasks with filters
      tags:
        - Tasks
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: matterId
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: assigneeId
          in: query
        - schema:
            $ref: "#/components/schemas/TaskStatus"
          required: false
          name: status
          in: query
        - schema:
            $ref: "#/components/schemas/TaskPriority"
          required: false
          name: priority
          in: query
      responses:
        "200":
          description: Tasks
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TaskListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create task
      description: Create a new task for a matter
      tags:
        - Tasks
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateTaskRequest"
      responses:
        "201":
          description: Task created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Task"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/tasks/{id}:
    get:
      summary: Get task
      description: Retrieve a task by ID
      tags:
        - Tasks
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Task
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Task"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update task
      description: Update a task by ID
      tags:
        - Tasks
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateTaskRequest"
      responses:
        "200":
          description: Task updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Task"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/tasks/{id}/complete:
    post:
      summary: Complete task
      description: Mark a task complete
      tags:
        - Tasks
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Task completed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Task"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/matters/{id}/ai/generate-tasks:
    post:
      summary: Generate tasks (approval required)
      description: Generate AI-proposed tasks for a matter; returns an approval request
      tags:
        - Matters
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GenerateTasksRequest"
      responses:
        "201":
          description: Approval request created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/emails:
    get:
      summary: List emails
      description: Retrieve firm emails with filters
      tags:
        - Emails
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: matterId
          in: query
        - schema:
            $ref: "#/components/schemas/EmailDirection"
          required: false
          name: direction
          in: query
        - schema:
            $ref: "#/components/schemas/EmailStatus"
          required: false
          name: status
          in: query
        - schema:
            type: boolean
          required: false
          name: aiProcessed
          in: query
        - schema:
            type: string
          required: false
          name: search
          in: query
      responses:
        "200":
          description: Emails
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create email
      description: Create an email record
      tags:
        - Emails
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateEmailRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Email"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/emails/{id}:
    get:
      summary: Get email
      description: Retrieve a single email by ID
      tags:
        - Emails
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Email
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Email"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update email
      description: Update an email record
      tags:
        - Emails
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateEmailRequest"
      responses:
        "200":
          description: Updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Email"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/emails/{id}/ai/process:
    post:
      summary: AI process email
      description: Analyze an email for intent/sentiment/urgency and propose matter matching
      tags:
        - Emails
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: AI processing result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailAIProcessResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/emails/{id}/attachments:
    get:
      summary: Get email attachments
      description: List all attachments for an email
      tags:
        - Emails
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: List of attachments
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailAttachmentsResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/emails/{id}/send:
    post:
      summary: Send email (approval required)
      description: Create approval request to send email
      tags:
        - Emails
        - Approvals
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "201":
          description: Approval request created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/time-entries:
    get:
      summary: List time entries
      description: Retrieve firm time entries with filters
      tags:
        - Time Entries
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: matterId
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: feeEarnerId
          in: query
        - schema:
            $ref: "#/components/schemas/TimeEntryStatus"
          required: false
          name: status
          in: query
        - schema:
            type: string
            format: date
            description: ISO 8601 date string
            example: 2024-12-17
          required: false
          name: from
          in: query
        - schema:
            type: string
            format: date
            description: ISO 8601 date string
            example: 2024-12-17
          required: false
          name: to
          in: query
      responses:
        "200":
          description: Time entries
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimeEntryListResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create time entry
      description: Create a draft time entry
      tags:
        - Time Entries
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateTimeEntryRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimeEntry"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/time-entries/{id}:
    get:
      summary: Get time entry
      description: Retrieve a single time entry
      tags:
        - Time Entries
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Time entry
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimeEntry"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update time entry
      description: Update a draft time entry
      tags:
        - Time Entries
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateTimeEntryRequest"
      responses:
        "200":
          description: Updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimeEntry"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Delete time entry
      description: Delete a draft time entry
      tags:
        - Time Entries
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/time-entries/{id}/submit:
    post:
      summary: Submit time entry
      description: Submit a draft time entry for approval (creates an approval request)
      tags:
        - Time Entries
        - Approvals
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "201":
          description: Approval request created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/time-entries/bulk/submit:
    post:
      summary: Bulk submit time entries
      description: Bulk submit draft time entries for approval
      tags:
        - Time Entries
        - Approvals
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkSubmitTimeEntriesRequest"
      responses:
        "201":
          description: Submitted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BulkSubmitTimeEntriesResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/invoices:
    get:
      summary: List invoices
      description: Retrieve firm invoices with filters
      tags:
        - Invoices
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: clientId
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: matterId
          in: query
        - schema:
            $ref: "#/components/schemas/InvoiceStatus"
          required: false
          name: status
          in: query
      responses:
        "200":
          description: Invoices
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvoiceListResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/invoices/generate:
    post:
      summary: Generate invoice
      description: Generate an invoice from approved time entries
      tags:
        - Invoices
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GenerateInvoiceRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Invoice"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/invoices/{id}:
    get:
      summary: Get invoice
      description: Retrieve invoice details including line items
      tags:
        - Invoices
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Invoice details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvoiceWithItemsResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update invoice
      description: Update draft invoice fields
      tags:
        - Invoices
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateInvoiceRequest"
      responses:
        "200":
          description: Updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Invoice"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/invoices/{id}/send:
    post:
      summary: Send invoice (approval required)
      description: Create an approval request to send an invoice
      tags:
        - Invoices
        - Approvals
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "201":
          description: Approval request created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/invoices/{id}/void:
    post:
      summary: Void invoice
      description: Void a draft invoice (marks written off)
      tags:
        - Invoices
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Invoice"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/invoices/{id}/pay-link:
    post:
      summary: Generate payment link
      description: Generate a secure payment link for an invoice
      tags:
        - Invoices
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "201":
          description: Payment link generated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentLinkResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/payments:
    get:
      summary: List payments
      description: Retrieve firm payments with filters
      tags:
        - Payments
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: invoiceId
          in: query
        - schema:
            $ref: "#/components/schemas/PaymentMethod"
          required: false
          name: method
          in: query
        - schema:
            type: string
            format: date
            description: ISO 8601 date string
            example: 2024-12-17
          required: false
          name: from
          in: query
        - schema:
            type: string
            format: date
            description: ISO 8601 date string
            example: 2024-12-17
          required: false
          name: to
          in: query
      responses:
        "200":
          description: Payments
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentListResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Record payment
      description: Record a payment against an invoice
      tags:
        - Payments
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePaymentRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Payment"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/payments/{id}:
    get:
      summary: Get payment
      description: Retrieve a payment record
      tags:
        - Payments
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Payment
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Payment"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Delete payment
      description: Delete a payment and recalculate invoice totals
      tags:
        - Payments
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/calendar:
    get:
      summary: List calendar events
      description: List calendar events in a date range
      tags:
        - Calendar
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            format: date-time
            description: ISO 8601 date-time string
            example: 2024-12-17T10:30:00Z
          required: true
          name: from
          in: query
        - schema:
            type: string
            format: date-time
            description: ISO 8601 date-time string
            example: 2024-12-17T10:30:00Z
          required: true
          name: to
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: matterId
          in: query
        - schema:
            $ref: "#/components/schemas/CalendarEventType"
          required: false
          name: eventType
          in: query
        - schema:
            $ref: "#/components/schemas/CalendarEventStatus"
          required: false
          name: status
          in: query
      responses:
        "200":
          description: Events
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CalendarListResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create calendar event
      description: Create a calendar event (human-created)
      tags:
        - Calendar
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateCalendarEventRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CalendarEvent"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/calendar/{id}:
    get:
      summary: Get calendar event
      description: Retrieve a calendar event
      tags:
        - Calendar
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Event
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CalendarEvent"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update calendar event
      description: Update a calendar event
      tags:
        - Calendar
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateCalendarEventRequest"
      responses:
        "200":
          description: Updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CalendarEvent"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Delete calendar event
      description: Delete a calendar event
      tags:
        - Calendar
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/calendar/upcoming:
    get:
      summary: Upcoming calendar events
      description: Convenience endpoint for upcoming events
      tags:
        - Calendar
      parameters:
        - schema:
            type: integer
            minimum: 1
            maximum: 365
            default: 14
          required: false
          name: days
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 50
          required: false
          name: limit
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: matterId
          in: query
      responses:
        "200":
          description: Upcoming events
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UpcomingEventsResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/matters/{id}/ai/suggest-calendar:
    post:
      summary: Suggest calendar events (approval required)
      description: Generate AI-proposed calendar events for a matter; returns an
        approval request
      tags:
        - Matters
        - Calendar
        - Approvals
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CalendarAISuggestRequest"
      responses:
        "201":
          description: Approval request created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/templates:
    get:
      summary: List templates
      description: List templates (firm + optionally system)
      tags:
        - Templates
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            $ref: "#/components/schemas/TemplateType"
          required: false
          name: type
          in: query
        - schema:
            type: boolean
            nullable: true
            default: true
          required: false
          name: includeSystem
          in: query
        - schema:
            type: boolean
            nullable: true
            default: true
          required: false
          name: activeOnly
          in: query
      responses:
        "200":
          description: Templates
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TemplateListResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create template
      description: Create a firm template
      tags:
        - Templates
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateTemplateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Template"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/templates/{id}:
    get:
      summary: Get template
      description: Retrieve a template by id
      tags:
        - Templates
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Template
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Template"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update template
      description: Update a firm template (creates a new version)
      tags:
        - Templates
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateTemplateRequest"
      responses:
        "200":
          description: Updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Template"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/templates/{id}/preview:
    post:
      summary: Preview template
      description: Render a template with provided data
      tags:
        - Templates
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PreviewTemplateRequest"
      responses:
        "200":
          description: Rendered
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PreviewTemplateResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/templates/{id}/generate:
    post:
      summary: Generate from template
      description: Render a template (MVP returns rendered content)
      tags:
        - Templates
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PreviewTemplateRequest"
      responses:
        "200":
          description: Rendered
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GenerateTemplateResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/templates/propose:
    post:
      summary: Propose template (approval required)
      description: Create an approval request for an AI-proposed template create/update
      tags:
        - Templates
        - Approvals
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ProposeTemplateRequest"
      responses:
        "201":
          description: Approval request created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/leads:
    get:
      summary: List leads
      description: List firm leads
      tags:
        - Intake
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            $ref: "#/components/schemas/LeadStatus"
          required: false
          name: status
          in: query
        - schema:
            type: string
          required: false
          name: search
          in: query
      responses:
        "200":
          description: Leads
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LeadListResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create lead
      description: Create a lead/enquiry
      tags:
        - Intake
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateLeadRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Lead"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/leads/{id}:
    get:
      summary: Get lead
      description: Retrieve a lead by id
      tags:
        - Intake
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Lead
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Lead"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update lead
      description: Update a lead
      tags:
        - Intake
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateLeadRequest"
      responses:
        "200":
          description: Updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Lead"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/leads/{id}/convert:
    post:
      summary: Convert lead
      description: Convert lead into a client and a matter
      tags:
        - Intake
        - Matters
        - Clients
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ConvertLeadRequest"
      responses:
        "200":
          description: Converted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ConvertLeadResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/quotes:
    get:
      summary: List quotes
      description: List firm quotes
      tags:
        - Intake
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: leadId
          in: query
        - schema:
            $ref: "#/components/schemas/QuoteStatus"
          required: false
          name: status
          in: query
      responses:
        "200":
          description: Quotes
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuoteListResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create quote
      description: Create a quote for a lead
      tags:
        - Intake
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateQuoteRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Quote"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/quotes/{id}:
    get:
      summary: Get quote
      description: Retrieve a quote
      tags:
        - Intake
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Quote
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Quote"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Update quote
      description: Update a quote
      tags:
        - Intake
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateQuoteRequest"
      responses:
        "200":
          description: Updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Quote"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/conflicts/search:
    post:
      summary: Run conflict search
      description: Run a conflict search and persist results
      tags:
        - Conflicts
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ConflictSearchRequest"
      responses:
        "200":
          description: Results
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ConflictSearchResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/conflicts/by-matter/{matterId}:
    get:
      summary: Get conflict check by matter
      description: Retrieve conflict check for a matter
      tags:
        - Conflicts
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: matterId
          in: path
      responses:
        "200":
          description: Conflict check
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ConflictCheck"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/conflicts/{id}/clear:
    post:
      summary: Clear conflict check (approval required)
      description: Create an approval request to clear a conflict check
      tags:
        - Conflicts
        - Approvals
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ConflictDecisionRequest"
      responses:
        "201":
          description: Approval request created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/conflicts/{id}/waive:
    post:
      summary: Waive conflict check (approval required)
      description: Create an approval request to waive a conflict check
      tags:
        - Conflicts
        - Approvals
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ConflictDecisionRequest"
      responses:
        "201":
          description: Approval request created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/email/accounts:
    get:
      summary: List email accounts
      description: List connected email provider accounts for the firm
      tags:
        - Integrations
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
      responses:
        "200":
          description: List
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailAccountListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Connect email account
      description: Create an email provider connection (MVP token capture)
      tags:
        - Integrations
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateEmailAccountRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailAccountCreateResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/calendar/accounts:
    get:
      summary: List calendar accounts
      description: List connected calendar provider accounts for the firm
      tags:
        - Integrations
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
      responses:
        "200":
          description: List
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CalendarAccountListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Connect calendar account
      description: Create a calendar provider connection (MVP token capture)
      tags:
        - Integrations
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateCalendarAccountRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CalendarAccountCreateResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/payments/accounts:
    get:
      summary: List payment provider accounts
      description: List connected payment provider accounts for the firm
      tags:
        - Integrations
      responses:
        "200":
          description: List
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentProviderAccountListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Connect payment provider
      description: Create a payment provider account (webhook setup)
      tags:
        - Integrations
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePaymentProviderAccountRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentProviderAccountCreateResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/accounting/connections:
    get:
      summary: List accounting connections
      description: List connected accounting provider connections for the firm
      tags:
        - Integrations
      responses:
        "200":
          description: List
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccountingConnectionListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Connect accounting provider
      description: Create an accounting provider connection (MVP token capture)
      tags:
        - Integrations
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateAccountingConnectionRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccountingConnectionCreateResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/email/accounts/{id}:
    get:
      summary: Get email account details
      description: Retrieve email account with webhook configuration
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Email account details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailAccountWithSecret"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Disconnect email account
      description: Revoke email account connection
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Account disconnected
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/email/accounts/{id}/health:
    get:
      summary: Check email account health
      description: Get email account connection status and health
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Health status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailAccountHealthResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/email/accounts/{id}/reconnect:
    post:
      summary: Reconnect email account
      description: Update email account tokens and reconnect
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReconnectAccountRequest"
      responses:
        "200":
          description: Account reconnected
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ReconnectAccountResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/calendar/accounts/{id}:
    get:
      summary: Get calendar account details
      description: Retrieve calendar account with webhook configuration
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Calendar account details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CalendarAccountWithSecret"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Disconnect calendar account
      description: Revoke calendar account connection
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Account disconnected
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/calendar/accounts/{id}/health:
    get:
      summary: Check calendar account health
      description: Get calendar account connection status and health
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Health status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CalendarAccountHealthResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/calendar/accounts/{id}/reconnect:
    post:
      summary: Reconnect calendar account
      description: Update calendar account tokens and reconnect
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                tokens:
                  type: object
                  additionalProperties:
                    nullable: true
              required:
                - tokens
      responses:
        "200":
          description: Account reconnected
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
                  status:
                    type: string
                  updatedAt:
                    type: string
                required:
                  - id
                  - status
                  - updatedAt
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/payments/accounts/{id}:
    get:
      summary: Get payment account details
      description: Retrieve payment provider account with webhook configuration
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Payment account details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentProviderAccountWithSecret"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Disconnect payment account
      description: Revoke payment provider account connection
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Account disconnected
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/payments/accounts/{id}/health:
    get:
      summary: Check payment account health
      description: Get payment account connection status and health
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Health status
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  lastSyncAt:
                    type: string
                    nullable: true
                  webhookActive:
                    type: boolean
                required:
                  - status
                  - lastSyncAt
                  - webhookActive
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/payments/accounts/{id}/reconnect:
    post:
      summary: Reconnect payment account
      description: Update payment account tokens and reconnect
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                tokens:
                  type: object
                  additionalProperties:
                    nullable: true
              required:
                - tokens
      responses:
        "200":
          description: Account reconnected
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
                  status:
                    type: string
                  updatedAt:
                    type: string
                required:
                  - id
                  - status
                  - updatedAt
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/accounting/connections/{id}:
    get:
      summary: Get accounting connection details
      description: Retrieve accounting provider connection with webhook configuration
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Accounting connection details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccountingConnectionWithSecret"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Disconnect accounting connection
      description: Revoke accounting provider connection
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Connection disconnected
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/accounting/connections/{id}/health:
    get:
      summary: Check accounting connection health
      description: Get accounting connection status and health
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Health status
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  lastSyncAt:
                    type: string
                    nullable: true
                  webhookActive:
                    type: boolean
                required:
                  - status
                  - lastSyncAt
                  - webhookActive
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/integrations/accounting/connections/{id}/reconnect:
    post:
      summary: Reconnect accounting connection
      description: Update accounting connection tokens and reconnect
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                tokens:
                  type: object
                  additionalProperties:
                    nullable: true
              required:
                - tokens
      responses:
        "200":
          description: Connection reconnected
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
                  status:
                    type: string
                  updatedAt:
                    type: string
                required:
                  - id
                  - status
                  - updatedAt
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/webhooks/email/{firmId}/{accountId}:
    post:
      summary: Email provider webhook
      description: Webhook endpoint for email provider events
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
          required: true
          name: firmId
          in: path
        - schema:
            type: string
            format: uuid
          required: true
          name: accountId
          in: path
        - schema:
            type: string
          required: true
          name: x-webhook-secret
          in: header
        - schema:
            type: string
          required: false
          name: x-event-id
          in: header
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties:
                nullable: true
      responses:
        "200":
          description: Event accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  accepted:
                    type: boolean
                  provider:
                    type: string
                required:
                  - accepted
                  - provider
        "400":
          description: Invalid webhook
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/webhooks/calendar/{firmId}/{accountId}:
    post:
      summary: Calendar provider webhook
      description: Webhook endpoint for calendar provider events
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
          required: true
          name: firmId
          in: path
        - schema:
            type: string
            format: uuid
          required: true
          name: accountId
          in: path
        - schema:
            type: string
          required: true
          name: x-webhook-secret
          in: header
        - schema:
            type: string
          required: false
          name: x-event-id
          in: header
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties:
                nullable: true
      responses:
        "200":
          description: Event accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  accepted:
                    type: boolean
                  provider:
                    type: string
                required:
                  - accepted
                  - provider
        "400":
          description: Invalid webhook
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/webhooks/payments/{firmId}/{accountId}:
    post:
      summary: Payment provider webhook
      description: Webhook endpoint for payment provider events
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
          required: true
          name: firmId
          in: path
        - schema:
            type: string
            format: uuid
          required: true
          name: accountId
          in: path
        - schema:
            type: string
          required: true
          name: x-webhook-secret
          in: header
        - schema:
            type: string
          required: false
          name: x-event-id
          in: header
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties:
                nullable: true
      responses:
        "200":
          description: Event accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  accepted:
                    type: boolean
                  provider:
                    type: string
                required:
                  - accepted
                  - provider
        "400":
          description: Invalid webhook
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/webhooks/accounting/{firmId}/{connectionId}:
    post:
      summary: Accounting provider webhook
      description: Webhook endpoint for accounting provider events
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
          required: true
          name: firmId
          in: path
        - schema:
            type: string
            format: uuid
          required: true
          name: connectionId
          in: path
        - schema:
            type: string
          required: true
          name: x-webhook-secret
          in: header
        - schema:
            type: string
          required: false
          name: x-event-id
          in: header
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties:
                nullable: true
      responses:
        "200":
          description: Event accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  accepted:
                    type: boolean
                  provider:
                    type: string
                required:
                  - accepted
                  - provider
        "400":
          description: Invalid webhook
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/webhooks/esignature/{firmId}/{requestId}:
    post:
      summary: E-signature provider webhook
      description: Webhook endpoint for e-signature provider events
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
          required: true
          name: firmId
          in: path
        - schema:
            type: string
            format: uuid
          required: true
          name: requestId
          in: path
        - schema:
            type: string
          required: true
          name: x-webhook-secret
          in: header
        - schema:
            type: string
          required: false
          name: x-event-id
          in: header
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties:
                nullable: true
      responses:
        "200":
          description: Event accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  accepted:
                    type: boolean
                  provider:
                    type: string
                required:
                  - accepted
                  - provider
        "400":
          description: Invalid webhook
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/signature-requests:
    get:
      summary: List signature requests
      description: List signature requests for the firm
      tags:
        - Integrations
      parameters:
        - schema:
            type: integer
            minimum: 1
            default: 1
            description: Page number (1-indexed)
            example: 1
          required: false
          name: page
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            description: Items per page (max 100)
            example: 20
          required: false
          name: limit
          in: query
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: false
          name: documentId
          in: query
        - schema:
            $ref: "#/components/schemas/SignatureRequestStatus"
          required: false
          name: status
          in: query
      responses:
        "200":
          description: List
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SignatureRequestListResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Create signature request (approval required)
      description: Create a signature request and an approval item to send it
      tags:
        - Integrations
        - Approvals
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateSignatureRequestRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateSignatureRequestResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/signature-requests/{id}:
    get:
      summary: Get signature request
      description: Retrieve a signature request by ID
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Signature request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SignatureRequest"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/signature-requests/{id}/send:
    post:
      summary: Send signature request (approval required)
      description: Create approval request to send signature request to signers
      tags:
        - Integrations
        - Approvals
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "201":
          description: Approval request created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApprovalRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/signature-requests/{id}/remind:
    post:
      summary: Send reminder for signature request
      description: Send reminder to signers who haven't signed yet
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      responses:
        "200":
          description: Reminder sent
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/signature-requests/{id}/void:
    post:
      summary: Void signature request
      description: Cancel signature request and mark as void
      tags:
        - Integrations
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VoidSignatureRequestRequest"
      responses:
        "200":
          description: Signature request voided
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SignatureRequest"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/search/semantic:
    post:
      summary: Semantic search
      description: Semantic search over document chunks (pgvector)
      tags:
        - Search
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SemanticSearchRequest"
      responses:
        "200":
          description: Results
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SemanticSearchResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/matters/{id}/search:
    get:
      summary: Semantic search within matter
      description: Semantic search over a matter's document chunks (pgvector)
      tags:
        - Search
      parameters:
        - schema:
            type: string
            format: uuid
            description: Unique identifier in UUID v4 format
            example: 123e4567-e89b-12d3-a456-426614174000
          required: true
          name: id
          in: path
        - schema:
            type: string
            minLength: 1
          required: true
          name: q
          in: query
        - schema:
            type: integer
            minimum: 1
            maximum: 50
          required: false
          name: limit
          in: query
      responses:
        "200":
          description: Results
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SemanticSearchResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/storage/upload:
    post:
      summary: Upload file
      description: Upload a file to MinIO storage
      tags:
        - Storage
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/FileUploadRequest"
      responses:
        "200":
          description: File uploaded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FileUploadResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/health:
    get:
      summary: Health check
      description: Check system health (PostgreSQL, Redis, MinIO)
      tags:
        - System
      responses:
        "200":
          description: System healthy
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthCheckResponse"
        "503":
          description: System degraded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthCheckDegradedResponse"
  /api/ai/chat:
    post:
      summary: AI chat (streaming)
      description: Stream AI responses via OpenRouter
      tags:
        - AI
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChatRequest"
      responses:
        "200":
          description: Streaming response
          content:
            text/event-stream:
              schema:
                type: object
                properties:
                  data:
                    type: string
                required:
                  - data
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /api/jobs/create:
    post:
      summary: Create background job
      description: Add a job to the BullMQ queue
      tags:
        - Jobs
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateJobRequest"
      responses:
        "200":
          description: Job created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateJobResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
